(function(){})(this);(function(c,b){function d(b){return!c(b).parents().andSelf().filter(function(){return"hidden"===c.curCSS(this,"visibility")||c.expr.filters.hidden(this)}).length}function e(b,f){var e=b.nodeName.toLowerCase();if("area"===e){var e=b.parentNode,g=e.name;if(!b.href||!g||"map"!==e.nodeName.toLowerCase())return!1;e=c("img[usemap=#"+g+"]")[0];return!!e&&d(e)}return(/input|select|textarea|button|object/.test(e)?!b.disabled:"a"==e?b.href||f:f)&&d(b)}c.ui=c.ui||{};c.ui.version||(c.extend(c.ui,{version:"1.8.18",
keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),c.fn.extend({propAttr:c.fn.prop||c.fn.attr,_focus:c.fn.focus,focus:function(b,d){return"number"==typeof b?this.each(function(){var e=
this;setTimeout(function(){c(e).focus();d&&d.call(e)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;c.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?b=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(c.curCSS(this,"position",1))&&/(auto|scroll)/.test(c.curCSS(this,"overflow",1)+c.curCSS(this,"overflow-y",1)+c.curCSS(this,"overflow-x",1))}).eq(0):b=this.parents().filter(function(){return/(auto|scroll)/.test(c.curCSS(this,
"overflow",1)+c.curCSS(this,"overflow-y",1)+c.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!b.length?c(document):b},zIndex:function(d){if(d!==b)return this.css("zIndex",d);if(this.length)for(var d=c(this[0]),e;d.length&&d[0]!==document;){e=d.css("position");if("absolute"===e||"relative"===e||"fixed"===e)if(e=parseInt(d.css("zIndex"),10),!isNaN(e)&&0!==e)return e;d=d.parent()}return 0},disableSelection:function(){return this.bind((c.support.selectstart?"selectstart":
"mousedown")+".ui-disableSelection",function(c){c.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),c.each(["Width","Height"],function(d,e){function j(b,d,m,e){c.each(g,function(){d-=parseFloat(c.curCSS(b,"padding"+this,!0))||0;m&&(d-=parseFloat(c.curCSS(b,"border"+this+"Width",!0))||0);e&&(d-=parseFloat(c.curCSS(b,"margin"+this,!0))||0)});return d}var g="Width"===e?["Left","Right"]:["Top","Bottom"],m=e.toLowerCase(),l={innerWidth:c.fn.innerWidth,innerHeight:c.fn.innerHeight,
outerWidth:c.fn.outerWidth,outerHeight:c.fn.outerHeight};c.fn["inner"+e]=function(d){return d===b?l["inner"+e].call(this):this.each(function(){c(this).css(m,j(this,d)+"px")})};c.fn["outer"+e]=function(b,d){return"number"!=typeof b?l["outer"+e].call(this,b):this.each(function(){c(this).css(m,j(this,b,!0,d)+"px")})}}),c.extend(c.expr[":"],{data:function(b,d,e){return!!c.data(b,e[3])},focusable:function(b){return e(b,!isNaN(c.attr(b,"tabindex")))},tabbable:function(b){var d=c.attr(b,"tabindex"),j=isNaN(d);
return(j||0<=d)&&e(b,!j)}}),c(function(){var b=document.body,d=b.appendChild(d=document.createElement("div"));d.offsetHeight;c.extend(d.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});c.support.minHeight=100===d.offsetHeight;c.support.selectstart="onselectstart"in d;b.removeChild(d).style.display="none"}),c.extend(c.ui,{plugin:{add:function(b,d,e){var b=c.ui[b].prototype,g;for(g in e)b.plugins[g]=b.plugins[g]||[],b.plugins[g].push([d,e[g]])},call:function(c,b,d){if((b=c.plugins[b])&&
c.element[0].parentNode)for(var e=0;e<b.length;e++)c.options[b[e][0]]&&b[e][1].apply(c.element,d)}},contains:function(c,b){return document.compareDocumentPosition?c.compareDocumentPosition(b)&16:c!==b&&c.contains(b)},hasScroll:function(b,d){if("hidden"===c(b).css("overflow"))return!1;var e=d&&"left"===d?"scrollLeft":"scrollTop",g=!1;if(0<b[e])return!0;b[e]=1;g=0<b[e];b[e]=0;return g},isOverAxis:function(c,b,d){return c>b&&c<b+d},isOver:function(b,d,e,g,m,l){return c.ui.isOverAxis(b,e,m)&&c.ui.isOverAxis(d,
g,l)}}))})(jQuery);
(function(c,b){if(c.cleanData){var d=c.cleanData;c.cleanData=function(b){for(var e=0,j;null!=(j=b[e]);e++)try{c(j).triggerHandler("remove")}catch(g){}d(b)}}else{var e=c.fn.remove;c.fn.remove=function(b,d){return this.each(function(){d||(!b||c.filter(b,[this]).length)&&c("*",this).add([this]).each(function(){try{c(this).triggerHandler("remove")}catch(b){}});return e.call(c(this),b,d)})}}c.widget=function(b,d,e){var g=b.split(".")[0],m,b=b.split(".")[1];m=g+"-"+b;e||(e=d,d=c.Widget);c.expr[":"][m]=
function(d){return!!c.data(d,b)};c[g]=c[g]||{};c[g][b]=function(c,b){arguments.length&&this._createWidget(c,b)};d=new d;d.options=c.extend(!0,{},d.options);c[g][b].prototype=c.extend(!0,d,{namespace:g,widgetName:b,widgetEventPrefix:c[g][b].prototype.widgetEventPrefix||b,widgetBaseClass:m},e);c.widget.bridge(b,c[g][b])};c.widget.bridge=function(d,e){c.fn[d]=function(j){var g="string"==typeof j,m=Array.prototype.slice.call(arguments,1),l=this,j=!g&&m.length?c.extend.apply(null,[!0,j].concat(m)):j;if(g&&
"_"===j.charAt(0))return l;g?this.each(function(){var e=c.data(this,d),g=e&&c.isFunction(e[j])?e[j].apply(e,m):e;if(g!==e&&g!==b)return l=g,!1}):this.each(function(){var b=c.data(this,d);b?b.option(j||{})._init():c.data(this,d,new e(j,this))});return l}};c.Widget=function(c,b){arguments.length&&this._createWidget(c,b)};c.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(b,d){c.data(d,this.widgetName,this);this.element=c(d);this.options=c.extend(!0,
{},this.options,this._getCreateOptions(),b);var e=this;this.element.bind("remove."+this.widgetName,function(){e.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return c.metadata&&c.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+
"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(d,e){var j=d;if(0===arguments.length)return c.extend({},this.options);if("string"==typeof d){if(e===b)return this.options[d];j={};j[d]=e}this._setOptions(j);return this},_setOptions:function(b){var d=this;c.each(b,function(b,c){d._setOption(b,c)});return this},_setOption:function(b,c){this.options[b]=c;"disabled"===b&&this.widget()[c?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",
c);return this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(b,d,e){var g,m=this.options[b],e=e||{},d=c.Event(d);d.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase();d.target=this.element[0];if(b=d.originalEvent)for(g in b)g in d||(d[g]=b[g]);this.element.trigger(d,e);return!(c.isFunction(m)&&!1===m.call(this.element[0],d,e)||d.isDefaultPrevented())}}})(jQuery);
(function(c){var b=!1;c(document).mouseup(function(){b=!1});c.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(c){return b._mouseDown(c)}).bind("click."+this.widgetName,function(e){if(!0===c.data(e.target,b.widgetName+".preventClickEvent"))return c.removeData(e.target,b.widgetName+".preventClickEvent"),e.stopImmediatePropagation(),!1});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+
this.widgetName)},_mouseDown:function(d){if(!b){this._mouseStarted&&this._mouseUp(d);this._mouseDownEvent=d;var e=this,h=1==d.which,f="string"==typeof this.options.cancel&&d.target.nodeName?c(d.target).closest(this.options.cancel).length:!1;if(!h||f||!this._mouseCapture(d))return!0;(this.mouseDelayMet=!this.options.delay)||(this._mouseDelayTimer=setTimeout(function(){e.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(d)&&this._mouseDelayMet(d)&&(this._mouseStarted=!1!==this._mouseStart(d),
!this._mouseStarted))return d.preventDefault(),!0;!0===c.data(d.target,this.widgetName+".preventClickEvent")&&c.removeData(d.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(b){return e._mouseMove(b)};this._mouseUpDelegate=function(b){return e._mouseUp(b)};c(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);d.preventDefault();return b=!0}},_mouseMove:function(b){if(c.browser.msie&&!(9<=document.documentMode)&&
!b.button)return this._mouseUp(b);if(this._mouseStarted)return this._mouseDrag(b),b.preventDefault();this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,b),this._mouseStarted?this._mouseDrag(b):this._mouseUp(b));return!this._mouseStarted},_mouseUp:function(b){c(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);this._mouseStarted&&(this._mouseStarted=!1,b.target==
this._mouseDownEvent.target&&c.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b));return!1},_mouseDistanceMet:function(b){return Math.max(Math.abs(this._mouseDownEvent.pageX-b.pageX),Math.abs(this._mouseDownEvent.pageY-b.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})(jQuery);
(function(c){c.widget("ui.draggable",c.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"==this.options.helper&&!/^(?:r|a|f)/.test(this.element.css("position"))&&
(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable"))return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this},_mouseCapture:function(b){var d=this.options;if(this.helper||d.disabled||c(b.target).is(".ui-resizable-handle"))return!1;
this.handle=this._getHandle(b);if(!this.handle)return!1;d.iframeFix&&c(!0===d.iframeFix?"iframe":d.iframeFix).each(function(){c('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(c(this).offset()).appendTo("body")});return!0},_mouseStart:function(b){var d=this.options;this.helper=this._createHelper(b);this._cacheHelperProportions();c.ui.ddmanager&&(c.ui.ddmanager.current=
this);this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};c.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(b);this.originalPageX=b.pageX;
this.originalPageY=b.pageY;d.cursorAt&&this._adjustOffsetFromHelper(d.cursorAt);d.containment&&this._setContainment();if(!1===this._trigger("start",b))return this._clear(),!1;this._cacheHelperProportions();c.ui.ddmanager&&!d.dropBehaviour&&c.ui.ddmanager.prepareOffsets(this,b);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(b,!0);c.ui.ddmanager&&c.ui.ddmanager.dragStart(this,b);return!0},_mouseDrag:function(b,d){this.position=this._generatePosition(b);this.positionAbs=this._convertPositionTo("absolute");
if(!d){var e=this._uiHash();if(!1===this._trigger("drag",b,e))return this._mouseUp({}),!1;this.position=e.position}if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";c.ui.ddmanager&&c.ui.ddmanager.drag(this,b);return!1},_mouseStop:function(b){var d=!1;c.ui.ddmanager&&!this.options.dropBehaviour&&(d=c.ui.ddmanager.drop(this,b));this.dropped&&(d=this.dropped,this.dropped=
!1);if((!this.element[0]||!this.element[0].parentNode)&&"original"==this.options.helper)return!1;if("invalid"==this.options.revert&&!d||"valid"==this.options.revert&&d||!0===this.options.revert||c.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)){var e=this;c(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==e._trigger("stop",b)&&e._clear()})}else!1!==this._trigger("stop",b)&&this._clear();return!1},_mouseUp:function(b){!0===
this.options.iframeFix&&c("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});c.ui.ddmanager&&c.ui.ddmanager.dragStop(this,b);return c.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(b){var d=!this.options.handle||!c(this.options.handle,this.element).length?!0:!1;c(this.options.handle,this.element).find("*").andSelf().each(function(){this==b.target&&(d=
!0)});return d},_createHelper:function(b){var d=this.options,b=c.isFunction(d.helper)?c(d.helper.apply(this.element[0],[b])):"clone"==d.helper?this.element.clone().removeAttr("id"):this.element;b.parents("body").length||b.appendTo("parent"==d.appendTo?this.element[0].parentNode:d.appendTo);b[0]!=this.element[0]&&!/(fixed|absolute)/.test(b.css("position"))&&b.css("position","absolute");return b},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" "));c.isArray(b)&&(b={left:+b[0],top:+b[1]||
0});"left"in b&&(this.offset.click.left=b.left+this.margins.left);"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left);"top"in b&&(this.offset.click.top=b.top+this.margins.top);"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&c.ui.contains(this.scrollParent[0],
this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&c.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var b=this.element.position();return{top:b.top-
(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:b.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),
height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;"parent"==b.containment&&(b.containment=this.helper[0].parentNode);if("document"==b.containment||"window"==b.containment)this.containment=["document"==b.containment?0:c(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"==b.containment?0:c(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==b.containment?0:c(window).scrollLeft())+c("document"==b.containment?document:
window).width()-this.helperProportions.width-this.margins.left,("document"==b.containment?0:c(window).scrollTop())+(c("document"==b.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)&&b.containment.constructor!=Array){var b=c(b.containment),d=b[0];if(d){b.offset();var e="hidden"!=c(d).css("overflow");this.containment=[(parseInt(c(d).css("borderLeftWidth"),10)||0)+(parseInt(c(d).css("paddingLeft"),
10)||0),(parseInt(c(d).css("borderTopWidth"),10)||0)+(parseInt(c(d).css("paddingTop"),10)||0),(e?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c(d).css("borderLeftWidth"),10)||0)-(parseInt(c(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c(d).css("borderTopWidth"),10)||0)-(parseInt(c(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];
this.relative_container=b}}else b.containment.constructor==Array&&(this.containment=b.containment)},_convertPositionTo:function(b,d){d||(d=this.position);var e="absolute"==b?1:-1,h="absolute"==this.cssPosition&&(this.scrollParent[0]==document||!c.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(h[0].tagName);return{top:d.top+this.offset.relative.top*e+this.offset.parent.top*e-(c.browser.safari&&526>c.browser.version&&"fixed"==this.cssPosition?
0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():f?0:h.scrollTop())*e),left:d.left+this.offset.relative.left*e+this.offset.parent.left*e-(c.browser.safari&&526>c.browser.version&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():f?0:h.scrollLeft())*e)}},_generatePosition:function(b){var d=this.options,e="absolute"==this.cssPosition&&(this.scrollParent[0]==document||!c.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,
h=/(html|body)/i.test(e[0].tagName),f=b.pageX,j=b.pageY;if(this.originalPosition){var g;this.containment&&(this.relative_container?(g=this.relative_container.offset(),g=[this.containment[0]+g.left,this.containment[1]+g.top,this.containment[2]+g.left,this.containment[3]+g.top]):g=this.containment,b.pageX-this.offset.click.left<g[0]&&(f=g[0]+this.offset.click.left),b.pageY-this.offset.click.top<g[1]&&(j=g[1]+this.offset.click.top),b.pageX-this.offset.click.left>g[2]&&(f=g[2]+this.offset.click.left),
b.pageY-this.offset.click.top>g[3]&&(j=g[3]+this.offset.click.top));d.grid&&(j=d.grid[1]?this.originalPageY+Math.round((j-this.originalPageY)/d.grid[1])*d.grid[1]:this.originalPageY,j=g?j-this.offset.click.top<g[1]||j-this.offset.click.top>g[3]?j-this.offset.click.top<g[1]?j+d.grid[1]:j-d.grid[1]:j:j,f=d.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/d.grid[0])*d.grid[0]:this.originalPageX,f=g?f-this.offset.click.left<g[0]||f-this.offset.click.left>g[2]?f-this.offset.click.left<g[0]?
f+d.grid[0]:f-d.grid[0]:f:f)}return{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(c.browser.safari&&526>c.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():h?0:e.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(c.browser.safari&&526>c.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():h?0:e.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");
this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(b,d,e){e=e||this._uiHash();c.ui.plugin.call(this,b,[d,e]);"drag"==b&&(this.positionAbs=this._convertPositionTo("absolute"));return c.Widget.prototype._trigger.call(this,b,d,e)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});c.extend(c.ui.draggable,{version:"1.8.18"});
c.ui.plugin.add("draggable","connectToSortable",{start:function(b,d){var e=c(this).data("draggable"),h=e.options,f=c.extend({},d,{item:e.element});e.sortables=[];c(h.connectToSortable).each(function(){var d=c.data(this,"sortable");d&&!d.options.disabled&&(e.sortables.push({instance:d,shouldRevert:d.options.revert}),d.refreshPositions(),d._trigger("activate",b,f))})},stop:function(b,d){var e=c(this).data("draggable"),h=c.extend({},d,{item:e.element});c.each(e.sortables,function(){this.instance.isOver?
(this.instance.isOver=0,e.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,"original"==e.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,h))})},drag:function(b,d){var e=c(this).data("draggable"),h=this;c.each(e.sortables,function(){this.instance.positionAbs=
e.positionAbs;this.instance.helperProportions=e.helperProportions;this.instance.offset.click=e.offset.click;this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=c(h).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return d.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,
!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=e.offset.click.top,this.instance.offset.click.left=e.offset.click.left,this.instance.offset.parent.left-=e.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=e.offset.parent.top-this.instance.offset.parent.top,e._trigger("toSortable",b),e.dropped=this.instance.element,e.currentItem=e.element,this.instance.fromOutside=e),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&
(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),e._trigger("fromSortable",b),e.dropped=!1)})}});c.ui.plugin.add("draggable","cursor",{start:function(){var b=c("body"),d=c(this).data("draggable").options;
b.css("cursor")&&(d._cursor=b.css("cursor"));b.css("cursor",d.cursor)},stop:function(){var b=c(this).data("draggable").options;b._cursor&&c("body").css("cursor",b._cursor)}});c.ui.plugin.add("draggable","opacity",{start:function(b,d){var e=c(d.helper),h=c(this).data("draggable").options;e.css("opacity")&&(h._opacity=e.css("opacity"));e.css("opacity",h.opacity)},stop:function(b,d){var e=c(this).data("draggable").options;e._opacity&&c(d.helper).css("opacity",e._opacity)}});c.ui.plugin.add("draggable",
"scroll",{start:function(){var b=c(this).data("draggable");b.scrollParent[0]!=document&&"HTML"!=b.scrollParent[0].tagName&&(b.overflowOffset=b.scrollParent.offset())},drag:function(b){var d=c(this).data("draggable"),e=d.options,h=!1;if(d.scrollParent[0]!=document&&"HTML"!=d.scrollParent[0].tagName){if(!e.axis||"x"!=e.axis)d.overflowOffset.top+d.scrollParent[0].offsetHeight-b.pageY<e.scrollSensitivity?d.scrollParent[0].scrollTop=h=d.scrollParent[0].scrollTop+e.scrollSpeed:b.pageY-d.overflowOffset.top<
e.scrollSensitivity&&(d.scrollParent[0].scrollTop=h=d.scrollParent[0].scrollTop-e.scrollSpeed);if(!e.axis||"y"!=e.axis)d.overflowOffset.left+d.scrollParent[0].offsetWidth-b.pageX<e.scrollSensitivity?d.scrollParent[0].scrollLeft=h=d.scrollParent[0].scrollLeft+e.scrollSpeed:b.pageX-d.overflowOffset.left<e.scrollSensitivity&&(d.scrollParent[0].scrollLeft=h=d.scrollParent[0].scrollLeft-e.scrollSpeed)}else{if(!e.axis||"x"!=e.axis)b.pageY-c(document).scrollTop()<e.scrollSensitivity?h=c(document).scrollTop(c(document).scrollTop()-
e.scrollSpeed):c(window).height()-(b.pageY-c(document).scrollTop())<e.scrollSensitivity&&(h=c(document).scrollTop(c(document).scrollTop()+e.scrollSpeed));if(!e.axis||"y"!=e.axis)b.pageX-c(document).scrollLeft()<e.scrollSensitivity?h=c(document).scrollLeft(c(document).scrollLeft()-e.scrollSpeed):c(window).width()-(b.pageX-c(document).scrollLeft())<e.scrollSensitivity&&(h=c(document).scrollLeft(c(document).scrollLeft()+e.scrollSpeed))}!1!==h&&c.ui.ddmanager&&!e.dropBehaviour&&c.ui.ddmanager.prepareOffsets(d,
b)}});c.ui.plugin.add("draggable","snap",{start:function(){var b=c(this).data("draggable"),d=b.options;b.snapElements=[];c(d.snap.constructor!=String?d.snap.items||":data(draggable)":d.snap).each(function(){var d=c(this),h=d.offset();this!=b.element[0]&&b.snapElements.push({item:this,width:d.outerWidth(),height:d.outerHeight(),top:h.top,left:h.left})})},drag:function(b,d){for(var e=c(this).data("draggable"),h=e.options,f=h.snapTolerance,j=d.offset.left,g=j+e.helperProportions.width,m=d.offset.top,
l=m+e.helperProportions.height,v=e.snapElements.length-1;0<=v;v--){var p=e.snapElements[v].left,k=p+e.snapElements[v].width,o=e.snapElements[v].top,t=o+e.snapElements[v].height;if(p-f<j&&j<k+f&&o-f<m&&m<t+f||p-f<j&&j<k+f&&o-f<l&&l<t+f||p-f<g&&g<k+f&&o-f<m&&m<t+f||p-f<g&&g<k+f&&o-f<l&&l<t+f){if("inner"!=h.snapMode){var s=Math.abs(o-l)<=f,u=Math.abs(t-m)<=f,q=Math.abs(p-g)<=f,x=Math.abs(k-j)<=f;s&&(d.position.top=e._convertPositionTo("relative",{top:o-e.helperProportions.height,left:0}).top-e.margins.top);
u&&(d.position.top=e._convertPositionTo("relative",{top:t,left:0}).top-e.margins.top);q&&(d.position.left=e._convertPositionTo("relative",{top:0,left:p-e.helperProportions.width}).left-e.margins.left);x&&(d.position.left=e._convertPositionTo("relative",{top:0,left:k}).left-e.margins.left)}var z=s||u||q||x;"outer"!=h.snapMode&&(s=Math.abs(o-m)<=f,u=Math.abs(t-l)<=f,q=Math.abs(p-j)<=f,x=Math.abs(k-g)<=f,s&&(d.position.top=e._convertPositionTo("relative",{top:o,left:0}).top-e.margins.top),u&&(d.position.top=
e._convertPositionTo("relative",{top:t-e.helperProportions.height,left:0}).top-e.margins.top),q&&(d.position.left=e._convertPositionTo("relative",{top:0,left:p}).left-e.margins.left),x&&(d.position.left=e._convertPositionTo("relative",{top:0,left:k-e.helperProportions.width}).left-e.margins.left));!e.snapElements[v].snapping&&(s||u||q||x||z)&&e.options.snap.snap&&e.options.snap.snap.call(e.element,b,c.extend(e._uiHash(),{snapItem:e.snapElements[v].item}));e.snapElements[v].snapping=s||u||q||x||z}else e.snapElements[v].snapping&&
e.options.snap.release&&e.options.snap.release.call(e.element,b,c.extend(e._uiHash(),{snapItem:e.snapElements[v].item})),e.snapElements[v].snapping=!1}}});c.ui.plugin.add("draggable","stack",{start:function(){var b=c(this).data("draggable").options,b=c.makeArray(c(b.stack)).sort(function(b,d){return(parseInt(c(b).css("zIndex"),10)||0)-(parseInt(c(d).css("zIndex"),10)||0)});if(b.length){var d=parseInt(b[0].style.zIndex)||0;c(b).each(function(b){this.style.zIndex=d+b});this[0].style.zIndex=d+b.length}}});
c.ui.plugin.add("draggable","zIndex",{start:function(b,d){var e=c(d.helper),h=c(this).data("draggable").options;e.css("zIndex")&&(h._zIndex=e.css("zIndex"));e.css("zIndex",h.zIndex)},stop:function(b,d){var e=c(this).data("draggable").options;e._zIndex&&c(d.helper).css("zIndex",e._zIndex)}})})(jQuery);
(function(c){c.widget("ui.slider",c.ui.mouse,{widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var b=this,d=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),h=d.values&&d.values.length||1,f=[];this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+
this.orientation+" ui-widget ui-widget-content ui-corner-all"+(d.disabled?" ui-slider-disabled ui-disabled":""));this.range=c([]);d.range&&(!0===d.range&&(d.values||(d.values=[this._valueMin(),this._valueMin()]),d.values.length&&2!==d.values.length&&(d.values=[d.values[0],d.values[0]])),this.range=c("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===d.range||"max"===d.range?" ui-slider-range-"+d.range:"")));for(var j=e.length;j<h;j+=1)f.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");
this.handles=e.add(c(f.join("")).appendTo(b.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(b){b.preventDefault()}).hover(function(){d.disabled||c(this).addClass("ui-state-hover")},function(){c(this).removeClass("ui-state-hover")}).focus(function(){d.disabled?c(this).blur():(c(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),c(this).addClass("ui-state-focus"))}).blur(function(){c(this).removeClass("ui-state-focus")});this.handles.each(function(b){c(this).data("index.ui-slider-handle",
b)});this.handles.keydown(function(d){var m=c(this).data("index.ui-slider-handle"),e,f,j;if(!b.options.disabled){switch(d.keyCode){case c.ui.keyCode.HOME:case c.ui.keyCode.END:case c.ui.keyCode.PAGE_UP:case c.ui.keyCode.PAGE_DOWN:case c.ui.keyCode.UP:case c.ui.keyCode.RIGHT:case c.ui.keyCode.DOWN:case c.ui.keyCode.LEFT:if(d.preventDefault(),!b._keySliding&&(b._keySliding=!0,c(this).addClass("ui-state-active"),e=b._start(d,m),!1===e))return}e=b.options.step;b.options.values&&b.options.values.length?
f=j=b.values(m):f=j=b.value();switch(d.keyCode){case c.ui.keyCode.HOME:j=b._valueMin();break;case c.ui.keyCode.END:j=b._valueMax();break;case c.ui.keyCode.PAGE_UP:j=b._trimAlignValue(f+(b._valueMax()-b._valueMin())/5);break;case c.ui.keyCode.PAGE_DOWN:j=b._trimAlignValue(f-(b._valueMax()-b._valueMin())/5);break;case c.ui.keyCode.UP:case c.ui.keyCode.RIGHT:if(f===b._valueMax())return;j=b._trimAlignValue(f+e);break;case c.ui.keyCode.DOWN:case c.ui.keyCode.LEFT:if(f===b._valueMin())return;j=b._trimAlignValue(f-
e)}b._slide(d,m,j)}}).keyup(function(d){var m=c(this).data("index.ui-slider-handle");b._keySliding&&(b._keySliding=!1,b._stop(d,m),b._change(d,m),c(this).removeClass("ui-state-active"))});this._refreshValue();this._animateOff=!1},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");this._mouseDestroy();return this},
_mouseCapture:function(b){var d=this.options,e,h,f,j,g;if(d.disabled)return!1;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();e=this._normValueFromMouse({x:b.pageX,y:b.pageY});h=this._valueMax()-this._valueMin()+1;j=this;this.handles.each(function(b){var d=Math.abs(e-j.values(b));h>d&&(h=d,f=c(this),g=b)});!0===d.range&&this.values(1)===d.min&&(g+=1,f=c(this.handles[g]));if(!1===this._start(b,g))return!1;this._mouseSliding=
!0;j._handleIndex=g;f.addClass("ui-state-active").focus();d=f.offset();this._clickOffset=!c(b.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:b.pageX-d.left-f.width()/2,top:b.pageY-d.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(b,g,e);return this._animateOff=!0},_mouseStart:function(){return!0},_mouseDrag:function(b){var c=this._normValueFromMouse({x:b.pageX,
y:b.pageY});this._slide(b,this._handleIndex,c);return!1},_mouseStop:function(b){this.handles.removeClass("ui-state-active");this._mouseSliding=!1;this._stop(b,this._handleIndex);this._change(b,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(b){var c,e;"horizontal"===this.orientation?(c=this.elementSize.width,e=b.x-this.elementOffset.left-
(this._clickOffset?this._clickOffset.left:0)):(c=this.elementSize.height,e=b.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0));b=e/c;1<b&&(b=1);0>b&&(b=0);"vertical"===this.orientation&&(b=1-b);c=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+b*c)},_start:function(b,c){var e={handle:this.handles[c],value:this.value()};this.options.values&&this.options.values.length&&(e.value=this.values(c),e.values=this.values());return this._trigger("start",b,e)},
_slide:function(b,c,e){var h,f,j;this.options.values&&this.options.values.length?(h=this.values(c?0:1),2===this.options.values.length&&!0===this.options.range&&(0===c&&e>h||1===c&&e<h)&&(e=h),e!==this.values(c)&&(f=this.values(),f[c]=e,j=this._trigger("slide",b,{handle:this.handles[c],value:e,values:f}),this.values(c?0:1),!1!==j&&this.values(c,e,!0))):e!==this.value()&&(j=this._trigger("slide",b,{handle:this.handles[c],value:e}),!1!==j&&this.value(e))},_stop:function(b,c){var e={handle:this.handles[c],
value:this.value()};this.options.values&&this.options.values.length&&(e.value=this.values(c),e.values=this.values());this._trigger("stop",b,e)},_change:function(b,c){if(!this._keySliding&&!this._mouseSliding){var e={handle:this.handles[c],value:this.value()};this.options.values&&this.options.values.length&&(e.value=this.values(c),e.values=this.values());this._trigger("change",b,e)}},value:function(b){if(arguments.length)this.options.value=this._trimAlignValue(b),this._refreshValue(),this._change(null,
0);else return this._value()},values:function(b,d){var e,h,f;if(1<arguments.length)this.options.values[b]=this._trimAlignValue(d),this._refreshValue(),this._change(null,b);else{if(!arguments.length)return this._values();if(!c.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();e=this.options.values;h=arguments[0];for(f=0;f<e.length;f+=1)e[f]=this._trimAlignValue(h[f]),this._change(null,f);this._refreshValue()}},_setOption:function(b,d){var e,h=
0;c.isArray(this.options.values)&&(h=this.options.values.length);c.Widget.prototype._setOption.apply(this,arguments);switch(b){case "disabled":d?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.propAttr("disabled",!1),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+
this.orientation);this._refreshValue();break;case "value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case "values":this._animateOff=!0;this._refreshValue();for(e=0;e<h;e+=1)this._change(null,e);this._animateOff=!1}},_value:function(){var b=this.options.value;return b=this._trimAlignValue(b)},_values:function(b){var c,e;if(arguments.length)return c=this.options.values[b],c=this._trimAlignValue(c);c=this.options.values.slice();for(e=0;e<c.length;e+=1)c[e]=
this._trimAlignValue(c[e]);return c},_trimAlignValue:function(b){if(b<=this._valueMin())return this._valueMin();if(b>=this._valueMax())return this._valueMax();var c=0<this.options.step?this.options.step:1,e=(b-this._valueMin())%c,b=b-e;2*Math.abs(e)>=c&&(b+=0<e?c:-c);return parseFloat(b.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var b=this.options.range,d=this.options,e=this,h=this._animateOff?!1:d.animate,f,j=
{},g,m,l,v;this.options.values&&this.options.values.length?this.handles.each(function(b){f=100*((e.values(b)-e._valueMin())/(e._valueMax()-e._valueMin()));j["horizontal"===e.orientation?"left":"bottom"]=f+"%";c(this).stop(1,1)[h?"animate":"css"](j,d.animate);!0===e.options.range&&("horizontal"===e.orientation?(0===b&&e.range.stop(1,1)[h?"animate":"css"]({left:f+"%"},d.animate),1===b&&e.range[h?"animate":"css"]({width:f-g+"%"},{queue:!1,duration:d.animate})):(0===b&&e.range.stop(1,1)[h?"animate":"css"]({bottom:f+
"%"},d.animate),1===b&&e.range[h?"animate":"css"]({height:f-g+"%"},{queue:!1,duration:d.animate})));g=f}):(m=this.value(),l=this._valueMin(),v=this._valueMax(),f=v!==l?100*((m-l)/(v-l)):0,j["horizontal"===e.orientation?"left":"bottom"]=f+"%",this.handle.stop(1,1)[h?"animate":"css"](j,d.animate),"min"===b&&"horizontal"===this.orientation&&this.range.stop(1,1)[h?"animate":"css"]({width:f+"%"},d.animate),"max"===b&&"horizontal"===this.orientation&&this.range[h?"animate":"css"]({width:100-f+"%"},{queue:!1,
duration:d.animate}),"min"===b&&"vertical"===this.orientation&&this.range.stop(1,1)[h?"animate":"css"]({height:f+"%"},d.animate),"max"===b&&"vertical"===this.orientation&&this.range[h?"animate":"css"]({height:100-f+"%"},{queue:!1,duration:d.animate}))}});c.extend(c.ui.slider,{version:"1.8.18"})})(jQuery);/*
 MIT License <http://www.opensource.org/licenses/mit-license.php>
*/
(function(c,b,d,e){function h(b,d){this.options=c.extend(!0,{},f,d);this.input=b;this.$input=c(b);this._defaults=f;this._name="geocomplete";this.init()}var f={bounds:!0,map:!1,details:!1,detailsAttribute:"name",location:!1,mapOptions:{zoom:14,scrollwheel:!1,mapTypeId:"roadmap"},markerOptions:{draggable:!1},maxZoom:16,types:["geocode"]},j="street_address,route,intersection,political,country,administrative_area_level_1,administrative_area_level_2,administrative_area_level_3,colloquial_area,locality,sublocality,neighborhood,premise,subpremise,postal_code,natural_feature,airport,park,point_of_interest,post_box,street_number,floor,room,lat,lng,viewport,location,formatted_address,location_type,bounds".split(","),
g="id,url,website,vicinity,reference,rating,international_phone_number,icon,formatted_phone_number".split(",");c.extend(h.prototype,{init:function(){this.initMap();this.initMarker();this.initGeocoder();this.initDetails();this.initLocation()},initMap:function(){this.options.map&&(this.map="function"==typeof this.options.map.setCenter?this.options.map:new google.maps.Map(c(this.options.map)[0],this.options.mapOptions))},initMarker:function(){if(this.map){var b=c.extend(this.options.markerOptions,{map:this.map});
this.marker=new google.maps.Marker(b);google.maps.event.addListener(this.marker,"dragend",c.proxy(this.markerDragged,this))}},initGeocoder:function(){this.autocomplete=new google.maps.places.Autocomplete(this.input,{types:this.options.types,bounds:!0===this.options.bounds?null:this.options.bounds});this.geocoder=new google.maps.Geocoder;this.map&&!0===this.options.bounds&&this.autocomplete.bindTo("bounds",this.map);google.maps.event.addListener(this.autocomplete,"place_changed",c.proxy(this.placeChanged,
this));this.$input.keypress(function(b){if(13===b.keyCode)return!1});this.$input.bind("geocode",c.proxy(function(){this.find()},this))},initDetails:function(){function b(c){f[c]=d.find("["+e+"="+c+"]")}if(this.options.details){var d=c(this.options.details),e=this.options.detailsAttribute,f={};c.each(j,function(c,d){b(d);b(d+"_short")});c.each(g,function(c,d){b(d)});this.$details=d;this.details=f}},initLocation:function(){var b=this.options.location,c;b&&("string"==typeof b?this.find(b):(b instanceof
Array&&(c=new google.maps.LatLng(b[0],b[1])),b instanceof google.maps.LatLng&&(c=b),c&&this.geoocode({latLng:c})))},find:function(b){this.geocode({address:b||this.$input.val()})},geocode:function(b){this.options.bounds&&!b.bounds&&(b.bounds=!0===this.options.bounds?this.map&&this.map.getBounds():this.options.bounds);this.geocoder.geocode(b,c.proxy(this.handleGeocode,this))},handleGeocode:function(b,c){if(c===google.maps.GeocoderStatus.OK){var d=b[0];this.$input.val(d.formatted_address);this.update(d);
1<b.length&&this.trigger("geocode:multiple",b)}else this.trigger("geocode:error",c)},trigger:function(b,c){this.$input.trigger(b,[c])},center:function(b){b.viewport?(this.map.fitBounds(b.viewport),this.map.getZoom()>this.options.maxZoom&&this.map.setZoom(this.options.maxZoom)):(this.map.setZoom(this.options.maxZoom),this.map.setCenter(b.location));this.marker&&(this.marker.setPosition(b.location),this.marker.setAnimation(this.options.markerOptions.animation))},update:function(b){this.map&&this.center(b.geometry);
this.$details&&this.fillDetails(b);this.trigger("geocode:result",b)},fillDetails:function(b){var d={},e=b.geometry,f=e.viewport,k=e.bounds;c.each(b.address_components,function(b,c){var e=c.types[0];d[e]=c.long_name;d[e+"_short"]=c.short_name});c.each(g,function(c,e){d[e]=b[e]});c.extend(d,{formatted_address:b.formatted_address,location_type:e.location_type||"PLACES",viewport:f,bounds:k,location:e.location,lat:e.location.lat(),lng:e.location.lng()});c.each(this.details,c.proxy(function(b,c){this.setDetail(c,
d[b])},this));this.data=d},setDetail:function(b,c){c===e?c="":"function"==typeof c.toUrlValue&&(c=c.toUrlValue());b.is(":input")?b.val(c):b.text(c)},markerDragged:function(b){this.trigger("geocode:dragged",b.latLng)},resetMarker:function(){this.marker.setPosition(this.data.location);this.setDetail(this.details.lat,this.data.location.lat());this.setDetail(this.details.lng,this.data.location.lng())},placeChanged:function(){var b=this.autocomplete.getPlace();b.geometry?this.update(b):this.find(b.name)}});
c.fn.geocomplete=function(b){if("string"==typeof b){var d=c(this).data("plugin_geocomplete"),e=d[b];if("function"==typeof e)return e.apply(d,Array.prototype.slice.call(arguments,1));2==arguments.length&&(e=arguments[1]);return e}return this.each(function(){var d=c.data(this,"plugin_geocomplete");d||(d=new h(this,b),c.data(this,"plugin_geocomplete",d))})}})(jQuery,window,document);Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),abbreviatedDayNames:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),shortestDayNames:"Su,Mo,Tu,We,Th,Fr,Sa".split(","),firstLetterDayNames:"S,M,T,W,T,F,S".split(","),monthNames:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),abbreviatedMonthNames:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),
amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,
may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|after|from)/i,subtract:/^(\-|before|ago)/i,yesterday:/^yesterday/i,today:/^t(oday)?/i,tomorrow:/^tomorrow/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,
second:/^sec(ond)?s?/i,minute:/^min(ute)?s?/i,hour:/^h(ou)?rs?/i,week:/^w(ee)?k/i,month:/^m(o(nth)?s?)?/i,day:/^d(ays?)?/i,year:/^y((ea)?rs?)?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a|p)/i},abbreviatedTimeZoneStandard:{GMT:"-000",EST:"-0400",CST:"-0500",MST:"-0600",PST:"-0700"},abbreviatedTimeZoneDST:{GMT:"-000",EDT:"-0500",CDT:"-0600",
MDT:"-0700",PDT:"-0800"}};Date.getMonthNumberFromName=function(c){for(var b=Date.CultureInfo.monthNames,d=Date.CultureInfo.abbreviatedMonthNames,c=c.toLowerCase(),e=0;e<b.length;e++)if(b[e].toLowerCase()==c||d[e].toLowerCase()==c)return e;return-1};Date.getDayNumberFromName=function(c){for(var b=Date.CultureInfo.dayNames,d=Date.CultureInfo.abbreviatedDayNames,c=c.toLowerCase(),e=0;e<b.length;e++)if(b[e].toLowerCase()==c||d[e].toLowerCase()==c)return e;return-1};
Date.isLeapYear=function(c){return 0===c%4&&0!==c%100||0===c%400};Date.getDaysInMonth=function(c,b){return[31,Date.isLeapYear(c)?29:28,31,30,31,30,31,31,30,31,30,31][b]};Date.getTimezoneOffset=function(c,b){return b?Date.CultureInfo.abbreviatedTimeZoneDST[c.toUpperCase()]:Date.CultureInfo.abbreviatedTimeZoneStandard[c.toUpperCase()]};
Date.getTimezoneAbbreviation=function(c,b){var d=b?Date.CultureInfo.abbreviatedTimeZoneDST:Date.CultureInfo.abbreviatedTimeZoneStandard,e;for(e in d)if(d[e]===c)return e;return null};Date.prototype.clone=function(){return new Date(this.getTime())};Date.prototype.compareTo=function(c){if(isNaN(this))throw Error(this);if(c instanceof Date&&!isNaN(c))return this>c?1:this<c?-1:0;throw new TypeError(c);};Date.prototype.equals=function(c){return 0===this.compareTo(c)};
Date.prototype.between=function(c,b){var d=this.getTime();return d>=c.getTime()&&d<=b.getTime()};Date.prototype.addMilliseconds=function(c){this.setMilliseconds(this.getMilliseconds()+c);return this};Date.prototype.addSeconds=function(c){return this.addMilliseconds(1E3*c)};Date.prototype.addMinutes=function(c){return this.addMilliseconds(6E4*c)};Date.prototype.addHours=function(c){return this.addMilliseconds(36E5*c)};Date.prototype.addDays=function(c){return this.addMilliseconds(864E5*c)};
Date.prototype.addWeeks=function(c){return this.addMilliseconds(6048E5*c)};Date.prototype.addMonths=function(c){var b=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+c);this.setDate(Math.min(b,this.getDaysInMonth()));return this};Date.prototype.addYears=function(c){return this.addMonths(12*c)};
Date.prototype.add=function(c){if("number"==typeof c)return this._orient=c,this;if(c.millisecond||c.milliseconds)this.addMilliseconds(c.millisecond||c.milliseconds);if(c.second||c.seconds)this.addSeconds(c.second||c.seconds);if(c.minute||c.minutes)this.addMinutes(c.minute||c.minutes);if(c.hour||c.hours)this.addHours(c.hour||c.hours);if(c.month||c.months)this.addMonths(c.month||c.months);if(c.year||c.years)this.addYears(c.year||c.years);if(c.day||c.days)this.addDays(c.day||c.days);return this};
Date._validate=function(c,b,d,e){if("number"!=typeof c)throw new TypeError(c+" is not a Number.");if(c<b||c>d)throw new RangeError(c+" is not a valid value for "+e+".");return!0};Date.validateMillisecond=function(c){return Date._validate(c,0,999,"milliseconds")};Date.validateSecond=function(c){return Date._validate(c,0,59,"seconds")};Date.validateMinute=function(c){return Date._validate(c,0,59,"minutes")};Date.validateHour=function(c){return Date._validate(c,0,23,"hours")};
Date.validateDay=function(c,b,d){return Date._validate(c,1,Date.getDaysInMonth(b,d),"days")};Date.validateMonth=function(c){return Date._validate(c,0,11,"months")};Date.validateYear=function(c){return Date._validate(c,1,9999,"seconds")};
Date.prototype.set=function(c){!c.millisecond&&0!==c.millisecond&&(c.millisecond=-1);!c.second&&0!==c.second&&(c.second=-1);!c.minute&&0!==c.minute&&(c.minute=-1);!c.hour&&0!==c.hour&&(c.hour=-1);!c.day&&0!==c.day&&(c.day=-1);!c.month&&0!==c.month&&(c.month=-1);!c.year&&0!==c.year&&(c.year=-1);-1!=c.millisecond&&Date.validateMillisecond(c.millisecond)&&this.addMilliseconds(c.millisecond-this.getMilliseconds());-1!=c.second&&Date.validateSecond(c.second)&&this.addSeconds(c.second-this.getSeconds());
-1!=c.minute&&Date.validateMinute(c.minute)&&this.addMinutes(c.minute-this.getMinutes());-1!=c.hour&&Date.validateHour(c.hour)&&this.addHours(c.hour-this.getHours());-1!==c.month&&Date.validateMonth(c.month)&&this.addMonths(c.month-this.getMonth());-1!=c.year&&Date.validateYear(c.year)&&this.addYears(c.year-this.getFullYear());-1!=c.day&&Date.validateDay(c.day,this.getFullYear(),this.getMonth())&&this.addDays(c.day-this.getDate());c.timezone&&this.setTimezone(c.timezone);c.timezoneOffset&&this.setTimezoneOffset(c.timezoneOffset);
return this};Date.prototype.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this};Date.prototype.isLeapYear=function(){var c=this.getFullYear();return 0===c%4&&0!==c%100||0===c%400};Date.prototype.isWeekday=function(){return!(this.is().sat()||this.is().sun())};Date.prototype.getDaysInMonth=function(){return Date.getDaysInMonth(this.getFullYear(),this.getMonth())};Date.prototype.moveToFirstDayOfMonth=function(){return this.set({day:1})};
Date.prototype.moveToLastDayOfMonth=function(){return this.set({day:this.getDaysInMonth()})};Date.prototype.moveToDayOfWeek=function(c,b){var d=(c-this.getDay()+7*(b||1))%7;return this.addDays(0===d?d+7*(b||1):d)};Date.prototype.moveToMonth=function(c,b){var d=(c-this.getMonth()+12*(b||1))%12;return this.addMonths(0===d?d+12*(b||1):d)};Date.prototype.getDayOfYear=function(){return Math.floor((this-new Date(this.getFullYear(),0,1))/864E5)};
Date.prototype.getWeekOfYear=function(c){var b=this.getFullYear(),d=this.getMonth(),e=this.getDate(),c=c||Date.CultureInfo.firstDayOfWeek,h=8-(new Date(b,0,1)).getDay();8==h&&(h=1);d=(Date.UTC(b,d,e,0,0,0)-Date.UTC(b,0,1,0,0,0))/864E5+1;d=Math.floor((d-h+7)/7);d===c&&(b--,b=8-(new Date(b,0,1)).getDay(),d=2==b||8==b?53:52);return d};Date.prototype.isDST=function(){console.log("isDST");return"D"==this.toString().match(/(E|C|M|P)(S|D)T/)[2]};
Date.prototype.getTimezone=function(){return Date.getTimezoneAbbreviation(this.getUTCOffset,this.isDST())};Date.prototype.setTimezoneOffset=function(c){var b=this.getTimezoneOffset();this.addMinutes(-6*Number(c)/10-b);return this};Date.prototype.setTimezone=function(c){return this.setTimezoneOffset(Date.getTimezoneOffset(c))};Date.prototype.getUTCOffset=function(){var c=-10*this.getTimezoneOffset()/6;if(0>c)return c=(c-1E4).toString(),c[0]+c.substr(2);c=(c+1E4).toString();return"+"+c.substr(1)};
Date.prototype.getDayName=function(c){return c?Date.CultureInfo.abbreviatedDayNames[this.getDay()]:Date.CultureInfo.dayNames[this.getDay()]};Date.prototype.getMonthName=function(c){return c?Date.CultureInfo.abbreviatedMonthNames[this.getMonth()]:Date.CultureInfo.monthNames[this.getMonth()]};Date.prototype._toString=Date.prototype.toString;
Date.prototype.toString=function(c){var b=this,d=function(b){return 1==b.toString().length?"0"+b:b};return c?c.replace(/dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?/g,function(c){switch(c){case "hh":return d(13>b.getHours()?b.getHours():b.getHours()-12);case "h":return 13>b.getHours()?b.getHours():b.getHours()-12;case "HH":return d(b.getHours());case "H":return b.getHours();case "mm":return d(b.getMinutes());case "m":return b.getMinutes();case "ss":return d(b.getSeconds());case "s":return b.getSeconds();
case "yyyy":return b.getFullYear();case "yy":return b.getFullYear().toString().substring(2,4);case "dddd":return b.getDayName();case "ddd":return b.getDayName(!0);case "dd":return d(b.getDate());case "d":return b.getDate().toString();case "MMMM":return b.getMonthName();case "MMM":return b.getMonthName(!0);case "MM":return d(b.getMonth()+1);case "M":return b.getMonth()+1;case "t":return 12>b.getHours()?Date.CultureInfo.amDesignator.substring(0,1):Date.CultureInfo.pmDesignator.substring(0,1);case "tt":return 12>
b.getHours()?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator;case "zzz":case "zz":case "z":return""}}):this._toString()};Date.now=function(){return new Date};Date.today=function(){return Date.now().clearTime()};Date.prototype._orient=1;Date.prototype.next=function(){this._orient=1;return this};Date.prototype.last=Date.prototype.prev=Date.prototype.previous=function(){this._orient=-1;return this};Date.prototype._is=!1;Date.prototype.is=function(){this._is=!0;return this};
Number.prototype._dateElement="day";Number.prototype.fromNow=function(){var c={};c[this._dateElement]=this;return Date.now().add(c)};Number.prototype.ago=function(){var c={};c[this._dateElement]=-1*this;return Date.now().add(c)};
(function(){for(var c=Date.prototype,b=Number.prototype,d="sunday monday tuesday wednesday thursday friday saturday".split(/\s/),e="january february march april may june july august september october november december".split(/\s/),h="Millisecond Second Minute Hour Day Week Month Year".split(/\s/),f=function(b){return function(){return this._is?(this._is=!1,this.getDay()==b):this.moveToDayOfWeek(b,this._orient)}},j=0;j<d.length;j++)c[d[j]]=c[d[j].substring(0,3)]=f(j);d=function(b){return function(){return this._is?
(this._is=!1,this.getMonth()===b):this.moveToMonth(b,this._orient)}};for(f=0;f<e.length;f++)c[e[f]]=c[e[f].substring(0,3)]=d(f);d=function(b){return function(){"s"!=b.substring(b.length-1)&&(b+="s");return this["add"+b](this._orient)}};f=function(b){return function(){this._dateElement=b;return this}};for(j=0;j<h.length;j++)e=h[j].toLowerCase(),c[e]=c[e+"s"]=d(h[j]),b[e]=b[e+"s"]=f(e)})();Date.prototype.toJSONString=function(){return this.toString("yyyy-MM-ddThh:mm:ssZ")};
Date.prototype.toShortDateString=function(){return this.toString(Date.CultureInfo.formatPatterns.shortDatePattern)};Date.prototype.toLongDateString=function(){return this.toString(Date.CultureInfo.formatPatterns.longDatePattern)};Date.prototype.toShortTimeString=function(){return this.toString(Date.CultureInfo.formatPatterns.shortTimePattern)};Date.prototype.toLongTimeString=function(){return this.toString(Date.CultureInfo.formatPatterns.longTimePattern)};
Date.prototype.getOrdinal=function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};
(function(){Date.Parsing={Exception:function(b){this.message="Parse error at '"+b.substring(0,10)+" ...'"}};for(var c=Date.Parsing,b=c.Operators={rtoken:function(b){return function(d){var e=d.match(b);if(e)return[e[0],d.substring(e[0].length)];throw new c.Exception(d);}},token:function(){return function(c){return b.rtoken(RegExp("^s*"+c+"s*"))(c)}},stoken:function(c){return b.rtoken(RegExp("^"+c))},until:function(b){return function(c){for(var d=[],e=null;c.length;){try{e=b.call(this,c)}catch(l){d.push(e[0]);
c=e[1];continue}break}return[d,c]}},many:function(b){return function(c){for(var d=[],e=null;c.length;){try{e=b.call(this,c)}catch(l){break}d.push(e[0]);c=e[1]}return[d,c]}},optional:function(b){return function(c){var d=null;try{d=b.call(this,c)}catch(e){return[null,c]}return[d[0],d[1]]}},not:function(b){return function(d){try{b.call(this,d)}catch(e){return[null,d]}throw new c.Exception(d);}},ignore:function(b){return b?function(c){var d=null,d=b.call(this,c);return[null,d[1]]}:null},product:function(){for(var c=
arguments[0],d=Array.prototype.slice.call(arguments,1),e=[],m=0;m<c.length;m++)e.push(b.each(c[m],d));return e},cache:function(b){var d={},e=null;return function(m){try{e=d[m]=d[m]||b.call(this,m)}catch(l){e=d[m]=l}if(e instanceof c.Exception)throw e;return e}},any:function(){var b=arguments;return function(d){for(var e=null,m=0;m<b.length;m++)if(null!=b[m]){try{e=b[m].call(this,d)}catch(l){e=null}if(e)return e}throw new c.Exception(d);}},each:function(){var b=arguments;return function(d){for(var e=
[],m=null,l=0;l<b.length;l++)if(null!=b[l]){try{m=b[l].call(this,d)}catch(h){throw new c.Exception(d);}e.push(m[0]);d=m[1]}return[e,d]}},all:function(){var b=b;return b.each(b.optional(arguments))},sequence:function(d,e,g){e=e||b.rtoken(/^\s*/);g=g||null;return 1==d.length?d[0]:function(b){for(var l=null,h=null,p=[],k=0;k<d.length;k++){try{l=d[k].call(this,b)}catch(o){break}p.push(l[0]);try{h=e.call(this,l[1])}catch(t){h=null;break}b=h[1]}if(!l)throw new c.Exception(b);if(h)throw new c.Exception(h[1]);
if(g)try{l=g.call(this,l[1])}catch(s){throw new c.Exception(l[1]);}return[p,l?l[1]:b]}},between:function(c,d,e){var e=e||c,m=b.each(b.ignore(c),d,b.ignore(e));return function(b){b=m.call(this,b);return[[b[0][0],r[0][2]],b[1]]}},list:function(c,d,e){d=d||b.rtoken(/^\s*/);e=e||null;return c instanceof Array?b.each(b.product(c.slice(0,-1),b.ignore(d)),c.slice(-1),b.ignore(e)):b.each(b.many(b.each(c,b.ignore(d))),px,b.ignore(e))},set:function(d,e,g){e=e||b.rtoken(/^\s*/);g=g||null;return function(m){for(var l=
null,h=l=null,p=null,k=[[],m],o=!1,t=0;t<d.length;t++){l=h=null;o=1==d.length;try{l=d[t].call(this,m)}catch(s){continue}p=[[l[0]],l[1]];if(0<l[1].length&&!o)try{h=e.call(this,l[1])}catch(u){o=!0}else o=!0;!o&&0===h[1].length&&(o=!0);if(!o){l=[];for(o=0;o<d.length;o++)t!=o&&l.push(d[o]);l=b.set(l,e).call(this,h[1]);0<l[0].length&&(p[0]=p[0].concat(l[0]),p[1]=l[1])}p[1].length<k[1].length&&(k=p);if(0===k[1].length)break}if(0===k[0].length)return k;if(g){try{h=g.call(this,k[1])}catch(q){throw new c.Exception(k[1]);
}k[1]=h[1]}return k}},forward:function(b,c){return function(d){return b[c].call(this,d)}},replace:function(b,c){return function(d){d=b.call(this,d);return[c,d[1]]}},process:function(b,c){return function(d){d=b.call(this,d);return[c.call(this,d[0]),d[1]]}},min:function(b,d){return function(e){var m=d.call(this,e);if(m[0].length<b)throw new c.Exception(e);return m}}},d=function(b){return function(){var c=null,d=[];1<arguments.length?c=Array.prototype.slice.call(arguments):arguments[0]instanceof Array&&
(c=arguments[0]);if(c)for(var e=c.shift();0<e.length;)return c.unshift(e[0]),d.push(b.apply(null,c)),c.shift(),d;else return b.apply(null,arguments)}},e="optional not ignore cache".split(/\s/),h=0;h<e.length;h++)b[e[h]]=d(b[e[h]]);d=function(b){return function(){return arguments[0]instanceof Array?b.apply(null,arguments[0]):b.apply(null,arguments)}};e="each any all".split(/\s/);for(h=0;h<e.length;h++)b[e[h]]=d(b[e[h]])})();
(function(){var c=function(b){for(var d=[],e=0;e<b.length;e++)b[e]instanceof Array?d=d.concat(c(b[e])):b[e]&&d.push(b[e]);return d};Date.Grammar={};Date.Translator={hour:function(b){return function(){this.hour=Number(b)}},minute:function(b){return function(){this.minute=Number(b)}},second:function(b){return function(){this.second=Number(b)}},meridian:function(b){return function(){this.meridian=b.slice(0,1).toLowerCase()}},timezone:function(b){return function(){var c=b.replace(/[^\d\+\-]/g,"");c.length?
this.timezoneOffset=Number(c):this.timezone=b.toLowerCase()}},day:function(b){var c=b[0];return function(){this.day=Number(c.match(/\d+/)[0])}},month:function(b){return function(){this.month=3==b.length?Date.getMonthNumberFromName(b):Number(b)-1}},year:function(b){return function(){var c=Number(b);this.year=2<b.length?c:c+(c+2E3<Date.CultureInfo.twoDigitYearMax?2E3:1900)}},rday:function(b){return function(){switch(b){case "yesterday":this.days=-1;break;case "tomorrow":this.days=1;break;case "today":this.days=
0;break;case "now":this.days=0,this.now=!0}}},finishExact:function(b){var b=b instanceof Array?b:[b],c=new Date;this.year=c.getFullYear();this.month=c.getMonth();this.day=1;for(c=this.second=this.minute=this.hour=0;c<b.length;c++)b[c]&&b[c].call(this);this.hour="p"==this.meridian&&13>this.hour?this.hour+12:this.hour;if(this.day>Date.getDaysInMonth(this.year,this.month))throw new RangeError(this.day+" is not a valid value for days.");b=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);
this.timezone?b.set({timezone:this.timezone}):this.timezoneOffset&&b.set({timezoneOffset:this.timezoneOffset});return b},finish:function(b){b=b instanceof Array?c(b):[b];if(0===b.length)return null;for(var d=0;d<b.length;d++)"function"==typeof b[d]&&b[d].call(this);if(this.now)return new Date;b=Date.today();if(null!=this.days||this.orient||this.operator){var e,f;f="past"==this.orient||"subtract"==this.operator?-1:1;this.weekday&&(this.unit="day",d=Date.getDayNumberFromName(this.weekday)-b.getDay(),
e=7,this.days=d?(d+f*e)%e:f*e);this.month&&(this.unit="month",d=this.month-b.getMonth(),e=12,this.months=d?(d+f*e)%e:f*e,this.month=null);this.unit||(this.unit="day");if(null==this[this.unit+"s"]||null!=this.operator)this.value||(this.value=1),"week"==this.unit&&(this.unit="day",this.value*=7),this[this.unit+"s"]=this.value*f;return b.add(this)}this.meridian&&this.hour&&(this.hour=13>this.hour&&"p"==this.meridian?this.hour+12:this.hour);this.weekday&&!this.day&&(this.day=b.addDays(Date.getDayNumberFromName(this.weekday)-
b.getDay()).getDate());this.month&&!this.day&&(this.day=1);return b.set(this)}};var b=Date.Parsing.Operators,d=Date.Grammar,e=Date.Translator,h;d.datePartDelimiter=b.rtoken(/^([\s\-\.\,\/\x27]+)/);d.timePartDelimiter=b.stoken(":");d.whiteSpace=b.rtoken(/^\s*/);d.generalDelimiter=b.rtoken(/^(([\s\,]|at|on)+)/);var f={};d.ctoken=function(c){var d=f[c];if(!d){for(var d=Date.CultureInfo.regexPatterns,e=c.split(/\s+/),h=[],j=0;j<e.length;j++)h.push(b.replace(b.rtoken(d[e[j]]),e[j]));d=f[c]=b.any.apply(null,
h)}return d};d.ctoken2=function(c){return b.rtoken(Date.CultureInfo.regexPatterns[c])};d.h=b.cache(b.process(b.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),e.hour));d.hh=b.cache(b.process(b.rtoken(/^(0[0-9]|1[0-2])/),e.hour));d.H=b.cache(b.process(b.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),e.hour));d.HH=b.cache(b.process(b.rtoken(/^([0-1][0-9]|2[0-3])/),e.hour));d.m=b.cache(b.process(b.rtoken(/^([0-5][0-9]|[0-9])/),e.minute));d.mm=b.cache(b.process(b.rtoken(/^[0-5][0-9]/),e.minute));d.s=b.cache(b.process(b.rtoken(/^([0-5][0-9]|[0-9])/),
e.second));d.ss=b.cache(b.process(b.rtoken(/^[0-5][0-9]/),e.second));d.hms=b.cache(b.sequence([d.H,d.mm,d.ss],d.timePartDelimiter));d.t=b.cache(b.process(d.ctoken2("shortMeridian"),e.meridian));d.tt=b.cache(b.process(d.ctoken2("longMeridian"),e.meridian));d.z=b.cache(b.process(b.rtoken(/^(\+|\-)?\s*\d\d\d\d?/),e.timezone));d.zz=b.cache(b.process(b.rtoken(/^(\+|\-)\s*\d\d\d\d/),e.timezone));d.zzz=b.cache(b.process(d.ctoken2("timezone"),e.timezone));d.timeSuffix=b.each(b.ignore(d.whiteSpace),b.set([d.tt,
d.zzz]));d.time=b.each(b.optional(b.ignore(b.stoken("T"))),d.hms,d.timeSuffix);d.d=b.cache(b.process(b.each(b.rtoken(/^([0-2]\d|3[0-1]|\d)/),b.optional(d.ctoken2("ordinalSuffix"))),e.day));d.dd=b.cache(b.process(b.each(b.rtoken(/^([0-2]\d|3[0-1])/),b.optional(d.ctoken2("ordinalSuffix"))),e.day));d.ddd=d.dddd=b.cache(b.process(d.ctoken("sun mon tue wed thu fri sat"),function(b){return function(){this.weekday=b}}));d.M=b.cache(b.process(b.rtoken(/^(1[0-2]|0\d|\d)/),e.month));d.MM=b.cache(b.process(b.rtoken(/^(1[0-2]|0\d)/),
e.month));d.MMM=d.MMMM=b.cache(b.process(d.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),e.month));d.y=b.cache(b.process(b.rtoken(/^(\d\d?)/),e.year));d.yy=b.cache(b.process(b.rtoken(/^(\d\d)/),e.year));d.yyy=b.cache(b.process(b.rtoken(/^(\d\d?\d?\d?)/),e.year));d.yyyy=b.cache(b.process(b.rtoken(/^(\d\d\d\d)/),e.year));h=function(){return b.each(b.any.apply(null,arguments),b.not(d.ctoken2("timeContext")))};d.day=h(d.d,d.dd);d.month=h(d.M,d.MMM);d.year=h(d.yyyy,d.yy);d.orientation=b.process(d.ctoken("past future"),
function(b){return function(){this.orient=b}});d.operator=b.process(d.ctoken("add subtract"),function(b){return function(){this.operator=b}});d.rday=b.process(d.ctoken("yesterday tomorrow today now"),e.rday);d.unit=b.process(d.ctoken("minute hour day week month year"),function(b){return function(){this.unit=b}});d.value=b.process(b.rtoken(/^\d\d?(st|nd|rd|th)?/),function(b){return function(){this.value=b.replace(/\D/g,"")}});d.expression=b.set([d.rday,d.operator,d.value,d.unit,d.orientation,d.ddd,
d.MMM]);h=function(){return b.set(arguments,d.datePartDelimiter)};d.mdy=h(d.ddd,d.month,d.day,d.year);d.ymd=h(d.ddd,d.year,d.month,d.day);d.dmy=h(d.ddd,d.day,d.month,d.year);d.date=function(b){return(d[Date.CultureInfo.dateElementOrder]||d.mdy).call(this,b)};d.format=b.process(b.many(b.any(b.process(b.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(b){if(d[b])return d[b];throw Date.Parsing.Exception(b);}),b.process(b.rtoken(/^[^dMyhHmstz]+/),function(c){return b.ignore(b.stoken(c))}))),
function(c){return b.process(b.each.apply(null,c),e.finishExact)});var j={};d.formats=function(c){if(c instanceof Array){for(var e=[],l=0;l<c.length;l++)e.push(j[c[l]]=j[c[l]]||d.format(c[l])[0]);return b.any.apply(null,e)}return j[c]=j[c]||d.format(c)[0]};d._formats=d.formats(["yyyy-MM-ddTHH:mm:ss","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","d"]);d._start=b.process(b.set([d.date,d.time,d.expression],d.generalDelimiter,d.whiteSpace),e.finish);d.start=function(b){try{var c=d._formats.call({},
b);if(0===c[1].length)return c}catch(e){}return d._start.call({},b)}})();Date._parse=Date.parse;Date.parse=function(c){var b=null;if(!c)return null;try{b=Date.Grammar.start.call({},c)}catch(d){return null}return 0===b[1].length?b[0]:null};Date.getParseFunction=function(c){var b=Date.Grammar.formats(c);return function(c){var e=null;try{e=b.call({},c)}catch(h){return null}return 0===e[1].length?e[0]:null}};Date.parseExact=function(c,b){return Date.getParseFunction(b)(c)};(function(c){var b=String.prototype.trim,d=String.prototype.trimRight,e=String.prototype.trimLeft,h=function(b,c,d){for(var b=b+"",c=~~c,e=[];0<c;e[--c]=b);return e.join(null==d?"":d)},f=function(b){return null!=b?"["+g.escapeRegExp(""+b)+"]":"\\s"},j=function(){function b(c){return Object.prototype.toString.call(c).slice(8,-1).toLowerCase()}var c=function(){return c.cache.hasOwnProperty(arguments[0])||(c.cache[arguments[0]]=c.parse(arguments[0])),c.format.call(null,c.cache[arguments[0]],arguments)};
return c.format=function(c,d){var e=1,l=c.length,f="",g,u=[],q,x,z;for(q=0;q<l;q++)if(f=b(c[q]),"string"===f)u.push(c[q]);else if("array"===f){f=c[q];if(f[2]){g=d[e];for(x=0;x<f[2].length;x++){if(!g.hasOwnProperty(f[2][x]))throw Error(j('[_.sprintf] property "%s" does not exist',f[2][x]));g=g[f[2][x]]}}else f[1]?g=d[f[1]]:g=d[e++];if(/[^s]/.test(f[8])&&"number"!=b(g))throw Error(j("[_.sprintf] expecting number but found %s",b(g)));switch(f[8]){case "b":g=g.toString(2);break;case "c":g=String.fromCharCode(g);
break;case "d":g=parseInt(g,10);break;case "e":g=f[7]?g.toExponential(f[7]):g.toExponential();break;case "f":g=f[7]?parseFloat(g).toFixed(f[7]):parseFloat(g);break;case "o":g=g.toString(8);break;case "s":g=(g=""+g)&&f[7]?g.substring(0,f[7]):g;break;case "u":g=Math.abs(g);break;case "x":g=g.toString(16);break;case "X":g=g.toString(16).toUpperCase()}g=/[def]/.test(f[8])&&f[3]&&0<=g?"+"+g:g;x=f[4]?"0"==f[4]?"0":f[4].charAt(1):" ";z=f[6]-(""+g).length;x=f[6]?h(x,z):"";u.push(f[5]?g+x:x+g)}return u.join("")},
c.cache={},c.parse=function(b){for(var c=[],d=[],e=0;b;){if(null!==(c=/^[^\x25]+/.exec(b)))d.push(c[0]);else if(null!==(c=/^\x25{2}/.exec(b)))d.push("%");else{if(null===(c=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(b)))throw Error("[_.sprintf] huh?");if(c[2]){var e=e|1,m=[],l=c[2],f=[];if(null===(f=/^([a-z_][a-z_\d]*)/i.exec(l)))throw Error("[_.sprintf] huh?");for(m.push(f[1]);""!==(l=l.substring(f[0].length));){if(null===(f=/^\.([a-z_][a-z_\d]*)/i.exec(l)))if(null===
(f=/^\[(\d+)\]/.exec(l)))throw Error("[_.sprintf] huh?");m.push(f[1])}c[2]=m}else e|=2;if(3===e)throw Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");d.push(c)}b=b.substring(c[0].length)}return d},c}(),g={VERSION:"2.1.1",isBlank:function(b){return/^\s*$/.test(b)},stripTags:function(b){return(""+b).replace(/<\/?[^>]+>/ig,"")},capitalize:function(b){return b+="",b.charAt(0).toUpperCase()+b.substring(1).toLowerCase()},chop:function(b,c){for(var b=b+"",c=~~c||b.length,
d=[],e=0;e<b.length;)d.push(b.slice(e,e+c)),e+=c;return d},clean:function(b){return g.strip((""+b).replace(/\s+/g," "))},count:function(b,c){return b+="",c+="",b.split(c).length-1},chars:function(b){return(""+b).split("")},escapeHTML:function(b){return(""+b).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},unescapeHTML:function(b){return(""+b).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&amp;/g,
"&")},escapeRegExp:function(b){return b.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},insert:function(b,c,d){b=(""+b).split("");return b.splice(~~c,0,""+d),b.join("")},include:function(b,c){return-1!==(""+b).indexOf(c)},join:function(b){var c=Array.prototype.slice.call(arguments);return c.join(c.shift())},lines:function(b){return(""+b).split("\n")},reverse:function(b){return Array.prototype.reverse.apply((""+b).split("")).join("")},splice:function(b,c,d,e){b=(""+b).split("");return b.splice(~~c,~~d,
e),b.join("")},startsWith:function(b,c){return b+="",c+="",b.length>=c.length&&b.substring(0,c.length)===c},endsWith:function(b,c){return b+="",c+="",b.length>=c.length&&b.substring(b.length-c.length)===c},succ:function(b){var b=b+"",c=b.split("");return c.splice(b.length-1,1,String.fromCharCode(b.charCodeAt(b.length-1)+1)),c.join("")},titleize:function(b){return(""+b).replace(/\b./g,function(b){return b.toUpperCase()})},camelize:function(b){return g.trim(b).replace(/(\-|_|\s)+(.)?/g,function(b,c,
d){return d?d.toUpperCase():""})},underscored:function(b){return g.trim(b).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},dasherize:function(b){return g.trim(b).replace(/[_\s]+/g,"-").replace(/([A-Z])/g,"-$1").replace(/-+/g,"-").toLowerCase()},classify:function(b){return g.titleize(b.replace(/_/g," ")).replace(/\s/g,"")},humanize:function(b){return g.capitalize(this.underscored(b).replace(/_id$/,"").replace(/_/g," "))},trim:function(c,d){return c+="",!d&&b?b.call(c):(d=
f(d),c.replace(RegExp("^"+d+"+|"+d+"+$","g"),""))},ltrim:function(b,c){return!c&&e?e.call(b):(c=f(c),(""+b).replace(RegExp("^"+c+"+","g"),""))},rtrim:function(b,c){return!c&&d?d.call(b):(c=f(c),(""+b).replace(RegExp(c+"+$","g"),""))},truncate:function(b,c,d){return b+="",d=d||"...",c=~~c,b.length>c?b.slice(0,c)+d:b},prune:function(b,c,d){var b=b+"",c=~~c,d=null!=d?""+d:"...",e,f,h=b.replace(/\W/g,function(b){return b.toUpperCase()!==b.toLowerCase()?"A":" "});return f=h.charAt(c),e=h.slice(0,c),f&&
f.match(/\S/)&&(e=e.replace(/\s\S+$/,"")),e=g.rtrim(e),(e+d).length>b.length?b:b.substring(0,e.length)+d},words:function(b,c){return g.trim(b,c).split(c||/\s+/)},pad:function(b,c,d,e){var b=b+"",f="",f=0,c=~~c;d?1<d.length&&(d=d.charAt(0)):d=" ";switch(e){case "right":f=c-b.length;f=h(d,f);b+=f;break;case "both":f=c-b.length;f={left:h(d,Math.ceil(f/2)),right:h(d,Math.floor(f/2))};b=f.left+b+f.right;break;default:f=c-b.length,f=h(d,f),b=f+b}return b},lpad:function(b,c,d){return g.pad(b,c,d)},rpad:function(b,
c,d){return g.pad(b,c,d,"right")},lrpad:function(b,c,d){return g.pad(b,c,d,"both")},sprintf:j,vsprintf:function(b,c){return c.unshift(b),j.apply(null,c)},toNumber:function(b,c){var d;d=1*(1*b||0).toFixed(~~c)||0;return 0===d&&"0"!=""+b?Number.NaN:d},strRight:function(b,c){var b=b+"",d=(c=null!=c?""+c:c)?b.indexOf(c):-1;return-1!=d?b.slice(d+c.length,b.length):b},strRightBack:function(b,c){var b=b+"",d=(c=null!=c?""+c:c)?b.lastIndexOf(c):-1;return-1!=d?b.slice(d+c.length,b.length):b},strLeft:function(b,
c){var b=b+"",d=(c=null!=c?""+c:c)?b.indexOf(c):-1;return-1!=d?b.slice(0,d):b},strLeftBack:function(b,c){var b=b+"",d=b.lastIndexOf(null!=c?""+c:c);return-1!=d?b.slice(0,d):b},toSentence:function(b,c,d){c||(c=", ");d||(d=" and ");for(var e=b.length,f="",g=0;g<e;g++)f+=b[g],g===e-2?f+=d:g<e-1&&(f+=c);return f},slugify:function(b){var c=RegExp(f("\u0105\u00e0\u00e1\u00e4\u00e2\u00e3\u0107\u0119\u00e8\u00e9\u00eb\u00ea\u00ec\u00ed\u00ef\u00ee\u0142\u0144\u00f2\u00f3\u00f6\u00f4\u00f5\u00f9\u00fa\u00fc\u00fb\u00f1\u00e7\u017c\u017a\u00b7/_:;"),
"g");return b=(""+b).toLowerCase(),b=b.replace(c,function(b){return"aaaaaaceeeeeiiiilnooooouuuunczz".charAt("\u0105\u00e0\u00e1\u00e4\u00e2\u00e3\u0107\u0119\u00e8\u00e9\u00eb\u00ea\u00ec\u00ed\u00ef\u00ee\u0142\u0144\u00f2\u00f3\u00f6\u00f4\u00f5\u00f9\u00fa\u00fc\u00fb\u00f1\u00e7\u017c\u017a\u00b7/_:;".indexOf(b))||"-"}),g.trim(b.replace(/[^\w\s-]/g,"").replace(/[-\s]+/g,"-"),"-")},exports:function(){var b={},c;for(c in this)if(this.hasOwnProperty(c)&&!("include"==c||"contains"==c||"reverse"==
c))b[c]=this[c];return b},repeat:h};g.strip=g.trim;g.lstrip=g.ltrim;g.rstrip=g.rtrim;g.center=g.lrpad;g.rjust=g.lpad;g.ljust=g.rpad;g.contains=g.include;"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(module.exports=g),exports._s=g):"function"==typeof define&&define.amd?define("underscore.string",function(){return g}):"undefined"!=typeof c._?(c._.string=g,c._.str=c._.string):c._={string:g,str:g}})(this||window);(function(c,b){function d(b){return"[object Arguments]"==A.call(b)}function e(b){return new h(b)}function h(b){this.o=b}function f(){for(var b,c=-1,d={},e={},n={},f=["d","j","g","a"];++c<arguments.length;)for(b in arguments[c])n[b]=arguments[c][b];for(;b=f.pop();)"object"==typeof n[b]?(d[b]=n[b].c,e[b]=n[b].k):d[b]=e[b]=n[b]||"";b=n.b;var c=/^[^,]+/.exec(b)[0],f=n.h,w=n.i,g=!("v"==b||"b"==w),w=!("b"==b||"a"==w),k=n.n!==D;return Function("c,d,i,l,m,n,p,q,s,t,w,z,B,E,F,k,G",'"use strict";return function('+
b+"){"+(n.m||"")+";"+("var o, y"+(f?"="+f:""))+";if("+c+"==G)return "+(n.f||"y")+";"+(g?"var u="+c+".length;o=-1;"+((w?"if(u===+u){":"")+(d.d||"")+";while("+(d.j||"++o<u")+"){"+d.g+"}"+(d.a||"")+";"+(w?"}":"")):"")+(w?(g?"else{":"")+(e.d||"")+";for("+(e.j||"o in "+c)+"){"+(k?"if(m.call("+/\S+$/.exec(e.j||c)[0]+",o)){":"")+e.g+(k?"}":"")+"}"+(e.a||"")+";"+(g?"}":""):"")+(n.e||"")+";return "+(n.l||"y")+"}")(Q,u,ia,ja,G,I,p,Infinity,R,ka,Math,B,S,A,C,D)}function j(b){return b.replace(ba,function(b,c){return y[c]})}
function g(c,d,e,n){var f=2<arguments.length;if(c==b)return e;n&&(d=u(d,n));var w=c.length;if(w===+w){for(w&&!f&&(e=c[--w]);w--;)e=d(e,c[w],w,c);return e}var g=ca(c);for((w=g.length)&&!f&&(e=c[g[--w]]);w--;)f=g[w],e=d(e,c[f],f,c);return e}function m(b,c,d){var e=0,n=b.length;for(d||(d=I);e<n;){var f=e+n>>1;d(b[f])<d(c)?e=f+1:n=f}return e}function l(c,d,e){return d==b||e?c[0]:B.call(c,0,d)}function v(b,c){return c?ia.apply([],b):M(b,function(b,c){if(R(c))return da.apply(b,v(c)),b;b.push(c);return b},
[])}function p(c,d,e){var n;if(c==b)return-1;if(e)return e=m(c,d),c[e]===d?e:-1;e=0;for(n=c.length;e<n;e++)if(c[e]===d)return e;return-1}function k(b){var c=B.call(arguments,1);return ea(s(b),function(b){return fa(c,function(c){return 0<=p(c,b)})})}function o(c,d,e){var n=c.length;return d==b||e?c[n-1]:B.call(c,-d||n)}function t(c,d,e){return B.call(c,d==b||e?1:d)}function s(b,c,d){var d=d?N(b,d):b,e=[];3>b.length&&(c=C);M(d,function(d,n,f){if(c?o(d)!==n||!d.length:0>p(d,n))d.push(n),e.push(b[f]);
return d},[]);return e}function u(b,c){var d=B.call(arguments,2),e=d.length;return function(){d.length=e;da.apply(d,arguments);return b.apply(c,d)}}function q(c,d,e){var n;return function(){var f=arguments,w=this;e&&!n&&c.apply(w,f);ua(n);n=T(function(){n=b;e||c.apply(w,f)},d)}}function x(c,d,e){e||(e=[]);if(c===d)return 0!==c||1/c==1/d;if(c==b||d==b)return c===d;c.p&&(c=c.o);d.p&&(d=d.o);if(c.isEqual&&z(c.isEqual))return c.isEqual(d);if(d.isEqual&&z(d.isEqual))return d.isEqual(c);var n=A.call(c);
if(n!=A.call(d))return D;switch(n){case S:return c==""+d;case U:return c!=+c?d!=+d:0==c?1/c==1/d:c==+d;case la:case ma:return+c==+d;case na:return c.source==d.source&&c.global==d.global&&c.multiline==d.multiline&&c.ignoreCase==d.ignoreCase}if("object"!=typeof c||"object"!=typeof d)return D;for(var f=e.length;f--;)if(e[f]==c)return C;var f=C,w=0;e.push(c);if(n==Q){if(w=c.length,f=w==d.length)for(;w--&&(f=w in c==w in d&&x(c[w],d[w],e)););}else{if("constructor"in c!="constructor"in d||c.constructor!=
d.constructor)return D;for(var g in c)if(G.call(c,g)&&(w++,!(f=G.call(d,g)&&x(c[g],d[g],e))))break;if(f){for(g in d)if(G.call(d,g)&&!w--)break;f=!w}}e.pop();return f}function z(b){return A.call(b)==ja}function I(b){return b}function V(b){H(W(b),function(c){var d=e[c]=b[c];e.prototype[c]=function(){var b=B.call(arguments);va.call(b,this.o);b=d.apply(e,b);return this.p?(new h(b)).chain():b}})}var C=!0,D=!1,y={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"};(function(){for(var b in y)y[y[b]]=
b})();var E="object"==typeof exports&&exports&&("object"==typeof global&&global&&global==global.global&&(c=global),exports),n=0,w=c._,wa=/\\|'|\r|\n|\t|\u2028|\u2029/g,ga=/.^/,ba=/\\(\\|'|r|n|t|u2028|u2029)/g,Q="[object Array]",la="[object Boolean]",ma="[object Date]",ja="[object Function]",U="[object Number]",na="[object RegExp]",S="[object String]",J=Array.prototype,X=Object.prototype,ia=J.concat,G=X.hasOwnProperty,da=J.push,B=J.slice,A=X.toString,va=J.unshift,xa=c.isFinite,X=Object.keys,ua=c.clearTimeout,
T=c.setTimeout,Y={b:"b",m:"var I=i.apply([],z.call(arguments,1))",h:"[]",g:"if(p(I,b[o])<0)y.push(b[o])"},K={h:"F",g:"if(!e(g[o],o,g))return !y"},ha={b:"v",h:"v",d:"for(var A,j=1,u=arguments.length;j<u;j++){A=arguments[j]",j:"o in A",g:"v[o]=A[o]",n:D,a:"}"},O={h:"[]",g:"e(g[o],o,g)&&y.push(g[o])"},F={b:"g,e,D",m:"if(!e){e=n}else if(D){e=d(e,D)}",h:"g",g:"e(g[o],o,g)"},oa={b:"v",m:"if(v!==Object(v))throw TypeError()",h:"[]",g:"y.push(o)"},P={h:"",f:"[]",d:{c:"y=Array(u)",k:"y=[]"},g:{c:"y[o]=e(g[o],o,g)",
k:"y[y.length]=e(g[o],o,g)"}},L={m:"var j,y=-q,h=y;if(!e){if(s(g)&&g[0]===+g[0])return w.max.apply(w,g);if(t(g))return y;}else if(D)e=d(e,D)",g:"j=e?e(g[o],o,g):g[o];if(j>=h)h=j,y=g[o]"},R=Array.isArray||function(b){return A.call(b)==Q},ka=f({b:"H",i:"b",m:"var f=E.call(H)",h:"F",d:"if(f==c||f==B)return !H.length",g:"return k"}),pa=f({b:"g,C",h:"k",g:"if(g[o]===C)return F"}),fa=f(F,K),ea=f(F,O),qa=f(F,{g:"if(e(g[o],o,g))return g[o]"}),H=f(F),N=f(F,P),ra=f(F,L),L=f(F,L,{m:L.m.replace("-","").replace("max",
"min"),g:L.g.replace(">=","<")}),Z=f(P,{b:"g,x",g:{c:"y[o]=g[o][x]",k:"y[y.length]=g[o][x]"}}),M=f({b:"g,e,a,D",m:"var r=arguments.length>2;if(D)e=d(e,D)",h:"a",d:{c:"if(!r)y=g[++o]"},g:{c:"y=e(y,g[o],o,g)",k:"y=r?e(y,g[o],o,g):(r=F,g[o])"}}),O=f(F,O,{g:"!"+O.g}),K=f(F,K,{h:"k",g:K.g.replace("!","")}),sa=f(P,{b:"g",g:{c:"y[o]=g[o]",k:"y[y.length]=g[o]"}}),P=f({b:"b",h:"[]",g:"if(b[o])y.push(b[o])"}),F=f(Y),Y=f(Y,{m:"var I=z.call(arguments,1)",h:"[]"}),ta=f(ha,{g:"if(v[o]==G)"+ha.g}),aa=f(ha),W=f(oa,
{m:"",n:D,g:"if(E.call(v[o])==l)y.push(o)",l:"y.sort()"});d(arguments)||(d=function(b){return!(!b||!G.call(b,"callee"))});var ca=X||f(oa);aa(e,{VERSION:"0.1.0",templateSettings:{escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},after:function(b,c){return 1>b?c():function(){if(1>--b)return c.apply(this,arguments)}},bind:u,bindAll:function(b){var c=arguments,d=1;1==c.length&&(d=0,c=W(b));for(var e=c.length;d<e;d++)b[c[d]]=u(b[c[d]],b);return b},chain:function(b){return(new h(b)).chain()},
clone:function(b){return b!==Object(b)?b:R(b)?b.slice():aa({},b)},compact:P,compose:function(){var b=arguments;return function(){for(var c=arguments,d=b.length;d--;)c=[b[d].apply(this,c)];return c[0]}},contains:pa,debounce:q,defaults:ta,defer:function(c){var d=B.call(arguments,1);return T(function(){return c.apply(b,d)},1)},delay:function(c,d){var e=B.call(arguments,2);return T(function(){return c.apply(b,e)},d)},difference:F,escape:function(b){return(b+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,
"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},every:fa,extend:aa,filter:ea,find:qa,first:l,flatten:v,forEach:H,functions:W,groupBy:function(b,c){var d={};if(!z(c))var e=c,c=function(b){return b[e]};H(b,function(b,e,n){e=c(b,e,n);(d[e]||(d[e]=[])).push(b)});return d},has:function(b,c){return G.call(b,c)},identity:I,indexOf:p,initial:function(c,d,e){return B.call(c,0,-(d==b||e?1:d))},intersection:k,invoke:function(b,c){var d=B.call(arguments,2),e=z(c);return N(b,function(b){return(e?
c||b:b[c]).apply(b,d)})},isArguments:d,isArray:R,isBoolean:function(b){return b===C||b===D||A.call(b)==la},isDate:function(b){return A.call(b)==ma},isElement:function(b){return!!(b&&1==b.nodeType)},isEmpty:ka,isEqual:x,isFinite:function(b){return xa(b)&&A.call(b)==U},isFunction:z,isNaN:function(b){return A.call(b)==U&&b!=+b},isNull:function(b){return null===b},isNumber:function(b){return A.call(b)==U},isObject:function(b){return b===Object(b)},isRegExp:function(b){return A.call(b)==na},isString:function(b){return A.call(b)==
S},isUndefined:function(c){return c===b},keys:ca,last:o,lastIndexOf:function(c,d){if(c==b)return-1;for(var e=c.length;e--;)if(c[e]===d)return e;return-1},map:N,max:ra,memoize:function(b,c){var d={};return function(){var e=c?c.apply(this,arguments):arguments[0];return G.call(d,e)?d[e]:d[e]=b.apply(this,arguments)}},min:L,mixin:V,noConflict:function(){c._=w;return this},once:function(b){var c,d=D;return function(){if(d)return c;d=C;return c=b.apply(this,arguments)}},pick:function(b){for(var c,d=-1,
e=v(B.call(arguments,1)),n=e.length,f={};++d<n;)c=e[d],c in b&&(f[c]=b[c]);return f},pluck:Z,range:function(b,c,d){d||(d=1);2>arguments.length&&(c=b||0,b=0);for(var e=-1,n=Math.max(Math.ceil((c-b)/d),0),f=Array(n);++e<n;)f[e]=b,b+=d;return f},reduce:M,reduceRight:g,reject:O,rest:t,result:function(c,d){if(c==b)return null;var e=c[d];return z(e)?c[d]():e},shuffle:function(b){var c,d=[];H(b,function(b,e){c=Math.floor(Math.random()*(e+1));d[e]=d[c];d[c]=b});return d},size:function(b){var c=A.call(b);
return c==Q||c==S?b.length:ca(b).length},some:K,sortBy:function(c,d,e){if(z(d))e&&(d=u(d,e));else var n=d,d=function(b){return b[n]};return Z(N(c,function(b,e){return{a:d(b,e,c),b:b}}).sort(function(c,d){var e=c.a,n=d.a;return e===b?1:n===b?-1:e<n?-1:e>n?1:0}),"b")},sortedIndex:m,tap:function(b,c){c(b);return b},template:function(b,c,d){function n(b){return f.call(this,b,e)}d=ta(d||{},e.templateSettings);b="__p+='"+b.replace(wa,function(b){return"\\"+y[b]}).replace(d.escape||ga,function(b,c){return"'+((__t=("+
j(c)+"))==null?'':_['escape'](__t))+'"}).replace(d.interpolate||ga,function(b,c){return"'+((__t=("+j(c)+"))==null?'':__t)+'"}).replace(d.evaluate||ga,function(b,c){return"';"+j(c)+";__p+='"})+"';";d.variable||(b="with(object||{}){"+b+"}");var b='var __t,__j=Array.prototype.join,__p="";function print(){__p+=__j.call(arguments,"")}'+b+"return __p",f=Function(d.variable||"object","_",b);if(c)return f(c,e);n.source="function("+(d.variable||"object")+"){"+b+"}";return n},throttle:function(c,d){var e,n,
f,w,g,k,h=q(function(){n=g=D},d);return function(){e=arguments;w=this;k||(k=T(function(){k=b;n&&c.apply(w,e);h()},d));g?n=C:f=c.apply(w,e);h();g=C;return f}},times:function(b,c,d){d&&(c=u(c,d));for(d=0;d<b;d++)c(d)},toArray:function(b){if(!b)return[];if(z(b.toArray))return b.toArray();var c=b.length;return c===+c?B.call(b):sa(b)},union:function(){return s(v(arguments,C))},uniq:s,uniqueId:function(b){var c=n++;return b?b+c:c},values:sa,without:Y,wrap:function(b,c){return function(){var d=[b];da.apply(d,
arguments);return c.apply(this,d)}},zip:function(){for(var b=-1,c=ra(Z(arguments,"length")),d=Array(c);++b<c;)d[b]=Z(arguments,b);return d},all:fa,any:K,collect:N,detect:qa,each:H,foldl:M,foldr:g,head:l,include:pa,inject:M,intersect:k,methods:W,select:ea,tail:t,take:l,unique:s});h.prototype=e.prototype;V(e);H("pop,push,reverse,shift,sort,splice,unshift".split(","),function(b){var c=J[b];e.prototype[b]=function(){var b=this.o;c.apply(b,arguments);b.length===0&&delete b[0];return this.p?(new h(b)).chain():
b}});H(["concat","join","slice"],function(b){var c=J[b];h.prototype[b]=function(){var b=c.apply(this.o,arguments);return this.p?(new h(b)).chain():b}});aa(h.prototype,{chain:function(){this.p=C;return this},value:function(){return this.o}});E?"object"==typeof module&&module&&module.q==E?(module.q=e)._=e:E._=e:(c._=e,"function"==typeof define&&"object"==typeof define.amd&&define.amd&&define.amd.lodash&&define("lodash",function(){return e}))})(this);(function(){var c=this,b=c.Backbone,d=Array.prototype.slice,e=Array.prototype.splice,h;h="undefined"!==typeof exports?exports:c.Backbone={};h.VERSION="0.9.2";var f=c._;!f&&"undefined"!==typeof require&&(f=require("underscore"));var j=c.jQuery||c.Zepto||c.ender;h.setDomLibrary=function(b){j=b};h.noConflict=function(){c.Backbone=b;return this};h.emulateHTTP=!1;h.emulateJSON=!1;var g=/\s+/,m=h.Events={on:function(b,c,d){var e,f,k,h,q;if(!c)return this;b=b.split(g);for(e=this._callbacks||(this._callbacks=
{});f=b.shift();)k=(q=e[f])?q.tail:{},k.next=h={},k.context=d,k.callback=c,e[f]={tail:h,next:q?q.next:k};return this},off:function(b,c,d){var e,k,h,q,m,l;if(k=this._callbacks){if(!b&&!c&&!d)return delete this._callbacks,this;for(b=b?b.split(g):f.keys(k);e=b.shift();)if(h=k[e],delete k[e],h&&(c||d))for(q=h.tail;(h=h.next)!==q;)if(m=h.callback,l=h.context,c&&m!==c||d&&l!==d)this.on(e,m,l);return this}},trigger:function(b){var c,e,f,k,h,q;if(!(f=this._callbacks))return this;h=f.all;b=b.split(g);for(q=
d.call(arguments,1);c=b.shift();){if(e=f[c])for(k=e.tail;(e=e.next)!==k;)e.callback.apply(e.context||this,q);if(e=h){k=e.tail;for(c=[c].concat(q);(e=e.next)!==k;)e.callback.apply(e.context||this,c)}}return this}};m.bind=m.on;m.unbind=m.off;var l=h.Model=function(b,c){var d;b||(b={});c&&c.parse&&(b=this.parse(b));if(d=y(this,"defaults"))b=f.extend({},d,b);c&&c.collection&&(this.collection=c.collection);this.attributes={};this._escapedAttributes={};this.cid=f.uniqueId("c");this.changed={};this._silent=
{};this._pending={};this.set(b,{silent:!0});this.changed={};this._silent={};this._pending={};this._previousAttributes=f.clone(this.attributes);this.initialize.apply(this,arguments)};f.extend(l.prototype,m,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},get:function(b){return this.attributes[b]},escape:function(b){var c;if(c=this._escapedAttributes[b])return c;c=this.get(b);return this._escapedAttributes[b]=f.escape(null==
c?"":""+c)},has:function(b){return null!=this.get(b)},set:function(b,c,d){var e,g;f.isObject(b)||null==b?(e=b,d=c):(e={},e[b]=c);d||(d={});if(!e)return this;e instanceof l&&(e=e.attributes);if(d.unset)for(g in e)e[g]=void 0;if(!this._validate(e,d))return!1;this.idAttribute in e&&(this.id=e[this.idAttribute]);var c=d.changes={},k=this.attributes,h=this._escapedAttributes,q=this._previousAttributes||{};for(g in e){b=e[g];if(!f.isEqual(k[g],b)||d.unset&&f.has(k,g))delete h[g],(d.silent?this._silent:
c)[g]=!0;d.unset?delete k[g]:k[g]=b;!f.isEqual(q[g],b)||f.has(k,g)!=f.has(q,g)?(this.changed[g]=b,d.silent||(this._pending[g]=!0)):(delete this.changed[g],delete this._pending[g])}d.silent||this.change(d);return this},unset:function(b,c){(c||(c={})).unset=!0;return this.set(b,null,c)},clear:function(b){(b||(b={})).unset=!0;return this.set(f.clone(this.attributes),b)},fetch:function(b){var b=b?f.clone(b):{},c=this,d=b.success;b.success=function(e,f,g){if(!c.set(c.parse(e,g),b))return!1;d&&d(c,e)};
b.error=h.wrapError(b.error,c,b);return(this.sync||h.sync).call(this,"read",this,b)},save:function(b,c,d){var e,g;f.isObject(b)||null==b?(e=b,d=c):(e={},e[b]=c);d=d?f.clone(d):{};if(d.wait){if(!this._validate(e,d))return!1;g=f.clone(this.attributes)}b=f.extend({},d,{silent:!0});if(e&&!this.set(e,d.wait?b:d))return!1;var k=this,q=d.success;d.success=function(b,c,n){c=k.parse(b,n);if(d.wait){delete d.wait;c=f.extend(e||{},c)}if(!k.set(c,d))return false;q?q(k,b):k.trigger("sync",k,b,d)};d.error=h.wrapError(d.error,
k,d);c=this.isNew()?"create":"update";c=(this.sync||h.sync).call(this,c,this,d);d.wait&&this.set(g,b);return c},destroy:function(b){var b=b?f.clone(b):{},c=this,d=b.success,e=function(){c.trigger("destroy",c,c.collection,b)};if(this.isNew())return e(),!1;b.success=function(f){b.wait&&e();d?d(c,f):c.trigger("sync",c,f,b)};b.error=h.wrapError(b.error,c,b);var g=(this.sync||h.sync).call(this,"delete",this,b);b.wait||e();return g},url:function(){var b=y(this,"urlRoot")||y(this.collection,"url")||E();
return this.isNew()?b:b+("/"==b.charAt(b.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(b){return b},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(b){b||(b={});var c=this._changing;this._changing=!0;for(var d in this._silent)this._pending[d]=!0;var e=f.extend({},b.changes,this._silent);this._silent={};for(d in e)this.trigger("change:"+d,this,this.get(d),b);if(c)return this;for(;!f.isEmpty(this._pending);){this._pending=
{};this.trigger("change",this,b);for(d in this.changed)!this._pending[d]&&!this._silent[d]&&delete this.changed[d];this._previousAttributes=f.clone(this.attributes)}this._changing=!1;return this},hasChanged:function(b){return!arguments.length?!f.isEmpty(this.changed):f.has(this.changed,b)},changedAttributes:function(b){if(!b)return this.hasChanged()?f.clone(this.changed):!1;var c,d=!1,e=this._previousAttributes,g;for(g in b)if(!f.isEqual(e[g],c=b[g]))(d||(d={}))[g]=c;return d},previous:function(b){return!arguments.length||
!this._previousAttributes?null:this._previousAttributes[b]},previousAttributes:function(){return f.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(b,c){if(c.silent||!this.validate)return!0;var b=f.extend({},this.attributes,b),d=this.validate(b,c);if(!d)return!0;c&&c.error?c.error(this,d,c):this.trigger("error",this,d,c);return!1}});var v=h.Collection=function(b,c){c||(c={});c.model&&(this.model=c.model);c.comparator&&(this.comparator=c.comparator);
this._reset();this.initialize.apply(this,arguments);b&&this.reset(b,{silent:!0,parse:c.parse})};f.extend(v.prototype,m,{model:l,initialize:function(){},toJSON:function(b){return this.map(function(c){return c.toJSON(b)})},add:function(b,c){var d,g,k,h,q,m={},l={},x=[];c||(c={});b=f.isArray(b)?b.slice():[b];d=0;for(g=b.length;d<g;d++){if(!(k=b[d]=this._prepareModel(b[d],c)))throw Error("Can't add an invalid model to a collection");h=k.cid;q=k.id;m[h]||this._byCid[h]||null!=q&&(l[q]||this._byId[q])?
x.push(d):m[h]=l[q]=k}for(d=x.length;d--;)b.splice(x[d],1);d=0;for(g=b.length;d<g;d++)(k=b[d]).on("all",this._onModelEvent,this),this._byCid[k.cid]=k,null!=k.id&&(this._byId[k.id]=k);this.length+=g;e.apply(this.models,[null!=c.at?c.at:this.models.length,0].concat(b));this.comparator&&this.sort({silent:!0});if(c.silent)return this;d=0;for(g=this.models.length;d<g;d++)if(m[(k=this.models[d]).cid])c.index=d,k.trigger("add",k,this,c);return this},remove:function(b,c){var d,e,g,k;c||(c={});b=f.isArray(b)?
b.slice():[b];d=0;for(e=b.length;d<e;d++)if(k=this.getByCid(b[d])||this.get(b[d]))delete this._byId[k.id],delete this._byCid[k.cid],g=this.indexOf(k),this.models.splice(g,1),this.length--,c.silent||(c.index=g,k.trigger("remove",k,this,c)),this._removeReference(k);return this},push:function(b,c){b=this._prepareModel(b,c);this.add(b,c);return b},pop:function(b){var c=this.at(this.length-1);this.remove(c,b);return c},unshift:function(b,c){b=this._prepareModel(b,c);this.add(b,f.extend({at:0},c));return b},
shift:function(b){var c=this.at(0);this.remove(c,b);return c},get:function(b){return null==b?void 0:this._byId[null!=b.id?b.id:b]},getByCid:function(b){return b&&this._byCid[b.cid||b]},at:function(b){return this.models[b]},where:function(b){return f.isEmpty(b)?[]:this.filter(function(c){for(var d in b)if(b[d]!==c.get(d))return!1;return!0})},sort:function(b){b||(b={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");var c=f.bind(this.comparator,this);1==this.comparator.length?
this.models=this.sortBy(c):this.models.sort(c);b.silent||this.trigger("reset",this,b);return this},pluck:function(b){return f.map(this.models,function(c){return c.get(b)})},reset:function(b,c){b||(b=[]);c||(c={});for(var d=0,e=this.models.length;d<e;d++)this._removeReference(this.models[d]);this._reset();this.add(b,f.extend({silent:!0},c));c.silent||this.trigger("reset",this,c);return this},fetch:function(b){b=b?f.clone(b):{};void 0===b.parse&&(b.parse=!0);var c=this,d=b.success;b.success=function(e,
f,g){c[b.add?"add":"reset"](c.parse(e,g),b);d&&d(c,e)};b.error=h.wrapError(b.error,c,b);return(this.sync||h.sync).call(this,"read",this,b)},create:function(b,c){var d=this,c=c?f.clone(c):{},b=this._prepareModel(b,c);if(!b)return!1;c.wait||d.add(b,c);var e=c.success;c.success=function(f,g){c.wait&&d.add(f,c);e?e(f,g):f.trigger("sync",b,g,c)};b.save(null,c);return b},parse:function(b){return b},chain:function(){return f(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId=
{};this._byCid={}},_prepareModel:function(b,c){c||(c={});b instanceof l?b.collection||(b.collection=this):(c.collection=this,b=new this.model(b,c),b._validate(b.attributes,c)||(b=!1));return b},_removeReference:function(b){this==b.collection&&delete b.collection;b.off("all",this._onModelEvent,this)},_onModelEvent:function(b,c,d,e){("add"==b||"remove"==b)&&d!=this||("destroy"==b&&this.remove(c,e),c&&b==="change:"+c.idAttribute&&(delete this._byId[c.previous(c.idAttribute)],this._byId[c.id]=c),this.trigger.apply(this,
arguments))}});f.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,initial,rest,last,without,indexOf,shuffle,lastIndexOf,isEmpty,groupBy".split(","),function(b){v.prototype[b]=function(){return f[b].apply(f,[this.models].concat(f.toArray(arguments)))}});var p=h.Router=function(b){b||(b={});b.routes&&(this.routes=b.routes);this._bindRoutes();this.initialize.apply(this,arguments)},k=/:\w+/g,
o=/\*\w+/g,t=/[-[\]{}()+?.,\\^$|#\s]/g;f.extend(p.prototype,m,{initialize:function(){},route:function(b,c,d){h.history||(h.history=new s);f.isRegExp(b)||(b=this._routeToRegExp(b));d||(d=this[c]);h.history.route(b,f.bind(function(e){e=this._extractParameters(b,e);d&&d.apply(this,e);this.trigger.apply(this,["route:"+c].concat(e));h.history.trigger("route",this,c,e)},this));return this},navigate:function(b,c){h.history.navigate(b,c)},_bindRoutes:function(){if(this.routes){var b=[],c;for(c in this.routes)b.unshift([c,
this.routes[c]]);c=0;for(var d=b.length;c<d;c++)this.route(b[c][0],b[c][1],this[b[c][1]])}},_routeToRegExp:function(b){b=b.replace(t,"\\$&").replace(k,"([^/]+)").replace(o,"(.*?)");return RegExp("^"+b+"$")},_extractParameters:function(b,c){return b.exec(c).slice(1)}});var s=h.History=function(){this.handlers=[];f.bindAll(this,"checkUrl")},u=/^[#\/]/,q=/msie [\w.]+/;s.started=!1;f.extend(s.prototype,m,{interval:50,getHash:function(b){return(b=(b?b.location:window.location).href.match(/#(.*)$/))?b[1]:
""},getFragment:function(b,c){if(null==b)if(this._hasPushState||c){var b=window.location.pathname,d=window.location.search;d&&(b+=d)}else b=this.getHash();b.indexOf(this.options.root)||(b=b.substr(this.options.root.length));return b.replace(u,"")},start:function(b){if(s.started)throw Error("Backbone.history has already been started");s.started=!0;this.options=f.extend({},{root:"/"},this.options,b);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=
!(!this.options.pushState||!window.history||!window.history.pushState);var b=this.getFragment(),c=document.documentMode;if(c=q.exec(navigator.userAgent.toLowerCase())&&(!c||7>=c))this.iframe=j('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(b);this._hasPushState?j(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!c?j(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,
this.interval));this.fragment=b;b=window.location;c=b.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!c)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&c&&b.hash&&(this.fragment=this.getHash().replace(u,""),window.history.replaceState({},document.title,b.protocol+"//"+b.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},
stop:function(){j(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);s.started=!1},route:function(b,c){this.handlers.unshift({route:b,callback:c})},checkUrl:function(){var b=this.getFragment();b==this.fragment&&this.iframe&&(b=this.getFragment(this.getHash(this.iframe)));if(b==this.fragment)return!1;this.iframe&&this.navigate(b);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(b){var c=this.fragment=this.getFragment(b);return f.any(this.handlers,
function(b){if(b.route.test(c))return b.callback(c),!0})},navigate:function(b,c){if(!s.started)return!1;if(!c||!0===c)c={trigger:c};var d=(b||"").replace(u,"");this.fragment!=d&&(this._hasPushState?(0!=d.indexOf(this.options.root)&&(d=this.options.root+d),this.fragment=d,window.history[c.replace?"replaceState":"pushState"]({},document.title,d)):this._wantsHashChange?(this.fragment=d,this._updateHash(window.location,d,c.replace),this.iframe&&d!=this.getFragment(this.getHash(this.iframe))&&(c.replace||
this.iframe.document.open().close(),this._updateHash(this.iframe.location,d,c.replace))):window.location.assign(this.options.root+b),c.trigger&&this.loadUrl(b))},_updateHash:function(b,c,d){d?b.replace(b.toString().replace(/(javascript:|#).*$/,"")+"#"+c):b.hash=c}});var x=h.View=function(b){this.cid=f.uniqueId("view");this._configure(b||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()},z=/^(\S+)\s*(.*)$/,I="model,collection,el,id,attributes,className,tagName".split(",");
f.extend(x.prototype,m,{tagName:"div",$:function(b){return this.$el.find(b)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(b,c,d){b=document.createElement(b);c&&j(b).attr(c);d&&j(b).html(d);return b},setElement:function(b,c){this.$el&&this.undelegateEvents();this.$el=b instanceof j?b:j(b);this.el=this.$el[0];!1!==c&&this.delegateEvents();return this},delegateEvents:function(b){if(b||(b=y(this,"events"))){this.undelegateEvents();
for(var c in b){var d=b[c];f.isFunction(d)||(d=this[b[c]]);if(!d)throw Error('Method "'+b[c]+'" does not exist');var e=c.match(z),g=e[1],e=e[2],d=f.bind(d,this),g=g+(".delegateEvents"+this.cid);""===e?this.$el.bind(g,d):this.$el.delegate(e,g,d)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(b){this.options&&(b=f.extend({},this.options,b));for(var c=0,d=I.length;c<d;c++){var e=I[c];b[e]&&(this[e]=b[e])}this.options=b},_ensureElement:function(){if(this.el)this.setElement(this.el,
!1);else{var b=y(this,"attributes")||{};this.id&&(b.id=this.id);this.className&&(b["class"]=this.className);this.setElement(this.make(this.tagName,b),!1)}}});l.extend=v.extend=p.extend=x.extend=function(b,c){var d=D(this,b,c);d.extend=this.extend;return d};var V={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};h.sync=function(b,c,d){var e=V[b];d||(d={});var g={type:e,dataType:"json"};d.url||(g.url=y(c,"url")||E());if(!d.data&&c&&("create"==b||"update"==b))g.contentType="application/json",
g.data=JSON.stringify(c.toJSON());h.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{});if(h.emulateHTTP&&("PUT"===e||"DELETE"===e))h.emulateJSON&&(g.data._method=e),g.type="POST",g.beforeSend=function(b){b.setRequestHeader("X-HTTP-Method-Override",e)};"GET"!==g.type&&!h.emulateJSON&&(g.processData=!1);return j.ajax(f.extend(g,d))};h.wrapError=function(b,c,d){return function(e,f){f=e===c?f:e;b?b(c,f,d):c.trigger("error",c,f,d)}};var C=function(){},D=function(b,
c,d){var e;e=c&&c.hasOwnProperty("constructor")?c.constructor:function(){b.apply(this,arguments)};f.extend(e,b);C.prototype=b.prototype;e.prototype=new C;c&&f.extend(e.prototype,c);d&&f.extend(e,d);e.prototype.constructor=e;e.__super__=b.prototype;return e},y=function(b,c){return!b||!b[c]?null:f.isFunction(b[c])?b[c]():b[c]},E=function(){throw Error('A "url" property or function must be specified');}}).call(this);var GeoJSON=function(c,b,d){var e=function(c,d,g){var j;switch(c.type){case "Point":d.position=new google.maps.LatLng(c.coordinates[1],c.coordinates[0]);"agencies"==b?d.icon="img/icons/agency.png":"ashokas"==b&&(d.icon="img/icons/ashoka.png");"agencies"==b&&(d.topic_id=g.topic_id);j=new NexsoMarker(b,d,g);break;case "MultiPoint":j=[];for(var k=0;k<c.coordinates.length;k++)d.position=new google.maps.LatLng(c.coordinates[k][1],c.coordinates[k][0]),g&&(j[u].opts.geojsonProperties=g),j.push(new NexsoMarker(b,
d));break;case "LineString":for(var o=[],k=0;k<c.coordinates.length;k++){var t=c.coordinates[k],t=new google.maps.LatLng(t[1],t[0]);o.push(t)}d.path=o;j=new google.maps.Polyline(d);g&&j.set("geojsonProperties",g);break;case "MultiLineString":j=[];for(k=0;k<c.coordinates.length;k++){for(var o=[],s=0;s<c.coordinates[k].length;s++)t=c.coordinates[k][s],t=new google.maps.LatLng(t[1],t[0]),o.push(t);d.path=o;j.push(new google.maps.Polyline(d))}if(g)for(var u=0;u<j.length;u++)j[u].set("geojsonProperties",
g);break;case "Polygon":for(var q=[],x,z,k=0;k<c.coordinates.length;k++){o=[];for(s=0;s<c.coordinates[k].length;s++)t=new google.maps.LatLng(c.coordinates[k][s][1],c.coordinates[k][s][0]),o.push(t);k?(1==k&&(z=f(o)),x==z?q.push(o.reverse()):q.push(o)):(x=f(o),q.push(o))}d.paths=q;d.zindex=3E4;j=new google.maps.Polygon(d);g&&j.set("geojsonProperties",g);break;case "MultiPolygon":j=[];for(k=0;k<c.coordinates.length;k++){q=[];for(s=0;s<c.coordinates[k].length;s++){o=[];for(u=0;u<c.coordinates[k][s].length;u++)t=
new google.maps.LatLng(c.coordinates[k][s][u][1],c.coordinates[k][s][u][0]),o.push(t);s?(1==s&&(z=f(o)),x==z?q.push(o.reverse()):q.push(o)):(x=f(o),q.push(o))}d.paths=q;j.push(new google.maps.Polygon(d))}if(g)for(u=0;u<j.length;u++)j[u].set("geojsonProperties",g);break;case "GeometryCollection":j=[];if(c.geometries)for(k=0;k<c.geometries.length;k++)j.push(e(c.geometries[k],d,g||null));else j=h('Invalid GeoJSON object: GeometryCollection object missing "geometries" member.');break;default:j=h('Invalid GeoJSON object: Geometry object must be one of "Point", "LineString", "Polygon" or "MultiPolygon".')}return j},
h=function(b){return{type:"Error",message:b}},f=function(b){for(var c,d=0;d<b.length-2;d++)if(a=(b[d+1].lat()-b[d].lat())*(b[d+2].lng()-b[d].lng())-(b[d+2].lat()-b[d].lat())*(b[d+1].lng()-b[d].lng()),0<a){c=!0;break}else if(0>a){c=!1;break}return c},j=d||{};switch(c.type){case "FeatureCollection":if(c.features)for(var d=[],g=0;g<c.features.length;g++)d.push(e(c.features[g].geometry,j,c.features[g].properties));else d=h('Invalid GeoJSON object: FeatureCollection object missing "features" member.');
break;case "GeometryCollection":if(c.geometries){d=[];for(g=0;g<c.geometries.length;g++)d.push(e(c.geometries[g],j))}else d=h('Invalid GeoJSON object: GeometryCollection object missing "geometries" member.');break;case "Feature":d=!c.properties||!c.geometry?h('Invalid GeoJSON object: Feature object missing "properties" or "geometry" member.'):e(c.geometry,j,c.properties);break;case "Point":case "MultiPoint":case "LineString":case "MultiLineString":case "Polygon":case "MultiPolygon":d=c.coordinates?
d=e(c,j):h('Invalid GeoJSON object: Geometry object missing "coordinates" member.');break;default:d=h('Invalid GeoJSON object: GeoJSON object must be one of "Point", "LineString", "Polygon", "MultiPolygon", "Feature", "FeatureCollection" or "GeometryCollection".')}return d};(function(c,b){function d(b){return!!(""===b||b&&b.charCodeAt&&b.substr)}function e(b){return p?p(b):"[object Array]"===k.call(b)}function h(b){return"[object Object]"===k.call(b)}function f(b,c){var d,b=b||{},c=c||{};for(d in c)c.hasOwnProperty(d)&&null==b[d]&&(b[d]=c[d]);return b}function j(b,c,d){var e=[],f,g;if(!b)return e;if(v&&b.map===v)return b.map(c,d);f=0;for(g=b.length;f<g;f++)e[f]=c.call(d,b[f],f,b);return e}function g(b,c){b=Math.round(Math.abs(b));return isNaN(b)?c:b}function m(b){var c=
l.settings.currency.format;"function"===typeof b&&(b=b());return d(b)&&b.match("%v")?{pos:b,neg:b.replace("-","").replace("%v","-%v"),zero:b}:!b||!b.pos||!b.pos.match("%v")?!d(c)?c:l.settings.currency.format={pos:c,neg:c.replace("%v","-%v"),zero:c}:b}var l={version:"0.3.2",settings:{currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}}},v=Array.prototype.map,p=Array.isArray,k=Object.prototype.toString,o=l.unformat=
l.parse=function(b,c){if(e(b))return j(b,function(b){return o(b,c)});b=b||0;if("number"===typeof b)return b;var c=c||".",d=RegExp("[^0-9-"+c+"]",["g"]),d=parseFloat((""+b).replace(/\((.*)\)/,"-$1").replace(d,"").replace(c,"."));return!isNaN(d)?d:0},t=l.toFixed=function(b,c){var c=g(c,l.settings.number.precision),d=Math.pow(10,c);return(Math.round(l.unformat(b)*d)/d).toFixed(c)},s=l.formatNumber=function(b,c,d,k){if(e(b))return j(b,function(b){return s(b,c,d,k)});var b=o(b),m=f(h(c)?c:{precision:c,
thousand:d,decimal:k},l.settings.number),u=g(m.precision),v=0>b?"-":"",p=parseInt(t(Math.abs(b||0),u),10)+"",E=3<p.length?p.length%3:0;return v+(E?p.substr(0,E)+m.thousand:"")+p.substr(E).replace(/(\d{3})(?=\d)/g,"$1"+m.thousand)+(u?m.decimal+t(Math.abs(b),u).split(".")[1]:"")},u=l.formatMoney=function(b,c,d,k,t,v){if(e(b))return j(b,function(b){return u(b,c,d,k,t,v)});var b=o(b),p=f(h(c)?c:{symbol:c,precision:d,thousand:k,decimal:t,format:v},l.settings.currency),y=m(p.format);return(0<b?y.pos:0>
b?y.neg:y.zero).replace("%s",p.symbol).replace("%v",s(Math.abs(b),g(p.precision),p.thousand,p.decimal))};l.formatColumn=function(b,c,k,u,t,v){if(!b)return[];var p=f(h(c)?c:{symbol:c,precision:k,thousand:u,decimal:t,format:v},l.settings.currency),y=m(p.format),E=y.pos.indexOf("%s")<y.pos.indexOf("%v")?!0:!1,n=0,b=j(b,function(b){if(e(b))return l.formatColumn(b,p);b=o(b);b=(0<b?y.pos:0>b?y.neg:y.zero).replace("%s",p.symbol).replace("%v",s(Math.abs(b),g(p.precision),p.thousand,p.decimal));b.length>n&&
(n=b.length);return b});return j(b,function(b){return d(b)&&b.length<n?E?b.replace(p.symbol,p.symbol+Array(n-b.length+1).join(" ")):Array(n-b.length+1).join(" ")+b:b})};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=l),exports.accounting=l):"function"===typeof define&&define.amd?define([],function(){return l}):(l.noConflict=function(d){return function(){c.accounting=d;l.noConflict=b;return l}}(c.accounting),c.accounting=l)})(this);(function(c,b,d){function e(c,d){var e=b.createElement(c||"div"),f;for(f in d)e[f]=d[f];return e}function h(b){for(var c=1,d=arguments.length;c<d;c++)b.appendChild(arguments[c]);return b}function f(b,c,d,e){var f=["opacity",c,~~(100*b),d,e].join("-"),d=0.01+100*(d/e),e=Math.max(1-(1-b)/c*(100-d),b),g=k.substring(0,k.indexOf("Animation")).toLowerCase();return p[f]||(o.insertRule("@"+(g&&"-"+g+"-"||"")+"keyframes "+f+"{0%{opacity:"+e+"}"+d+"%{opacity:"+b+"}"+(d+0.01)+"%{opacity:1}"+(d+c)%100+"%{opacity:"+
b+"}100%{opacity:"+e+"}}",0),p[f]=1),f}function j(b,c){var e=b.style,f,g;if(e[c]!==d)return c;c=c.charAt(0).toUpperCase()+c.slice(1);for(g=0;g<v.length;g++)if(f=v[g]+c,e[f]!==d)return f}function g(b,c){for(var d in c)b.style[j(b,d)||d]=c[d];return b}function m(b){for(var c=1;c<arguments.length;c++){var e=arguments[c],f;for(f in e)b[f]===d&&(b[f]=e[f])}return b}function l(b){for(var c={x:b.offsetLeft,y:b.offsetTop};b=b.offsetParent;)c.x+=b.offsetLeft,c.y+=b.offsetTop;return c}var v=["webkit","Moz",
"ms","O"],p={},k,o=function(){var c=e("style");return h(b.getElementsByTagName("head")[0],c),c.sheet||c.styleSheet}(),t={lines:12,length:7,width:5,radius:10,rotate:0,color:"#000",speed:1,trail:100,opacity:0.25,fps:20,zIndex:2E9,className:"spinner",top:"auto",left:"auto"},s=function q(b){if(!this.spin)return new q(b);this.opts=m(b||{},q.defaults,t)};s.defaults={};m(s.prototype,{spin:function(b){this.stop();var c=this,d=c.opts,f=c.el=g(e(0,{className:d.className}),{position:"relative",zIndex:d.zIndex}),
h=d.radius+d.length+d.width,j,m;b&&(b.insertBefore(f,b.firstChild||null),m=l(b),j=l(f),g(f,{left:("auto"==d.left?m.x-j.x+(b.offsetWidth>>1):d.left+h)+"px",top:("auto"==d.top?m.y-j.y+(b.offsetHeight>>1):d.top+h)+"px"}));f.setAttribute("aria-role","progressbar");c.lines(f,c.opts);if(!k){var o=0,t=d.fps,s=t/d.speed,p=(1-d.opacity)/(s*d.trail/100),v=s/d.lines;!function ba(){o++;for(var b=d.lines;b;b--){var e=Math.max(1-(o+b*v)%s*p,d.opacity);c.opacity(f,d.lines-b,e,d)}c.timeout=c.el&&setTimeout(ba,~~(1E3/
t))}()}return c},stop:function(){var b=this.el;return b&&(clearTimeout(this.timeout),b.parentNode&&b.parentNode.removeChild(b),this.el=d),this},lines:function(b,c){function d(b,f){return g(e(),{position:"absolute",width:c.length+c.width+"px",height:c.width+"px",background:b,boxShadow:f,transformOrigin:"left",transform:"rotate("+~~(360/c.lines*j+c.rotate)+"deg) translate("+c.radius+"px,0)",borderRadius:(c.width>>1)+"px"})}for(var j=0,l;j<c.lines;j++)l=g(e(),{position:"absolute",top:1+~(c.width/2)+
"px",transform:c.hwaccel?"translate3d(0,0,0)":"",opacity:c.opacity,animation:k&&f(c.opacity,c.trail,j,c.lines)+" "+1/c.speed+"s linear infinite"}),c.shadow&&h(l,g(d("#000","0 0 4px #000"),{top:"2px"})),h(b,h(l,d(c.color,"0 0 1px rgba(0,0,0,.1)")));return b},opacity:function(b,c,d){c<b.childNodes.length&&(b.childNodes[c].style.opacity=d)}});!function(){function b(c,d){return e("<"+c+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',d)}var c=g(e("group"),{behavior:"url(#default#VML)"});!j(c,
"transform")&&c.adj?(o.addRule(".spin-vml","behavior:url(#default#VML)"),s.prototype.lines=function(c,d){function e(){return g(b("group",{coordsize:j+" "+j,coordorigin:-k+" "+-k}),{width:j,height:j})}function f(c,j,l){h(m,h(g(e(),{rotation:360/d.lines*c+"deg",left:~~j}),h(g(b("roundrect",{arcsize:1}),{width:k,height:d.width,left:d.radius,top:-d.width>>1,filter:l}),b("fill",{color:d.color,opacity:d.opacity}),b("stroke",{opacity:0}))))}var k=d.length+d.width,j=2*k,l=2*-(d.width+d.length)+"px",m=g(e(),
{position:"absolute",top:l,left:l});if(d.shadow)for(l=1;l<=d.lines;l++)f(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=d.lines;l++)f(l);return h(c,m)},s.prototype.opacity=function(b,c,d,e){b=b.firstChild;e=e.shadow&&e.lines||0;b&&c+e<b.childNodes.length&&(b=b.childNodes[c+e],b=b&&b.firstChild,b=b&&b.firstChild,b&&(b.opacity=d))}):k=j(c,"animation")}();c.Spinner=s})(window,document);Backbone.CartoDB=function(c,b,d){function e(b){this.sql=b}function h(b){return new e(b)}c=_.defaults(c,{USE_PROXY:!1,user:""});e.prototype.format=function(){var b=this.sql,c=arguments.length+1,d;for(i=0;i<c;d=arguments[i++])d="object"===typeof d?JSON.stringify(d):d,b=b.replace(RegExp("\\{"+(i-1)+"\\}","g"),d);return b};var f="https://"+(c.user+".cartodb.com/api/v1/sql"),b=b||function(c,d,e){var g=f,k=!0;e&&(g="api/v0/proxy/"+f,k=!1);1500<c.length?$.ajax({url:g,crossDomain:k,type:"POST",dataType:"json",
data:"q="+encodeURIComponent(c),success:d,error:function(){e?d():USE_PROXY&&b(c,d,true)}}):$.getJSON(f+"?q="+encodeURIComponent(c)+"&callback=?").success(d).fail(function(){d()}).complete(function(){})},c={setItem:function(){},getItem:function(){return null},removeItem:function(){}},d=d&&c,j=Backbone.Model.extend({_create_sql:function(){var b=h(" where {0} = '{1}'").format(this.columns[this.what],this.get(this.what).replace("'","''"));return"select "+this._sql_select().join(",")+" from "+this.table+
b},_sql_select:function(){var b=[],c;for(c in this.columns){var d=this.columns[c];-1!==d.indexOf("ST_")||"the_geom"===d?b.push(h("ST_AsGeoJSON({1}) as {0}").format(c,d)):b.push(h("{1} as {0}").format(c,d))}return b},_parse_columns:function(b){var c={},d;for(d in b){var e=b[d],f=this.columns[d];c[d]=-1!==f.indexOf("ST_")||"the_geom"===f?JSON.parse(e):b[d]}return c},fetch:function(){var c=this;b(this._create_sql(),function(b){c.set(c._parse_columns(b.rows[0]))})}}),c=Backbone.Model.extend({initialize:function(){},
author:function(){},coordinates:function(){},allowedToEdit:function(){return!0}}),g=Backbone.Collection.extend({_create_sql:function(){var b=this.table;_.isArray(this.table)||(b=[this.table]);b.join(",");b="select "+j.prototype._sql_select.call(this).join(",")+" from "+this.table;this.where_&&(b+=" WHERE "+this.where_);return b},fetch:function(){var c=this,e=this.sql||this._create_sql();"function"===typeof e&&(e=e.call(this));var f=this.cache?d.getItem(e):!1;f?c.reset(JSON.parse(f)):b(e,function(b){if(this.cache)try{d.setItem(e,
JSON.stringify(b.rows))}catch(f){}b=c.sql?b.rows:_.map(b.rows,function(b){return j.prototype._parse_columns.call(c,b)});c.reset(b)})}});return{query:b,CartoDBCollection:g,CartoDBModel:j,Note:c,SQL:h}};jQuery.fn.smartPlaceholder=function(c){this.each(function(){var b=c&&c.speed||150,d=c&&c.timeOut||100,e=$(this).find("span.placeholder"),h=$(this).find(":input").not("input[type='hidden'], input[type='submit']");h.val()&&e.hide();h.keydown(function(c){c.metaKey&&88==c.keyCode?setTimeout(function(){isEmpty(h.val())&&e.fadeIn(b)},d):c.metaKey&&86==c.keyCode?setTimeout(function(){!isEmpty(h.val())&&e.fadeOut(b)},d):setTimeout(function(){h.val()?e.fadeOut(b):e.fadeIn(b)},0)});e.on("click",function(){h.focus()});
h.blur(function(){!h.val()&&e.fadeIn(b)})})};var config={CARTODB_USER:"nexso2",CARTODB_ENDPOINT:"https://nexso2.cartodb.com/api/v2/sql",ZOOM:3,MINZOOM:3,MAXZOOM:16,LAT:3.162456,LNG:-73.476563,MONTHNAMES:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),YEARS:[2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014],DATE_FORMAT:"yyyy-MM-dd",DATE_SUFFIXES:["th","st","nd","rd"]};config.START_YEAR=config.YEARS[0];config.END_YEAR=config.YEARS[config.YEARS.length-1];
config.BIG_SPINNER_OPTIONS={lines:7,length:0,width:7,radius:8,rotate:0,color:"#000",speed:1,trail:55,shadow:!1,hwaccel:!1,zIndex:2E9,className:"spin"};
var Infowindow,Timeline,Aside,mapView,filterView,debug=!0,previousZoom=3,topics=[1,2,3,4,5,6],solutionFilter="all",previousCenter,disabledFilters=!1,globalZindex=300,projectsStyle={strokeColor:"#E79626",strokeOpacity:0.4,strokeWeight:1,fillColor:"#E79626",fillOpacity:0.2},projectsHoverStyle={strokeColor:"#E79626",strokeOpacity:1,strokeWeight:2,fillColor:"#E79626",fillOpacity:0.7},projectsDisabledStyle={strokeColor:"#E79626",strokeOpacity:0.2,strokeWeight:1,fillColor:"#E79626",fillOpacity:0.1},projectsDisabledHoverStyle=
{strokeColor:"#E79626",strokeOpacity:0.2,strokeWeight:2,fillColor:"#E79626",fillOpacity:0.2},circleStyleHover={strokeColor:"#1872A1",strokeOpacity:1,strokeWeight:2,fillColor:"#1872A1",fillOpacity:0.3},circleStyle={strokeColor:"#E79626",strokeOpacity:1,strokeWeight:1,fillColor:"#E79626",fillOpacity:0},circleDisabledStyle={strokeColor:"#E79626",strokeOpacity:0.5,strokeWeight:1,fillColor:"#E79626",fillOpacity:0},circleDisabledHoverStyle={strokeColor:"#1872A1",strokeOpacity:0.5,strokeWeight:2,fillColor:"#1872A1",
fillOpacity:0.2},mapStyles=[{featureType:"water",stylers:[{saturation:-11},{lightness:25}]},{featureType:"poi",stylers:[{saturation:-95},{lightness:61}]},{featureType:"administrative",stylers:[{saturation:-99},{gamma:3.51}]},{featureType:"road",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{visibility:"off"}]},{featureType:"landscape",stylers:[{saturation:-85},{lightness:53}]},{}],queries={GET_ASHOKAS:"SELECT A.the_geom, A.ashoka_url AS agency_url, A.topic_id AS topic_id, A.name, A.solution_id, S1.name solution_name, S1.nexso_url solution_url FROM v1_ashoka AS A LEFT JOIN v1_solutions S1 ON (S1.cartodb_id = A.solution_id)WHERE A.the_geom IS NOT NULL AND topic_id IS NOT NULL",
GET_AGENCIES:"SELECT A.the_geom, A.external_url AS agency_url, A.name AS agency_name, P.solution_id, P.topic_id, array_to_string(array(SELECT P.cartodb_id FROM v1_projects AS P WHERE P.agency_id = a.cartodb_id), '|') as projects_ids, array_to_string(array(SELECT P.title FROM v1_projects AS P WHERE P.agency_id = a.cartodb_id), '|') as projects_titles FROM v1_agencies AS A LEFT JOIN v1_projects AS P ON (A.cartodb_id = P.agency_id) LEFT JOIN v1_projects ON (A.cartodb_id = P.solution_id)",GET_PROJECTS_QUERY_TEMPLATE:"WITH qu AS (     WITH hull as (         SELECT              COUNT(S.cartodb_id) AS solution_count, P.cartodb_id AS project_id, P.title, P.approval_date, P.fixed_approval_date, P.external_project_url,              P.location_verbatim, P.topic_id, P.solution_id AS solution_id, P.budget, S.name AS solution_name, S.nexso_url AS solution_url,              A.external_url AS agency_url, A.name AS agency_name, ST_AsGeoJSON(A.the_geom) AS agency_position,             ST_Collect(PWA.the_geom) AS the_geom          FROM              v1_projects P LEFT JOIN v1_solutions S ON (P.solution_id = S.cartodb_id)             LEFT JOIN v1_agencies A ON (P.agency_id = A.cartodb_id),              v1_project_work_areas AS PWA          WHERE              P.cartodb_id = PWA.project_id AND <%= topicsCondition %> <%= solutionCondition %>            EXTRACT(YEAR FROM P.fixed_approval_date) >= <%= startYear %> AND              EXTRACT(YEAR FROM P.fixed_approval_date) <= <%= endYear %>         GROUP BY              P.cartodb_id, title, approval_date, fixed_approval_date,              external_project_url, location_verbatim, topic_id, solution_id, budget, A.external_url, A.name,             solution_name, solution_url, agency_position    )      SELECT *, ST_ConvexHull(the_geom) AS hull_geom FROM hull  )  SELECT      solution_count, project_id, title, approval_date, fixed_approval_date, external_project_url,      location_verbatim, topic_id, budget, agency_name, agency_url, the_geom, agency_position, solution_id, solution_name, solution_url,      ST_X(ST_Centroid(hull_geom)) AS centroid_lon,      ST_Y(ST_Centroid(hull_geom)) AS centroid_lat,      ST_X(ST_EndPoint(ST_LongestLine(ST_Centroid(hull_geom),hull_geom))) AS radius_point_lon,      ST_Y(ST_EndPoint(ST_LongestLine(ST_Centroid(hull_geom), hull_geom))) AS radius_point_lat FROM qu  ORDER BY     ST_Area(hull_geom) desc"};
String.prototype.splice=function(c,b,d){return this.slice(0,c)+d+this.slice(c+Math.abs(b))};"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var nexsoStyle=new google.maps.StyledMapType(mapStyles,{name:"Nexso Style"});function isEmpty(c){return!c.match(/\S/g)}
function prettifyDate(c){var b=Date.parseExact(c.splice(4,0,"-").splice(7,0,"-"),config.DATE_FORMAT);if(b){var c=b.getDate(),d=b.getMonth(),b=b.getFullYear(),e=config.DATE_SUFFIXES;return config.MONTHNAMES[d]+" "+c+(c>3?e[0]:e[c])+", "+b}return null}google.maps.Polygon.prototype.getBounds=function(){for(var c=new google.maps.LatLngBounds,b=this.getPaths(),d,e=0;e<b.getLength();e++){d=b.getAt(e);for(var h=0;h<d.getLength();h++)c.extend(d.getAt(h))}return c};function InfoWindow(c){this.id="infowindow-template";this.className="infowindow";this.latlng_=new google.maps.LatLng(0,0);this.template=c.template;this.map_=c.map;this.columns_=null;this.offsetHorizontal_=-107;this.width_=304;this.showDuration=250;this.setMap(c.map);this.params_=c}InfoWindow.prototype=new google.maps.OverlayView;
InfoWindow.prototype.draw=function(){var c=this.div_;if(!c){c=this.div_=document.createElement("DIV");c.className=this.className;var b=$("#"+this.id).html();this.template=_.template(b);c.innerHTML=this.template({projects:"",name:"Loading\u2026",agency_name:"",agency_url:"",overlayType:""});this.bindClose();google.maps.event.addDomListener(c,"dblclick",function(b){b.preventDefault?b.preventDefault():b.returnValue=!1});google.maps.event.addDomListener(c,"mousedown",function(b){b.preventDefault?b.preventDefault():
b.returnValue=!1;b.stopPropagation?b.stopPropagation():window.event.cancelBubble=!0});google.maps.event.addDomListener(c,"mouseup",function(b){b.preventDefault?b.preventDefault():b.returnValue=!1});google.maps.event.addDomListener(c,"mousewheel",function(b){b.stopPropagation?b.stopPropagation():window.event.cancelBubble=!0});google.maps.event.addDomListener(c,"DOMMouseScroll",function(b){b.stopPropagation?b.stopPropagation():window.event.cancelBubble=!0});this.getPanes().floatPane.appendChild(c);
c.style.opacity=0}this.setPosition()};InfoWindow.prototype.setPosition=function(c){if(this.div_){var b=this.div_,d=this.getProjection().fromLatLngToDivPixel(this.latlng_);if(d){b.style.width=this.width_+"px";b.style.left=d.x-38+"px";var e=-$(b).find(".box").height();b.style.top=d.y+e-10+"px"}c&&c()}};
InfoWindow.prototype.bindProjects=function(){$(this.div_).find(".project").click(function(c){c.preventDefault();c.stopPropagation();var c=parseFloat($(this).attr("data-lat")),b=parseFloat($(this).attr("data-lng")),d=new google.maps.LatLng(c,b);_.each(mapView.circles,function(b){b.circle.center.lat()===d.lat()&&b.circle.center.lng()===d.lng()&&setTimeout(function(){b.circle.parent.markSelected();google.maps.event.trigger(b.circle,"click",{autoopen:!0,latLng:d})},500)})})};
InfoWindow.prototype.bindClose=function(){var c=this;$(this.div_).find(".close").click(function(b){b.preventDefault();b.stopPropagation();c.hide()})};
InfoWindow.prototype.setContent=function(c){var b=null;if("agencies"===c.overlayType){var d=_.compact(c.projects_ids.split("|")),b=_.compact(c.projects_titles.split("|"));if(b=_.uniq(b))if(d=d[0],mapView.coordinates[d]){var e=mapView.coordinates[d][0],h=mapView.coordinates[d][1],b=_.map(b,function(b){return"<li><a href='#' class='project' data-lng='"+h+"' data-lat='"+e+"'>"+b+"</a></li>"});c.projects=b.join("")}else c.projects=""}this.div_.innerHTML=this.template(c);b&&this.bindProjects();this.bindClose()};
InfoWindow.prototype.setSolutionURL=function(c,b){$(this.div_).find(".solutions li a").html(c);$(this.div_).find(".solutions li a").attr("href",b)};InfoWindow.prototype.setCallback=function(c){$(".btn").on("click",c)};InfoWindow.prototype.open=function(c){var b=this;this.latlng_=c;this.moveMaptoOpen();this.setPosition(function(){b.show()})};InfoWindow.prototype.hide=function(){if(this.div_){var c=this.div_;$(c).animate({top:"+=10px",opacity:0},100,"swing",function(){c.style.visibility="hidden"})}};
InfoWindow.prototype.show=function(){this.div_&&(this.div_.style.opacity=0,$(this.div_).animate({top:"-=10px",opacity:1},this.showDuration),this.div_.style.visibility="visible")};InfoWindow.prototype.isVisible=function(){return this.div_?"visible"===this.div_.style.visibility?!0:!1:!1};
InfoWindow.prototype.moveMaptoOpen=function(){var c=0,b=0,d=this.getProjection().fromLatLngToContainerPixel(this.latlng_);d.x+320>=$("#map").width()&&(c=d.x+320-$("#map").width());200>d.y-$(this.div_).find(".box").height()&&(b=d.y-$(this.div_).find(".box").height()-130);this.map_.panBy(c,b)};function NexsoMarker(c,b,d){this.properties=d;this.latlng_=b.position;this.opts=b;this.offsetHorizontal_=this.offsetVertical_=-7;this.overlayType_=c;this.height_=this.width_=14;this.div_=null}NexsoMarker.prototype=new google.maps.OverlayView;
NexsoMarker.prototype.draw=function(){var c=this,b=this.div_;b||(b=this.div_=document.createElement("DIV"),b.className="marker",b.innerHTML='<img src="'+this.opts.icon+'" alt="" title="" />',google.maps.event.addDomListener(b,"click",function(b){b&&(b.preventDefault?b.preventDefault():b.returnValue=!1,b.stopPropagation?b.stopPropagation():window.event.cancelBubble=!0);c.properties.overlayType=c.overlayType_;Infowindow.setContent(c.properties);Infowindow.open(c.latlng_)}),google.maps.event.addDomListener(b,
"mouseover",function(){globalZindex++;$(this).css("zIndex",globalZindex).animate({width:"18px",height:"18px",marginTop:"-2px",marginLeft:"-2px"},100)}),google.maps.event.addDomListener(b,"mouseout",function(){$(this).animate({width:"14px",height:"14px",marginTop:"0px",marginLeft:"0px"},100)}),this.getPanes().overlayMouseTarget.appendChild(b));this.setPosition()};
NexsoMarker.prototype.setPosition=function(){if(this.div_){var c=this.div_,b=this.getProjection().fromLatLngToDivPixel(this.latlng_);b&&(c.style.width=this.width_+"px",c.style.left=b.x+this.offsetHorizontal_+"px",c.style.top=b.y+this.offsetVertical_+"px")}};
NexsoMarker.prototype.hide=function(c){if(this.div_&&!$(this.div_).hasClass("h")){var b=this.div_;c?$(b).animate({opacity:0},{queue:!0,duration:500,complete:function(){b.style.display="none";$(this).addClass("h")}}):($(b).css({opacity:0,display:"none"}),$(b).addClass("h"))}};NexsoMarker.prototype.changeOpacity=function(c){$(this.div_).animate({opacity:c},{queue:!0,duration:500})};
NexsoMarker.prototype.show=function(c){if(this.div_&&$(this.div_).hasClass("h")){var b=this.div_;c?(b.style.display="block",b.style.opacity=0,$(b).animate({opacity:0.99},{queue:!0,duration:500,complete:function(){$(this).removeClass("h")}})):($(b).css({opacity:0.99,display:"block"}),$(b).removeClass("h"))}};NexsoMarker.prototype.showContent=function(){this.div_&&google.maps.event.trigger(this.div_,"click")};NexsoMarker.prototype.getPosition=function(){return this.latlng_};function RadiusWidget(c,b,d,e,h){var d=this.distanceBetweenPoints(b,d),f=this;this.circle=new google.maps.Circle({parent:f,strokeColor:"#E79626",strokeOpacity:1,strokeWeight:1,fillColor:"#E79626",fillOpacity:0,center:b,radius:1E3*d,geodesic:!0,polygons:e});var j=[];_.each(h,function(b){if(!b)return!1;var b=$.parseJSON(b).coordinates,d=new google.maps.LatLng(b[1],b[0]);_.each(e,function(b){b=new google.maps.Polyline({path:[b[0].getBounds().getCenter(),d],strokeColor:"#1872A1",strokeOpacity:1,strokeWeight:1,
visible:!1});b.setMap(c);j.push(b)});return!0});this.circle.setOptions({lines:j});google.maps.event.addListener(this.circle,"click",function(b){function d(){var b=$(".aside .content"),e=b.find("ul");b.find(".header h2").html(k);(b=prettifyDate(o))?(e.find("li.approvalDate").show(),e.find("li.approvalDate span").text(b)):e.find("li.approvalDate").hide();0<x?(e.find("li.budget").show(),e.find("li.budget span").text(accounting.formatMoney(x))):e.find("li.budget").hide();q?(e.find("li.agency").show(),
e.find("li.agency a").text(q),e.find("li.agency a").on("click",function(b){b.preventDefault();if(f.circle.lines.length>0){b=f.circle.lines[0].getPath().getAt(1);c.panTo(b);c.setZoom(12)}})):e.find("li.agency").hide();null!==u?(e.find("li.solution").show(),e.find("li.solution a").text(s).attr("href",u)):e.find("li.solution").hide();t?(e.find("li.more").show(),e.find("li.more a").attr("href",t)):e.find("li.more").hide();previousZoom=c.getZoom();previousCenter=c.getCenter();Aside.show("project");Infowindow.hide();
var g=h.getBounds();_.each(f.circle.lines,function(b){g.extend(b.getPath().getAt(1))});c.fitBounds(g);c.panBy(176,0);$(".aside a.close").data("project",f);f.markSelected()}function e(b){b&&b.preventDefault();Timeline.hide();Aside.hide(d)}var h=this,j=this.polygons[0][0].geojsonProperties,k=j.title,o=j.approval_date,t=j.external_project_url,s=j.solution_name,u=j.solution_url,q=j.agency_name,x=j.budget;b.autoopen?e():(Infowindow.setContent({name:k,overlayType:"project"}),Infowindow.setSolutionURL(k,
t),Infowindow.setCallback(e),Infowindow.open(b.latLng))});google.maps.event.addListener(this.circle,"mouseover",this.onMouseOver);google.maps.event.addListener(this.circle,"mouseout",this.onMouseOut);this.circle.setMap(c);return this}RadiusWidget.prototype=new google.maps.MVCObject;
RadiusWidget.prototype.onMouseOver=function(){_.each(this.polygons,function(c){c[0].disabled?c[0].setOptions(projectsDisabledHoverStyle):c[0].setOptions(projectsHoverStyle)});this.disabled?this.setOptions(circleDisabledHoverStyle):this.setOptions(circleStyleHover)};RadiusWidget.prototype.onMouseOut=function(){_.each(this.polygons,function(c){c[0].disabled?c[0].setOptions(projectsDisabledStyle):c[0].setOptions(projectsStyle)});this.disabled?this.setOptions(circleDisabledStyle):this.setOptions(circleStyle)};
RadiusWidget.prototype.markSelected=function(){google.maps.event.clearListeners(this.circle,"mouseover");google.maps.event.clearListeners(this.circle,"mouseout");_.each(this.circle.polygons,function(c){c[0].setOptions(projectsHoverStyle)});this.circle.setOptions(circleStyleHover);_.each(this.circle.lines,function(c){c.setOptions({visible:!0})});this.hideAll();filterView.disable()};
RadiusWidget.prototype.unMarkSelected=function(c){google.maps.event.addListener(this.circle,"mouseover",this.onMouseOver);google.maps.event.addListener(this.circle,"mouseout",this.onMouseOut);_.each(this.circle.polygons,function(b){b[0].setOptions(projectsStyle)});this.circle.setOptions(circleStyle);_.each(this.circle.lines,function(b){b.setOptions({visible:!1})});c&&this.showAll();filterView.enable()};
RadiusWidget.prototype.hideAll=function(){var c=this;_.each(mapView.overlays.agencies,function(b){0<c.circle.lines.length&&b.getPosition().lat()!=c.circle.lines[0].getPath().getAt(1).lat()&&b.getPosition().lng()!=c.circle.lines[0].getPath().getAt(1).lng()&&b.hide()});mapView.hideOverlay("ashokas");_.each(mapView.circles,function(b){c!=b&&(_.each(b.circle.polygons,function(b){b[0].setOptions(projectsDisabledStyle);b[0].disabled=!0}),b.circle.setOptions(circleDisabledStyle),b.circle.disabled=!0)})};
RadiusWidget.prototype.showAll=function(){var c=this;mapView.addAgencies();mapView.addAshokas();_.each(mapView.circles,function(b){c!=b&&(_.each(b.circle.polygons,function(b){b[0].setOptions(projectsStyle);b[0].disabled=!1}),b.circle.setOptions(circleStyle),b.circle.disabled=!1)})};RadiusWidget.prototype.distance_changed=function(){this.set("radius",1E3*this.get("distance"))};
RadiusWidget.prototype.distanceBetweenPoints=function(c,b){if(!c||!b)return 0;var d=(b.lat()-c.lat())*Math.PI/180,e=(b.lng()-c.lng())*Math.PI/180,d=Math.sin(d/2)*Math.sin(d/2)+Math.cos(c.lat()*Math.PI/180)*Math.cos(b.lat()*Math.PI/180)*Math.sin(e/2)*Math.sin(e/2);return 6371*2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d))};$(function(){function c(b,c){0<$(".welcome").length&&($(".stats li."+b+" span").html(c),$(".stats li."+b+" .spinner ").fadeOut(250,function(){$(this).remove();$(".stats li."+b).removeClass("disabled")}))}function b(){$(".timeline-cover").animate({opacity:1,bottom:"23px"},250);$(".welcome, .backdrop").fadeIn(250,function(){$(".nav .input_field").fadeOut(250,function(){$(".filter-help").animate({top:"0",opacity:1},250)});$(".left-side").animate({left:"0",opacity:1},400);$(".right-side").animate({left:"0",
opacity:1},400)})}function d(){var b=$(".input_field input#lat").val(),c=$(".input_field input#lng").val();b&&c&&e(function(){var d=new google.maps.LatLng(b,c);m.panTo(d);m.setZoom(7);$("#addresspicker").val("");$(".input_field .placeholder").show()})}function e(b){var c=function(){b&&b()},d=function(){$(".welcome, .backdrop").fadeOut(250,c);$(".nav .input_field").fadeIn(550)};$(".timeline-cover").animate({opacity:0,bottom:-30},250,function(){$(".filter-help").animate({top:"-100px",opacity:0},250);
$(".left-side").animate({left:"-200px",opacity:0},400);$(".right-side").animate({left:"200px",opacity:0},400,d);$(".pac-container").fadeOut(250)})}function h(b){b.addClass("loading");b=document.getElementById(b.attr("id"));b=(new Spinner({lines:7,length:0,width:3,radius:4,rotate:0,color:"#000",speed:1,trail:55,shadow:!1,hwaccel:!1,zIndex:2E9,left:-22,top:0})).spin(b);$(b.el).fadeIn(250)}var f=[];$(document).on("click",function(){$(".nav a[data-toggle='filter']").hasClass("selected")&&($(".nav a[data-toggle='filter']").removeClass("selected"),
$(".nav .filter").fadeOut(150))});$("a[data-click='search']").on("click",function(b){b.preventDefault();Aside.show("search")});$("a[data-click='explore']").on("click",function(b){b.preventDefault();e()});$("a[data-click='visit']").on("click",function(b){b.preventDefault();d()});$("a[data-click='welcome']").on("click",function(c){c.preventDefault();b()});var j=new google.maps.LatLngBounds(new google.maps.LatLng(13.39029,-26.33247),new google.maps.LatLng(-59.450451,-109.47493));$("#addresspicker").geocomplete({details:".input_field",
detailsAttribute:"data-geo",bounds:j});$("ul.stats li").each(function(b,c){var d=null,e=$(c),d="spinner_"+e.attr("class");e.append('<div id="'+d+'" class="spinner"></div>');d=document.getElementById(d);(new Spinner(config.BIG_SPINNER_OPTIONS)).spin(d);e.find(".spinner").fadeIn(250)});$(".input_field").smartPlaceholder();$("#addresspicker").keydown(function(b){13===b.keyCode&&(b.preventDefault(),d())});0>=$("ul.radio li.selected").length&&$("ul.radio li:first-child").addClass("selected");$(".nav a[data-toggle='filter']").on("click",
function(b){b.preventDefault();b.stopPropagation();$(".nav a[data-toggle='filter'].selected").not(this).removeClass("selected");$(this).toggleClass("selected");$(".nav a[data-toggle='filter']").not(this).parent().find(".filter").fadeOut(250);$(this).parent().find(".filter").fadeToggle(150)});$(".nav .filter ul.radio li").on("click",function(b){b.preventDefault();b.stopPropagation();$(this).parent().find("li").each(function(){$(this).attr("id")});$(this).parent().find("li").removeClass("selected");
$(this).addClass("selected")});$(".nav .filter").on("click",function(b){b.preventDefault();b.stopPropagation()});var g=function(){function b(){$(window).mousemove(function(b){g.positionate(b.pageX+10,b.pageY+10)});$(window).mouseleave(function(){$(c).css("opacity",0)});$(window).mouseenter(function(){$(c).css("opacity",1)})}var c;c=document.getElementById("minispinner_wrapper");(new Spinner({lines:7,length:0,width:3,radius:4,rotate:0,color:"#000",speed:1,trail:55,shadow:!1,hwaccel:!1,className:"spinner",
zIndex:2E9,top:"auto",left:"auto"})).spin(c);return{show:function(){$(c).fadeIn();b()},hide:function(){$(c).fadeOut(function(){$(window).unbind("mousemove mouseleave mouseenter")})},positionate:function(b,d){$(c).css({top:d+"px",left:b+"px"})}}}();$(document).keyup(function(b){27===b.keyCode&&(Infowindow.hide(),$(".nav .filter").fadeOut(150))});Aside=function(){var b=$(".aside"),c=$(".aside a.close"),d=0;(function(){c.on("click",function(b){b.preventDefault();0===d?($(this).data("project").unMarkSelected(!0),
$(this).removeData("project"),m.setZoom(previousZoom),Aside.hide(Timeline.show)):Aside.hide()})})();_show=function(e){"project"===e?(d=0,b.find(".search").hide(),b.find(".project").show()):(d=1,b.find(".project").hide(),b.find(".search").show());(e=c.data("project"))&&e.unMarkSelected(!0);b.find("li").css({opacity:0,marginLeft:150});$("#map").animate({right:"352px"},250);b.animate({right:0},250,function(){$(this).removeClass("hidden");$(this).find("li").each(function(b,c){$(c).delay(b*120).animate({marginLeft:0,
opacity:1},200)})})};_hide=function(c){$("#map").animate({right:"0"},250);b.animate({right:"-400px"},250,function(){$(this).addClass("hidden");c&&c()})};_isHidden=function(){return b.hasClass("hidden")};return{hide:_hide,show:_show,isHidden:_isHidden}}();Timeline=function(){_show=function(){Aside.isHidden()&&$("#timeline").animate({bottom:19,opacity:1},300)};_hide=function(b){$("#timeline").animate({bottom:-90,opacity:0},250,function(){b&&b()})};return{hide:_hide,show:_show}}();$("#timeline .slider").slider({range:!0,
min:0,max:390,step:30,values:[0,500],stop:function(){mapView.startYear=config.START_YEAR;mapView.endYear=config.END_YEAR;mapView.removeOverlay("projects");mapView.addProjects()},slide:function(b,c){$("#timeline li").removeClass("selected");var d=c.values[0]/30+1,e=c.values[1]/30;startYear=config.YEARS[d-1];for(endYear=config.YEARS[e-1];d<=e;d++)$("#timeline li:nth-child("+d+")").addClass("selected")}});var j={zoom:config.ZOOM,minZoom:config.MINZOOM,maxZoom:config.MAXZOOM,center:new google.maps.LatLng(config.LAT,
config.LNG),mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0},m=new google.maps.Map(document.getElementById("map"),j),j=document.getElementById("zoom_controls"),l=document.createElement("DIV");j.appendChild(l);new function(b,c){b.setAttribute("class","zoom_in");google.maps.event.addDomListener(b,"mousedown",function(){var b=c.getZoom()+1;20>b&&c.setZoom(b)})}(l,m);l.index=1;l=document.createElement("DIV");j.appendChild(l);new function(b,c){b.setAttribute("class","zoom_out");google.maps.event.addDomListener(b,
"mousedown",function(){var b=c.getZoom()-1;2<b&&c.setZoom(b)})}(l,m);l.index=2;m.mapTypes.set("nexsoStyle",nexsoStyle);m.setMapTypeId("nexsoStyle");google.maps.event.addListener(m,"zoom_changed",function(){Infowindow.hide();$(".stations").css({width:$(document).width(),height:$(document).height(),top:0,left:0})});Infowindow=new InfoWindow({map:m});var l=Backbone.CartoDB({user:config.CARTODB_USER}),v=l.CartoDBModel.extend({topic_id:function(){return this.get("topic_id")},name:function(){return this.get("name")},
lat:function(){return!this.get("location")?0:this.get("location").coordinates[1]},lng:function(){return!this.get("location")?0:this.get("location").coordinates[0]}}),j=l.CartoDBCollection.extend({model:v,table:"v1_ashoka",columns:{name:"name",location:"the_geom",topic_id:"topic_id"}}),v=l.CartoDBCollection.extend({model:v,table:"v1_agencies",columns:{name:"name",location:"the_geom"}}),l=Backbone.View.extend({events:{},initialize:function(){this.state=1;this.overlays=[];this.circles=[];this.coordinates=
[];this.addAgencies();this.addAshokas();this.addProjects()},enableFilters:function(){disabledFilters&&(disabledFilters=!1,$(".nav .spinner").fadeOut(250,function(){$(this).parent().removeClass("loading");$(this).remove()}))},disableFilters:function(){disabledFilters||(disabledFilters=!0)},removeOverlay:function(b){"ashokas"===b||"agencies"===b?this.removeMarkers(b):"projects"===b&&this.removeProjects(b)},removeMarkers:function(b){for(var c=0;c<this.overlays[b].length;c++)this.overlays[b][c].hide(!0);
this.enableFilters()},removeProjects:function(b){if(0<this.circles.length)for(var c=0;c<this.circles.length;c++)this.circles[c].circle.setMap(null);if(this.overlays[b].length)for(c=0;c<this.overlays[b].length;c++)if(this.overlays[b][c].length)for(var d=0;d<this.overlays[b][c].length;d++)this.overlays[b][c][d][0].setMap(null);this.enableFilters()},changeOpacity:function(b,c){_.each(mapView.overlays[b],function(b){b.changeOpacity(c)})},hideOverlay:function(b){_.each(mapView.overlays[b],function(b){b.hide(!0)})},
addAshokas:function(){this.disableFilters();this.overlays.ashokas?(_.each(this.overlays.ashokas,function(b){("solutions"===solutionFilter&&b.properties.solution_id||"all"===solutionFilter)&&_.include(topics,b.properties.topic_id)?b.show(!0):b.hide(!0)}),this.enableFilters()):this.addOverlay("ashokas",queries.GET_ASHOKAS)},addAgencies:function(){this.disableFilters();this.overlays.agencies?(_.each(this.overlays.agencies,function(b){("solutions"===solutionFilter&&b.properties.solution_id||"all"===solutionFilter)&&
_.include(topics,b.properties.topic_id)?b.show(!0):b.hide(!0)}),this.enableFilters()):this.addOverlay("agencies",queries.GET_AGENCIES)},addProjects:function(){this.disableFilters();this.startYear||(this.startYear=config.START_YEAR);this.endYear||(this.endYear=config.END_YEAR);var b=0<topics.length?" P.topic_id  IN ("+topics.join(",")+") AND ":"",c="solutions"===solutionFilter?" P.solution_id IS NOT NULL AND ":"";this.addOverlay("projects",_.template(queries.GET_PROJECTS_QUERY_TEMPLATE)({startYear:this.startYear,
endYear:this.endYear,topicsCondition:b,solutionCondition:c}),function(){Timeline.show()})},addOverlay:function(b,d,e){var g=this;this.disableFilters();$.ajax({url:config.CARTODB_ENDPOINT,data:{q:d,format:"geojson"},dataType:"jsonp",success:function(d){if(0>=d.features.length)g.enableFilters();else{c(b,d.features.length);var h=projectsStyle,j=null;try{j=JSON.parse(d)}catch(l){j=d}d=$.extend({},h);g.overlays[b]=new GeoJSON(j,b,d||null);if(!(g.overlays[b].type&&"Error"===g.overlays[b].type)){d=[];p=
[];solution_count=0;if(g.overlays[b].length)for(j=0;j<g.overlays[b].length;j++)if(g.overlays[b][j].length){d=[];p=[];for(h=0;h<g.overlays[b][j].length;h++){var o=g.overlays[b][j][h][0];o.setMap(m);d.push(o);g.coordinates[o.geojsonProperties.project_id]=[g.overlays[b][j][0][0].geojsonProperties.centroid_lat,g.overlays[b][j][0][0].geojsonProperties.centroid_lon]}d=g.overlays[b][j][0][0].geojsonProperties;h=new google.maps.LatLng(d.centroid_lat,d.centroid_lon);o=new google.maps.LatLng(d.radius_point_lat,
d.radius_point_lon);h=new RadiusWidget(m,h,o,g.overlays[b][j],[d.agency_position]);"projects"===b&&f.push({circle:h.circle,more:d,value:d.title,lat:d.centroid_lat,lng:d.centroid_lon});g.circles.push(h);"projects"===b&&(solution_count+=d.solution_count)}else g.overlays[b][j].setMap(m);"projects"===b&&c("solutions",solution_count)}g.enableFilters();e&&e()}}})}}),p=new v,j=new j;mapView=new l({el:$("#map"),ashoka:j,agencies:p});filterView=new (Backbone.View.extend({initialize:function(){var b=this;this.$("#solution-filter li").on("click",
function(c){c.preventDefault();c.stopPropagation();b.filterBySolution($(this))});this.$("#topic-filter li").on("click",function(c){c.preventDefault();c.stopPropagation();b.filterByTopic($(this))});this.$("#type-filter li").on("click",function(c){c.preventDefault();c.stopPropagation();b.filterByType($(this))})},disable:function(){$(".cancel").on("click",function(b){b.preventDefault();b.stopPropagation()});$("ul.filters").addClass("disabled");$(".cancel").show()},enable:function(){$("ul.filters").removeClass("disabled");
$(".cancel").hide()},filterByTopic:function(b){if(!disabledFilters){mapView.disableFilters();h(b);b.toggleClass("selected");b.attr("id").trim();var c=parseInt(b.attr("class").replace(/selected/,"").replace("t","").trim(),10);b.hasClass("selected")?topics.push(c):topics=_.without(topics,c);0<topics.length?($("#projects").addClass("selected"),mapView.removeOverlay("projects"),mapView.addProjects(),mapView.addAgencies(),mapView.addAshokas()):(mapView.removeOverlay("projects"),mapView.removeOverlay("agencies"),
mapView.removeOverlay("ashokas"))}},filterBySolution:function(b){disabledFilters||(mapView.disableFilters(),h(b),solutionFilter=b.attr("id").trim(),mapView.removeOverlay("projects"),mapView.addProjects(),mapView.addAgencies(),mapView.addAshokas())},filterByType:function(b){if(!disabledFilters){mapView.disableFilters();h(b);b.toggleClass("selected");var c=b.attr("id").trim();b.attr("class").replace(/selected/,"").trim();if(b.hasClass("selected"))"agencies"===c?mapView.addAgencies():"ashokas"===c?mapView.addAshokas():
"projects"===c&&mapView.addProjects();else if("projects"===c||"agencies"===c||"ashokas"===c)"projects"===c&&Timeline.hide(),Infowindow.hide(),mapView.removeOverlay(c)}}}))({el:$(".nav .content")})});
