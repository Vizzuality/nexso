(function(b,d){function c(c){return!b(c).parents().andSelf().filter(function(){return"hidden"===b.curCSS(this,"visibility")||b.expr.filters.hidden(this)}).length}function e(d,f){var e=d.nodeName.toLowerCase();if("area"===e){var e=d.parentNode,j=e.name;if(!d.href||!j||"map"!==e.nodeName.toLowerCase())return!1;e=b("img[usemap=#"+j+"]")[0];return!!e&&c(e)}return(/input|select|textarea|button|object/.test(e)?!d.disabled:"a"==e?d.href||f:f)&&c(d)}b.ui=b.ui||{};b.ui.version||(b.extend(b.ui,{version:"1.8.18",
keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),b.fn.extend({propAttr:b.fn.prop||b.fn.attr,_focus:b.fn.focus,focus:function(c,d){return"number"==typeof c?this.each(function(){var e=
this;setTimeout(function(){b(e).focus();d&&d.call(e)},c)}):this._focus.apply(this,arguments)},scrollParent:function(){var c;b.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?c=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(b.curCSS(this,"position",1))&&/(auto|scroll)/.test(b.curCSS(this,"overflow",1)+b.curCSS(this,"overflow-y",1)+b.curCSS(this,"overflow-x",1))}).eq(0):c=this.parents().filter(function(){return/(auto|scroll)/.test(b.curCSS(this,
"overflow",1)+b.curCSS(this,"overflow-y",1)+b.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!c.length?b(document):c},zIndex:function(c){if(c!==d)return this.css("zIndex",c);if(this.length)for(var c=b(this[0]),f;c.length&&c[0]!==document;){f=c.css("position");if("absolute"===f||"relative"===f||"fixed"===f)if(f=parseInt(c.css("zIndex"),10),!isNaN(f)&&0!==f)return f;c=c.parent()}return 0},disableSelection:function(){return this.bind((b.support.selectstart?"selectstart":
"mousedown")+".ui-disableSelection",function(b){b.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),b.each(["Width","Height"],function(c,f){function e(c,d,h,f){b.each(j,function(){d-=parseFloat(b.curCSS(c,"padding"+this,!0))||0;h&&(d-=parseFloat(b.curCSS(c,"border"+this+"Width",!0))||0);f&&(d-=parseFloat(b.curCSS(c,"margin"+this,!0))||0)});return d}var j="Width"===f?["Left","Right"]:["Top","Bottom"],h=f.toLowerCase(),k={innerWidth:b.fn.innerWidth,innerHeight:b.fn.innerHeight,
outerWidth:b.fn.outerWidth,outerHeight:b.fn.outerHeight};b.fn["inner"+f]=function(c){return c===d?k["inner"+f].call(this):this.each(function(){b(this).css(h,e(this,c)+"px")})};b.fn["outer"+f]=function(c,d){return"number"!=typeof c?k["outer"+f].call(this,c):this.each(function(){b(this).css(h,e(this,c,!0,d)+"px")})}}),b.extend(b.expr[":"],{data:function(c,d,e){return!!b.data(c,e[3])},focusable:function(c){return e(c,!isNaN(b.attr(c,"tabindex")))},tabbable:function(c){var d=b.attr(c,"tabindex"),l=isNaN(d);
return(l||0<=d)&&e(c,!l)}}),b(function(){var c=document.body,d=c.appendChild(d=document.createElement("div"));d.offsetHeight;b.extend(d.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});b.support.minHeight=100===d.offsetHeight;b.support.selectstart="onselectstart"in d;c.removeChild(d).style.display="none"}),b.extend(b.ui,{plugin:{add:function(c,d,e){var c=b.ui[c].prototype,j;for(j in e)c.plugins[j]=c.plugins[j]||[],c.plugins[j].push([d,e[j]])},call:function(b,c,d){if((c=b.plugins[c])&&
b.element[0].parentNode)for(var e=0;e<c.length;e++)b.options[c[e][0]]&&c[e][1].apply(b.element,d)}},contains:function(b,c){return document.compareDocumentPosition?b.compareDocumentPosition(c)&16:b!==c&&b.contains(c)},hasScroll:function(c,d){if("hidden"===b(c).css("overflow"))return!1;var e=d&&"left"===d?"scrollLeft":"scrollTop",j=!1;if(0<c[e])return!0;c[e]=1;j=0<c[e];c[e]=0;return j},isOverAxis:function(b,c,d){return b>c&&b<c+d},isOver:function(c,d,e,j,h,k){return b.ui.isOverAxis(c,e,h)&&b.ui.isOverAxis(d,
j,k)}}))})(jQuery);
(function(b,d){if(b.cleanData){var c=b.cleanData;b.cleanData=function(d){for(var e=0,l;null!=(l=d[e]);e++)try{b(l).triggerHandler("remove")}catch(j){}c(d)}}else{var e=b.fn.remove;b.fn.remove=function(c,d){return this.each(function(){d||(!c||b.filter(c,[this]).length)&&b("*",this).add([this]).each(function(){try{b(this).triggerHandler("remove")}catch(c){}});return e.call(b(this),c,d)})}}b.widget=function(c,d,e){var j=c.split(".")[0],h,c=c.split(".")[1];h=j+"-"+c;e||(e=d,d=b.Widget);b.expr[":"][h]=
function(d){return!!b.data(d,c)};b[j]=b[j]||{};b[j][c]=function(b,c){arguments.length&&this._createWidget(b,c)};d=new d;d.options=b.extend(!0,{},d.options);b[j][c].prototype=b.extend(!0,d,{namespace:j,widgetName:c,widgetEventPrefix:b[j][c].prototype.widgetEventPrefix||c,widgetBaseClass:h},e);b.widget.bridge(c,b[j][c])};b.widget.bridge=function(c,e){b.fn[c]=function(l){var j="string"==typeof l,h=Array.prototype.slice.call(arguments,1),k=this,l=!j&&h.length?b.extend.apply(null,[!0,l].concat(h)):l;if(j&&
"_"===l.charAt(0))return k;j?this.each(function(){var e=b.data(this,c),f=e&&b.isFunction(e[l])?e[l].apply(e,h):e;if(f!==e&&f!==d)return k=f,!1}):this.each(function(){var d=b.data(this,c);d?d.option(l||{})._init():b.data(this,c,new e(l,this))});return k}};b.Widget=function(b,c){arguments.length&&this._createWidget(b,c)};b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(c,d){b.data(d,this.widgetName,this);this.element=b(d);this.options=b.extend(!0,
{},this.options,this._getCreateOptions(),c);var e=this;this.element.bind("remove."+this.widgetName,function(){e.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return b.metadata&&b.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+
"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(c,e){var l=c;if(0===arguments.length)return b.extend({},this.options);if("string"==typeof c){if(e===d)return this.options[c];l={};l[c]=e}this._setOptions(l);return this},_setOptions:function(c){var d=this;b.each(c,function(b,c){d._setOption(b,c)});return this},_setOption:function(b,c){this.options[b]=c;"disabled"===b&&this.widget()[c?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",
c);return this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(c,d,e){var j,h=this.options[c],e=e||{},d=b.Event(d);d.type=(c===this.widgetEventPrefix?c:this.widgetEventPrefix+c).toLowerCase();d.target=this.element[0];if(c=d.originalEvent)for(j in c)j in d||(d[j]=c[j]);this.element.trigger(d,e);return!(b.isFunction(h)&&!1===h.call(this.element[0],d,e)||d.isDefaultPrevented())}}})(jQuery);
(function(b){var d=!1;b(document).mouseup(function(){d=!1});b.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var c=this;this.element.bind("mousedown."+this.widgetName,function(b){return c._mouseDown(b)}).bind("click."+this.widgetName,function(d){if(!0===b.data(d.target,c.widgetName+".preventClickEvent"))return b.removeData(d.target,c.widgetName+".preventClickEvent"),d.stopImmediatePropagation(),!1});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+
this.widgetName)},_mouseDown:function(c){if(!d){this._mouseStarted&&this._mouseUp(c);this._mouseDownEvent=c;var e=this,g=1==c.which,f="string"==typeof this.options.cancel&&c.target.nodeName?b(c.target).closest(this.options.cancel).length:!1;if(!g||f||!this._mouseCapture(c))return!0;(this.mouseDelayMet=!this.options.delay)||(this._mouseDelayTimer=setTimeout(function(){e.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=!1!==this._mouseStart(c),
!this._mouseStarted))return c.preventDefault(),!0;!0===b.data(c.target,this.widgetName+".preventClickEvent")&&b.removeData(c.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(b){return e._mouseMove(b)};this._mouseUpDelegate=function(b){return e._mouseUp(b)};b(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);c.preventDefault();return d=!0}},_mouseMove:function(c){if(b.browser.msie&&!(9<=document.documentMode)&&
!c.button)return this._mouseUp(c);if(this._mouseStarted)return this._mouseDrag(c),c.preventDefault();this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,c),this._mouseStarted?this._mouseDrag(c):this._mouseUp(c));return!this._mouseStarted},_mouseUp:function(c){b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);this._mouseStarted&&(this._mouseStarted=!1,c.target==
this._mouseDownEvent.target&&b.data(c.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(c));return!1},_mouseDistanceMet:function(b){return Math.max(Math.abs(this._mouseDownEvent.pageX-b.pageX),Math.abs(this._mouseDownEvent.pageY-b.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})(jQuery);
(function(b){b.widget("ui.draggable",b.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){"original"==this.options.helper&&!/^(?:r|a|f)/.test(this.element.css("position"))&&
(this.element[0].style.position="relative");this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable"))return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy(),this},_mouseCapture:function(d){var c=this.options;if(this.helper||c.disabled||b(d.target).is(".ui-resizable-handle"))return!1;
this.handle=this._getHandle(d);if(!this.handle)return!1;c.iframeFix&&b(!0===c.iframeFix?"iframe":c.iframeFix).each(function(){b('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(b(this).offset()).appendTo("body")});return!0},_mouseStart:function(d){var c=this.options;this.helper=this._createHelper(d);this._cacheHelperProportions();b.ui.ddmanager&&(b.ui.ddmanager.current=
this);this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};b.extend(this.offset,{click:{left:d.pageX-this.offset.left,top:d.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(d);this.originalPageX=d.pageX;
this.originalPageY=d.pageY;c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt);c.containment&&this._setContainment();if(!1===this._trigger("start",d))return this._clear(),!1;this._cacheHelperProportions();b.ui.ddmanager&&!c.dropBehaviour&&b.ui.ddmanager.prepareOffsets(this,d);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(d,!0);b.ui.ddmanager&&b.ui.ddmanager.dragStart(this,d);return!0},_mouseDrag:function(d,c){this.position=this._generatePosition(d);this.positionAbs=this._convertPositionTo("absolute");
if(!c){var e=this._uiHash();if(!1===this._trigger("drag",d,e))return this._mouseUp({}),!1;this.position=e.position}if(!this.options.axis||"y"!=this.options.axis)this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||"x"!=this.options.axis)this.helper[0].style.top=this.position.top+"px";b.ui.ddmanager&&b.ui.ddmanager.drag(this,d);return!1},_mouseStop:function(d){var c=!1;b.ui.ddmanager&&!this.options.dropBehaviour&&(c=b.ui.ddmanager.drop(this,d));this.dropped&&(c=this.dropped,this.dropped=
!1);if((!this.element[0]||!this.element[0].parentNode)&&"original"==this.options.helper)return!1;if("invalid"==this.options.revert&&!c||"valid"==this.options.revert&&c||!0===this.options.revert||b.isFunction(this.options.revert)&&this.options.revert.call(this.element,c)){var e=this;b(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){!1!==e._trigger("stop",d)&&e._clear()})}else!1!==this._trigger("stop",d)&&this._clear();return!1},_mouseUp:function(d){!0===
this.options.iframeFix&&b("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});b.ui.ddmanager&&b.ui.ddmanager.dragStop(this,d);return b.ui.mouse.prototype._mouseUp.call(this,d)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(d){var c=!this.options.handle||!b(this.options.handle,this.element).length?!0:!1;b(this.options.handle,this.element).find("*").andSelf().each(function(){this==d.target&&(c=
!0)});return c},_createHelper:function(d){var c=this.options,d=b.isFunction(c.helper)?b(c.helper.apply(this.element[0],[d])):"clone"==c.helper?this.element.clone().removeAttr("id"):this.element;d.parents("body").length||d.appendTo("parent"==c.appendTo?this.element[0].parentNode:c.appendTo);d[0]!=this.element[0]&&!/(fixed|absolute)/.test(d.css("position"))&&d.css("position","absolute");return d},_adjustOffsetFromHelper:function(d){"string"==typeof d&&(d=d.split(" "));b.isArray(d)&&(d={left:+d[0],top:+d[1]||
0});"left"in d&&(this.offset.click.left=d.left+this.margins.left);"right"in d&&(this.offset.click.left=this.helperProportions.width-d.right+this.margins.left);"top"in d&&(this.offset.click.top=d.top+this.margins.top);"bottom"in d&&(this.offset.click.top=this.helperProportions.height-d.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var d=this.offsetParent.offset();"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&b.ui.contains(this.scrollParent[0],
this.offsetParent[0])&&(d.left+=this.scrollParent.scrollLeft(),d.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&b.browser.msie)d={top:0,left:0};return{top:d.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:d.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var b=this.element.position();return{top:b.top-
(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:b.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),
height:this.helper.outerHeight()}},_setContainment:function(){var d=this.options;"parent"==d.containment&&(d.containment=this.helper[0].parentNode);if("document"==d.containment||"window"==d.containment)this.containment=["document"==d.containment?0:b(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,"document"==d.containment?0:b(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,("document"==d.containment?0:b(window).scrollLeft())+b("document"==d.containment?document:
window).width()-this.helperProportions.width-this.margins.left,("document"==d.containment?0:b(window).scrollTop())+(b("document"==d.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(d.containment)&&d.containment.constructor!=Array){var d=b(d.containment),c=d[0];if(c){d.offset();var e="hidden"!=b(c).css("overflow");this.containment=[(parseInt(b(c).css("borderLeftWidth"),10)||0)+(parseInt(b(c).css("paddingLeft"),
10)||0),(parseInt(b(c).css("borderTopWidth"),10)||0)+(parseInt(b(c).css("paddingTop"),10)||0),(e?Math.max(c.scrollWidth,c.offsetWidth):c.offsetWidth)-(parseInt(b(c).css("borderLeftWidth"),10)||0)-(parseInt(b(c).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(c.scrollHeight,c.offsetHeight):c.offsetHeight)-(parseInt(b(c).css("borderTopWidth"),10)||0)-(parseInt(b(c).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];
this.relative_container=d}}else d.containment.constructor==Array&&(this.containment=d.containment)},_convertPositionTo:function(d,c){c||(c=this.position);var e="absolute"==d?1:-1,g="absolute"==this.cssPosition&&(this.scrollParent[0]==document||!b.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(g[0].tagName);return{top:c.top+this.offset.relative.top*e+this.offset.parent.top*e-(b.browser.safari&&526>b.browser.version&&"fixed"==this.cssPosition?
0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():f?0:g.scrollTop())*e),left:c.left+this.offset.relative.left*e+this.offset.parent.left*e-(b.browser.safari&&526>b.browser.version&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():f?0:g.scrollLeft())*e)}},_generatePosition:function(d){var c=this.options,e="absolute"==this.cssPosition&&(this.scrollParent[0]==document||!b.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,
g=/(html|body)/i.test(e[0].tagName),f=d.pageX,l=d.pageY;if(this.originalPosition){var j;this.containment&&(this.relative_container?(j=this.relative_container.offset(),j=[this.containment[0]+j.left,this.containment[1]+j.top,this.containment[2]+j.left,this.containment[3]+j.top]):j=this.containment,d.pageX-this.offset.click.left<j[0]&&(f=j[0]+this.offset.click.left),d.pageY-this.offset.click.top<j[1]&&(l=j[1]+this.offset.click.top),d.pageX-this.offset.click.left>j[2]&&(f=j[2]+this.offset.click.left),
d.pageY-this.offset.click.top>j[3]&&(l=j[3]+this.offset.click.top));c.grid&&(l=c.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/c.grid[1])*c.grid[1]:this.originalPageY,l=j?l-this.offset.click.top<j[1]||l-this.offset.click.top>j[3]?l-this.offset.click.top<j[1]?l+c.grid[1]:l-c.grid[1]:l:l,f=c.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0]:this.originalPageX,f=j?f-this.offset.click.left<j[0]||f-this.offset.click.left>j[2]?f-this.offset.click.left<j[0]?
f+c.grid[0]:f-c.grid[0]:f:f)}return{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(b.browser.safari&&526>b.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():g?0:e.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(b.browser.safari&&526>b.browser.version&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():g?0:e.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");
this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=!1},_trigger:function(d,c,e){e=e||this._uiHash();b.ui.plugin.call(this,d,[c,e]);"drag"==d&&(this.positionAbs=this._convertPositionTo("absolute"));return b.Widget.prototype._trigger.call(this,d,c,e)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});b.extend(b.ui.draggable,{version:"1.8.18"});
b.ui.plugin.add("draggable","connectToSortable",{start:function(d,c){var e=b(this).data("draggable"),g=e.options,f=b.extend({},c,{item:e.element});e.sortables=[];b(g.connectToSortable).each(function(){var c=b.data(this,"sortable");c&&!c.options.disabled&&(e.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",d,f))})},stop:function(d,c){var e=b(this).data("draggable"),g=b.extend({},c,{item:e.element});b.each(e.sortables,function(){this.instance.isOver?
(this.instance.isOver=0,e.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(d),this.instance.options.helper=this.instance.options._helper,"original"==e.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",d,g))})},drag:function(d,c){var e=b(this).data("draggable"),g=this;b.each(e.sortables,function(){this.instance.positionAbs=
e.positionAbs;this.instance.helperProportions=e.helperProportions;this.instance.offset.click=e.offset.click;this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=b(g).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},d.target=this.instance.currentItem[0],this.instance._mouseCapture(d,
!0),this.instance._mouseStart(d,!0,!0),this.instance.offset.click.top=e.offset.click.top,this.instance.offset.click.left=e.offset.click.left,this.instance.offset.parent.left-=e.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=e.offset.parent.top-this.instance.offset.parent.top,e._trigger("toSortable",d),e.dropped=this.instance.element,e.currentItem=e.element,this.instance.fromOutside=e),this.instance.currentItem&&this.instance._mouseDrag(d)):this.instance.isOver&&
(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",d,this.instance._uiHash(this.instance)),this.instance._mouseStop(d,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),e._trigger("fromSortable",d),e.dropped=!1)})}});b.ui.plugin.add("draggable","cursor",{start:function(){var d=b("body"),c=b(this).data("draggable").options;
d.css("cursor")&&(c._cursor=d.css("cursor"));d.css("cursor",c.cursor)},stop:function(){var d=b(this).data("draggable").options;d._cursor&&b("body").css("cursor",d._cursor)}});b.ui.plugin.add("draggable","opacity",{start:function(d,c){var e=b(c.helper),g=b(this).data("draggable").options;e.css("opacity")&&(g._opacity=e.css("opacity"));e.css("opacity",g.opacity)},stop:function(d,c){var e=b(this).data("draggable").options;e._opacity&&b(c.helper).css("opacity",e._opacity)}});b.ui.plugin.add("draggable",
"scroll",{start:function(){var d=b(this).data("draggable");d.scrollParent[0]!=document&&"HTML"!=d.scrollParent[0].tagName&&(d.overflowOffset=d.scrollParent.offset())},drag:function(d){var c=b(this).data("draggable"),e=c.options,g=!1;if(c.scrollParent[0]!=document&&"HTML"!=c.scrollParent[0].tagName){if(!e.axis||"x"!=e.axis)c.overflowOffset.top+c.scrollParent[0].offsetHeight-d.pageY<e.scrollSensitivity?c.scrollParent[0].scrollTop=g=c.scrollParent[0].scrollTop+e.scrollSpeed:d.pageY-c.overflowOffset.top<
e.scrollSensitivity&&(c.scrollParent[0].scrollTop=g=c.scrollParent[0].scrollTop-e.scrollSpeed);if(!e.axis||"y"!=e.axis)c.overflowOffset.left+c.scrollParent[0].offsetWidth-d.pageX<e.scrollSensitivity?c.scrollParent[0].scrollLeft=g=c.scrollParent[0].scrollLeft+e.scrollSpeed:d.pageX-c.overflowOffset.left<e.scrollSensitivity&&(c.scrollParent[0].scrollLeft=g=c.scrollParent[0].scrollLeft-e.scrollSpeed)}else{if(!e.axis||"x"!=e.axis)d.pageY-b(document).scrollTop()<e.scrollSensitivity?g=b(document).scrollTop(b(document).scrollTop()-
e.scrollSpeed):b(window).height()-(d.pageY-b(document).scrollTop())<e.scrollSensitivity&&(g=b(document).scrollTop(b(document).scrollTop()+e.scrollSpeed));if(!e.axis||"y"!=e.axis)d.pageX-b(document).scrollLeft()<e.scrollSensitivity?g=b(document).scrollLeft(b(document).scrollLeft()-e.scrollSpeed):b(window).width()-(d.pageX-b(document).scrollLeft())<e.scrollSensitivity&&(g=b(document).scrollLeft(b(document).scrollLeft()+e.scrollSpeed))}!1!==g&&b.ui.ddmanager&&!e.dropBehaviour&&b.ui.ddmanager.prepareOffsets(c,
d)}});b.ui.plugin.add("draggable","snap",{start:function(){var d=b(this).data("draggable"),c=d.options;d.snapElements=[];b(c.snap.constructor!=String?c.snap.items||":data(draggable)":c.snap).each(function(){var c=b(this),g=c.offset();this!=d.element[0]&&d.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:g.top,left:g.left})})},drag:function(d,c){for(var e=b(this).data("draggable"),g=e.options,f=g.snapTolerance,l=c.offset.left,j=l+e.helperProportions.width,h=c.offset.top,
k=h+e.helperProportions.height,s=e.snapElements.length-1;0<=s;s--){var t=e.snapElements[s].left,o=t+e.snapElements[s].width,p=e.snapElements[s].top,w=p+e.snapElements[s].height;if(t-f<l&&l<o+f&&p-f<h&&h<w+f||t-f<l&&l<o+f&&p-f<k&&k<w+f||t-f<j&&j<o+f&&p-f<h&&h<w+f||t-f<j&&j<o+f&&p-f<k&&k<w+f){if("inner"!=g.snapMode){var q=Math.abs(p-k)<=f,u=Math.abs(w-h)<=f,x=Math.abs(t-j)<=f,m=Math.abs(o-l)<=f;q&&(c.position.top=e._convertPositionTo("relative",{top:p-e.helperProportions.height,left:0}).top-e.margins.top);
u&&(c.position.top=e._convertPositionTo("relative",{top:w,left:0}).top-e.margins.top);x&&(c.position.left=e._convertPositionTo("relative",{top:0,left:t-e.helperProportions.width}).left-e.margins.left);m&&(c.position.left=e._convertPositionTo("relative",{top:0,left:o}).left-e.margins.left)}var y=q||u||x||m;"outer"!=g.snapMode&&(q=Math.abs(p-h)<=f,u=Math.abs(w-k)<=f,x=Math.abs(t-l)<=f,m=Math.abs(o-j)<=f,q&&(c.position.top=e._convertPositionTo("relative",{top:p,left:0}).top-e.margins.top),u&&(c.position.top=
e._convertPositionTo("relative",{top:w-e.helperProportions.height,left:0}).top-e.margins.top),x&&(c.position.left=e._convertPositionTo("relative",{top:0,left:t}).left-e.margins.left),m&&(c.position.left=e._convertPositionTo("relative",{top:0,left:o-e.helperProportions.width}).left-e.margins.left));!e.snapElements[s].snapping&&(q||u||x||m||y)&&e.options.snap.snap&&e.options.snap.snap.call(e.element,d,b.extend(e._uiHash(),{snapItem:e.snapElements[s].item}));e.snapElements[s].snapping=q||u||x||m||y}else e.snapElements[s].snapping&&
e.options.snap.release&&e.options.snap.release.call(e.element,d,b.extend(e._uiHash(),{snapItem:e.snapElements[s].item})),e.snapElements[s].snapping=!1}}});b.ui.plugin.add("draggable","stack",{start:function(){var d=b(this).data("draggable").options,d=b.makeArray(b(d.stack)).sort(function(c,d){return(parseInt(b(c).css("zIndex"),10)||0)-(parseInt(b(d).css("zIndex"),10)||0)});if(d.length){var c=parseInt(d[0].style.zIndex)||0;b(d).each(function(b){this.style.zIndex=c+b});this[0].style.zIndex=c+d.length}}});
b.ui.plugin.add("draggable","zIndex",{start:function(d,c){var e=b(c.helper),g=b(this).data("draggable").options;e.css("zIndex")&&(g._zIndex=e.css("zIndex"));e.css("zIndex",g.zIndex)},stop:function(d,c){var e=b(this).data("draggable").options;e._zIndex&&b(c.helper).css("zIndex",e._zIndex)}})})(jQuery);
(function(b){b.widget("ui.slider",b.ui.mouse,{widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var d=this,c=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),g=c.values&&c.values.length||1,f=[];this._mouseSliding=this._keySliding=!1;this._animateOff=!0;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+
this.orientation+" ui-widget ui-widget-content ui-corner-all"+(c.disabled?" ui-slider-disabled ui-disabled":""));this.range=b([]);c.range&&(!0===c.range&&(c.values||(c.values=[this._valueMin(),this._valueMin()]),c.values.length&&2!==c.values.length&&(c.values=[c.values[0],c.values[0]])),this.range=b("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+("min"===c.range||"max"===c.range?" ui-slider-range-"+c.range:"")));for(var l=e.length;l<g;l+=1)f.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");
this.handles=e.add(b(f.join("")).appendTo(d.element));this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(b){b.preventDefault()}).hover(function(){c.disabled||b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")}).focus(function(){c.disabled?b(this).blur():(b(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),b(this).addClass("ui-state-focus"))}).blur(function(){b(this).removeClass("ui-state-focus")});this.handles.each(function(c){b(this).data("index.ui-slider-handle",
c)});this.handles.keydown(function(c){var h=b(this).data("index.ui-slider-handle"),e,f,l;if(!d.options.disabled){switch(c.keyCode){case b.ui.keyCode.HOME:case b.ui.keyCode.END:case b.ui.keyCode.PAGE_UP:case b.ui.keyCode.PAGE_DOWN:case b.ui.keyCode.UP:case b.ui.keyCode.RIGHT:case b.ui.keyCode.DOWN:case b.ui.keyCode.LEFT:if(c.preventDefault(),!d._keySliding&&(d._keySliding=!0,b(this).addClass("ui-state-active"),e=d._start(c,h),!1===e))return}e=d.options.step;d.options.values&&d.options.values.length?
f=l=d.values(h):f=l=d.value();switch(c.keyCode){case b.ui.keyCode.HOME:l=d._valueMin();break;case b.ui.keyCode.END:l=d._valueMax();break;case b.ui.keyCode.PAGE_UP:l=d._trimAlignValue(f+(d._valueMax()-d._valueMin())/5);break;case b.ui.keyCode.PAGE_DOWN:l=d._trimAlignValue(f-(d._valueMax()-d._valueMin())/5);break;case b.ui.keyCode.UP:case b.ui.keyCode.RIGHT:if(f===d._valueMax())return;l=d._trimAlignValue(f+e);break;case b.ui.keyCode.DOWN:case b.ui.keyCode.LEFT:if(f===d._valueMin())return;l=d._trimAlignValue(f-
e)}d._slide(c,h,l)}}).keyup(function(c){var h=b(this).data("index.ui-slider-handle");d._keySliding&&(d._keySliding=!1,d._stop(c,h),d._change(c,h),b(this).removeClass("ui-state-active"))});this._refreshValue();this._animateOff=!1},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");this._mouseDestroy();return this},
_mouseCapture:function(d){var c=this.options,e,g,f,l,j;if(c.disabled)return!1;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();e=this._normValueFromMouse({x:d.pageX,y:d.pageY});g=this._valueMax()-this._valueMin()+1;l=this;this.handles.each(function(c){var d=Math.abs(e-l.values(c));g>d&&(g=d,f=b(this),j=c)});!0===c.range&&this.values(1)===c.min&&(j+=1,f=b(this.handles[j]));if(!1===this._start(d,j))return!1;this._mouseSliding=
!0;l._handleIndex=j;f.addClass("ui-state-active").focus();c=f.offset();this._clickOffset=!b(d.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:d.pageX-c.left-f.width()/2,top:d.pageY-c.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(d,j,e);return this._animateOff=!0},_mouseStart:function(){return!0},_mouseDrag:function(b){var c=this._normValueFromMouse({x:b.pageX,
y:b.pageY});this._slide(b,this._handleIndex,c);return!1},_mouseStop:function(b){this.handles.removeClass("ui-state-active");this._mouseSliding=!1;this._stop(b,this._handleIndex);this._change(b,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(b){var c,e;"horizontal"===this.orientation?(c=this.elementSize.width,e=b.x-this.elementOffset.left-
(this._clickOffset?this._clickOffset.left:0)):(c=this.elementSize.height,e=b.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0));b=e/c;1<b&&(b=1);0>b&&(b=0);"vertical"===this.orientation&&(b=1-b);c=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+b*c)},_start:function(b,c){var e={handle:this.handles[c],value:this.value()};this.options.values&&this.options.values.length&&(e.value=this.values(c),e.values=this.values());return this._trigger("start",b,e)},
_slide:function(b,c,e){var g,f,l;this.options.values&&this.options.values.length?(g=this.values(c?0:1),2===this.options.values.length&&!0===this.options.range&&(0===c&&e>g||1===c&&e<g)&&(e=g),e!==this.values(c)&&(f=this.values(),f[c]=e,l=this._trigger("slide",b,{handle:this.handles[c],value:e,values:f}),this.values(c?0:1),!1!==l&&this.values(c,e,!0))):e!==this.value()&&(l=this._trigger("slide",b,{handle:this.handles[c],value:e}),!1!==l&&this.value(e))},_stop:function(b,c){var e={handle:this.handles[c],
value:this.value()};this.options.values&&this.options.values.length&&(e.value=this.values(c),e.values=this.values());this._trigger("stop",b,e)},_change:function(b,c){if(!this._keySliding&&!this._mouseSliding){var e={handle:this.handles[c],value:this.value()};this.options.values&&this.options.values.length&&(e.value=this.values(c),e.values=this.values());this._trigger("change",b,e)}},value:function(b){if(arguments.length)this.options.value=this._trimAlignValue(b),this._refreshValue(),this._change(null,
0);else return this._value()},values:function(d,c){var e,g,f;if(1<arguments.length)this.options.values[d]=this._trimAlignValue(c),this._refreshValue(),this._change(null,d);else{if(!arguments.length)return this._values();if(!b.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(d):this.value();e=this.options.values;g=arguments[0];for(f=0;f<e.length;f+=1)e[f]=this._trimAlignValue(g[f]),this._change(null,f);this._refreshValue()}},_setOption:function(d,c){var e,g=
0;b.isArray(this.options.values)&&(g=this.options.values.length);b.Widget.prototype._setOption.apply(this,arguments);switch(d){case "disabled":c?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.propAttr("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.propAttr("disabled",!1),this.element.removeClass("ui-disabled"));break;case "orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+
this.orientation);this._refreshValue();break;case "value":this._animateOff=!0;this._refreshValue();this._change(null,0);this._animateOff=!1;break;case "values":this._animateOff=!0;this._refreshValue();for(e=0;e<g;e+=1)this._change(null,e);this._animateOff=!1}},_value:function(){var b=this.options.value;return b=this._trimAlignValue(b)},_values:function(b){var c,e;if(arguments.length)return c=this.options.values[b],c=this._trimAlignValue(c);c=this.options.values.slice();for(e=0;e<c.length;e+=1)c[e]=
this._trimAlignValue(c[e]);return c},_trimAlignValue:function(b){if(b<=this._valueMin())return this._valueMin();if(b>=this._valueMax())return this._valueMax();var c=0<this.options.step?this.options.step:1,e=(b-this._valueMin())%c,b=b-e;2*Math.abs(e)>=c&&(b+=0<e?c:-c);return parseFloat(b.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var d=this.options.range,c=this.options,e=this,g=this._animateOff?!1:c.animate,f,l=
{},j,h,k,s;this.options.values&&this.options.values.length?this.handles.each(function(d){f=100*((e.values(d)-e._valueMin())/(e._valueMax()-e._valueMin()));l["horizontal"===e.orientation?"left":"bottom"]=f+"%";b(this).stop(1,1)[g?"animate":"css"](l,c.animate);!0===e.options.range&&("horizontal"===e.orientation?(0===d&&e.range.stop(1,1)[g?"animate":"css"]({left:f+"%"},c.animate),1===d&&e.range[g?"animate":"css"]({width:f-j+"%"},{queue:!1,duration:c.animate})):(0===d&&e.range.stop(1,1)[g?"animate":"css"]({bottom:f+
"%"},c.animate),1===d&&e.range[g?"animate":"css"]({height:f-j+"%"},{queue:!1,duration:c.animate})));j=f}):(h=this.value(),k=this._valueMin(),s=this._valueMax(),f=s!==k?100*((h-k)/(s-k)):0,l["horizontal"===e.orientation?"left":"bottom"]=f+"%",this.handle.stop(1,1)[g?"animate":"css"](l,c.animate),"min"===d&&"horizontal"===this.orientation&&this.range.stop(1,1)[g?"animate":"css"]({width:f+"%"},c.animate),"max"===d&&"horizontal"===this.orientation&&this.range[g?"animate":"css"]({width:100-f+"%"},{queue:!1,
duration:c.animate}),"min"===d&&"vertical"===this.orientation&&this.range.stop(1,1)[g?"animate":"css"]({height:f+"%"},c.animate),"max"===d&&"vertical"===this.orientation&&this.range[g?"animate":"css"]({height:100-f+"%"},{queue:!1,duration:c.animate}))}});b.extend(b.ui.slider,{version:"1.8.18"})})(jQuery);
(function(b){b.ui=b.ui||{};var d=/left|center|right/,c=/top|center|bottom/,e,g=b.fn.position,f=b.fn.offset;b.fn.position=function(f){if(!f||!f.of)return g.apply(this,arguments);var f=b.extend({},f),j=b(f.of),h=j[0],k=(f.collision||"flip").split(" "),s=f.offset?f.offset.split(" "):[0,0],t,o,p;return 9===h.nodeType?(t=j.width(),o=j.height(),p={top:0,left:0}):h.setTimeout?(t=j.width(),o=j.height(),p={top:j.scrollTop(),left:j.scrollLeft()}):h.preventDefault?(f.at="left top",t=o=0,p={top:f.of.pageY,left:f.of.pageX}):
(t=j.outerWidth(),o=j.outerHeight(),p=j.offset()),b.each(["my","at"],function(){var b=(f[this]||"").split(" ");1===b.length&&(b=d.test(b[0])?b.concat(["center"]):c.test(b[0])?["center"].concat(b):["center","center"]);b[0]=d.test(b[0])?b[0]:"center";b[1]=c.test(b[1])?b[1]:"center";f[this]=b}),1===k.length&&(k[1]=k[0]),s[0]=parseInt(s[0],10)||0,1===s.length&&(s[1]=s[0]),s[1]=parseInt(s[1],10)||0,"right"===f.at[0]?p.left+=t:"center"===f.at[0]&&(p.left+=t/2),"bottom"===f.at[1]?p.top+=o:"center"===f.at[1]&&
(p.top+=o/2),p.left+=s[0],p.top+=s[1],this.each(function(){var c=b(this),d=c.outerWidth(),h=c.outerHeight(),j=parseInt(b.curCSS(this,"marginLeft",!0))||0,m=parseInt(b.curCSS(this,"marginTop",!0))||0,g=d+j+(parseInt(b.curCSS(this,"marginRight",!0))||0),M=h+m+(parseInt(b.curCSS(this,"marginBottom",!0))||0),B=b.extend({},p),I;"right"===f.my[0]?B.left-=d:"center"===f.my[0]&&(B.left-=d/2);"bottom"===f.my[1]?B.top-=h:"center"===f.my[1]&&(B.top-=h/2);e||(B.left=Math.round(B.left),B.top=Math.round(B.top));
I={left:B.left-j,top:B.top-m};b.each(["left","top"],function(c,e){b.ui.position[k[c]]&&b.ui.position[k[c]][e](B,{targetWidth:t,targetHeight:o,elemWidth:d,elemHeight:h,collisionPosition:I,collisionWidth:g,collisionHeight:M,offset:s,my:f.my,at:f.at})});b.fn.bgiframe&&c.bgiframe();c.offset(b.extend(B,{using:f.using}))})};b.ui.position={fit:{left:function(c,d){var h=b(window),h=d.collisionPosition.left+d.collisionWidth-h.width()-h.scrollLeft();c.left=0<h?c.left-h:Math.max(c.left-d.collisionPosition.left,
c.left)},top:function(c,d){var h=b(window),h=d.collisionPosition.top+d.collisionHeight-h.height()-h.scrollTop();c.top=0<h?c.top-h:Math.max(c.top-d.collisionPosition.top,c.top)}},flip:{left:function(c,d){if("center"!==d.at[0]){var h=b(window),h=d.collisionPosition.left+d.collisionWidth-h.width()-h.scrollLeft(),e="left"===d.my[0]?-d.elemWidth:"right"===d.my[0]?d.elemWidth:0,f="left"===d.at[0]?d.targetWidth:-d.targetWidth,g=-2*d.offset[0];c.left+=0>d.collisionPosition.left?e+f+g:0<h?e+f+g:0}},top:function(c,
d){if("center"!==d.at[1]){var h=b(window),h=d.collisionPosition.top+d.collisionHeight-h.height()-h.scrollTop(),e="top"===d.my[1]?-d.elemHeight:"bottom"===d.my[1]?d.elemHeight:0,f="top"===d.at[1]?d.targetHeight:-d.targetHeight,g=-2*d.offset[1];c.top+=0>d.collisionPosition.top?e+f+g:0<h?e+f+g:0}}}};b.offset.setOffset||(b.offset.setOffset=function(c,d){/static/.test(b.curCSS(c,"position"))&&(c.style.position="relative");var h=b(c),e=h.offset(),f=parseInt(b.curCSS(c,"top",!0),10)||0,g=parseInt(b.curCSS(c,
"left",!0),10)||0,e={top:d.top-e.top+f,left:d.left-e.left+g};"using"in d?d.using.call(c,e):h.css(e)},b.fn.offset=function(c){var d=this[0];return!d||!d.ownerDocument?null:c?this.each(function(){b.offset.setOffset(this,c)}):f.call(this)});(function(){var c=document.getElementsByTagName("body")[0],d=document.createElement("div"),h,f;h=document.createElement(c?"div":"body");f={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};c&&b.extend(f,{position:"absolute",left:"-1000px",
top:"-1000px"});for(var g in f)h.style[g]=f[g];h.appendChild(d);f=c||document.documentElement;f.insertBefore(h,f.firstChild);d.style.cssText="position: absolute; left: 10.7432222px; top: 10.432325px; height: 30px; width: 201px;";d=b(d).offset(function(b,c){return c}).offset();h.innerHTML="";f.removeChild(h);c=d.top+d.left+(c?2E3:0);e=21<c&&22>c})()})(jQuery);
(function(b){var d=0;b.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var c=this,d=this.element[0].ownerDocument,g;this.isMultiLine=this.element.is("textarea");this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(d){if(!c.options.disabled&&
!c.element.propAttr("readOnly")){g=!1;var e=b.ui.keyCode;switch(d.keyCode){case e.PAGE_UP:c._move("previousPage",d);break;case e.PAGE_DOWN:c._move("nextPage",d);break;case e.UP:c._keyEvent("previous",d);break;case e.DOWN:c._keyEvent("next",d);break;case e.ENTER:case e.NUMPAD_ENTER:c.menu.active&&(g=!0,d.preventDefault());case e.TAB:if(!c.menu.active)break;c.menu.select(d);break;case e.ESCAPE:c.element.val(c.term);c.close(d);break;default:clearTimeout(c.searching),c.searching=setTimeout(function(){c.term!=
c.element.val()&&(c.selectedItem=null,c.search(null,d))},c.options.delay)}}}).bind("keypress.autocomplete",function(b){g&&(g=!1,b.preventDefault())}).bind("focus.autocomplete",function(){c.options.disabled||(c.selectedItem=null,c.previous=c.element.val())}).bind("blxur.autocomplete",function(b){c.options.disabled||(clearTimeout(c.searching),c.closing=setTimeout(function(){c.close(b);c._change(b)},150))});this._initSource();this.menu=b("<ul></ul>").addClass("ui-autocomplete").appendTo(b(this.options.appendTo||
"body",d)[0]).mousedown(function(d){var e=c.menu.element[0];b(d.target).closest(".ui-menu-item").length||setTimeout(function(){b(document).one("mousedown",function(d){d.target!==c.element[0]&&d.target!==e&&!b.ui.contains(e,d.target)&&c.close()})},1);setTimeout(function(){clearTimeout(c.closing)},13)}).menu({focus:function(b,d){var e=d.item.data("item.autocomplete");!1!==c._trigger("focus",b,{item:e})&&/^key/.test(b.originalEvent.type)&&c.element.val(e.value)},selected:function(b,g){var j=g.item.data("item.autocomplete"),
h=c.previous;c.element[0]!==d.activeElement&&(c.element.focus(),c.previous=h,setTimeout(function(){c.previous=h;c.selectedItem=j},1));!1!==c._trigger("select",b,{item:j})&&c.element.val(j.value);c.term=c.element.val();c.close(b);c.selectedItem=j},blur:function(){c.menu.element.is(":visible")&&c.element.val()!==c.term&&c.element.val(c.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");b.fn.bgiframe&&this.menu.element.bgiframe();c.beforeunloadHandler=function(){c.element.removeAttr("autocomplete")};
b(window).bind("beforeunload",c.beforeunloadHandler)},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove();b(window).unbind("beforeunload",this.beforeunloadHandler);b.Widget.prototype.destroy.call(this)},_setOption:function(c,d){b.Widget.prototype._setOption.apply(this,arguments);"source"===c&&this._initSource();"appendTo"===c&&this.menu.element.appendTo(b(d||
"body",this.element[0].ownerDocument)[0]);"disabled"===c&&d&&this.xhr&&this.xhr.abort()},_initSource:function(){var c=this,d,g;b.isArray(this.options.source)?(d=this.options.source,this.source=function(c,g){g(b.ui.autocomplete.filter(d,c.term))}):"string"==typeof this.options.source?(g=this.options.source,this.source=function(d,e){c.xhr&&c.xhr.abort();c.xhr=b.ajax({url:g,data:d,dataType:"json",success:function(b){e(b)},error:function(){e([])}})}):this.source=this.options.source},search:function(b,
d){b=null!=b?b:this.element.val();this.term=this.element.val();if(b.length<this.options.minLength)return this.close(d);clearTimeout(this.closing);return!1===this._trigger("search",d)?void 0:this._search(b)},_search:function(b){this.pending++;this.element.addClass("ui-autocomplete-loading");this.source({term:b},this._response())},_response:function(){var b=this,e=++d;return function(g){e===d&&b.__response(g);b.pending--;b.pending||b.element.removeClass("ui-autocomplete-loading")}},__response:function(b){!this.options.disabled&&
b&&b.length?(b=this._normalize(b),this._suggest(b),this._trigger("open")):this.close()},close:function(b){clearTimeout(this.closing);this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.deactivate(),this._trigger("close",b))},_change:function(b){this.previous!==this.element.val()&&this._trigger("change",b,{item:this.selectedItem})},_normalize:function(c){return c.length&&c[0].label&&c[0].value?c:b.map(c,function(c){return"string"==typeof c?{label:c,value:c}:b.extend({label:c.label||
c.value,value:c.value||c.label},c)})},_suggest:function(c){var d=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(d,c);this.menu.deactivate();this.menu.refresh();d.show();this._resizeMenu();d.position(b.extend({of:this.element},this.options.position));this.options.autoFocus&&this.menu.next(new b.Event("mouseover"))},_resizeMenu:function(){var b=this.menu.element;b.outerWidth(Math.max(b.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(c,d){var g=
this;b.each(d,function(b,d){g._renderItem(c,d)})},_renderItem:function(c,d){return b("<li></li>").data("item.autocomplete",d).append(b("<a></a>").text(d.label)).appendTo(c)},_move:function(b,d){if(this.menu.element.is(":visible"))if(this.menu.first()&&/^previous/.test(b)||this.menu.last()&&/^next/.test(b))this.element.val(this.term),this.menu.deactivate();else this.menu[b](d);else this.search(null,d)},widget:function(){return this.menu.element},_keyEvent:function(b,d){if(!this.isMultiLine||this.menu.element.is(":visible"))this._move(b,
d),d.preventDefault()}});b.extend(b.ui.autocomplete,{escapeRegex:function(b){return b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(c,d){var g=RegExp(b.ui.autocomplete.escapeRegex(d),"i");return b.grep(c,function(b){return g.test(b.label||b.value||b)})}})})(jQuery);
(function(b){b.widget("ui.menu",{_create:function(){var d=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(c){b(c.target).closest(".ui-menu-item a").length&&(c.preventDefault(),d.select(c))});this.refresh()},refresh:function(){var d=this;this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem").children("a").addClass("ui-corner-all").mouseenter(function(c){d.activate(c,
b(this).parent())}).mouseleave(function(){d.deactivate()})},activate:function(b,c){this.deactivate();if(this.hasScroll()){var e=c.offset().top-this.element.offset().top,g=this.element.scrollTop(),f=this.element.height();0>e?this.element.scrollTop(g+e):e>=f&&this.element.scrollTop(g+e-f+c.height())}this.active=c.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",b,{item:c})},deactivate:function(){this.active&&(this.active.children("a").removeClass("ui-state-hover").removeAttr("id"),
this._trigger("blur"),this.active=null)},next:function(b){this.move("next",".ui-menu-item:first",b)},previous:function(b){this.move("prev",".ui-menu-item:last",b)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(b,c,e){this.active?(b=this.active[b+"All"](".ui-menu-item").eq(0),b.length?this.activate(e,b):this.activate(e,this.element.children(c))):this.activate(e,this.element.children(c))},
nextPage:function(d){if(this.hasScroll())if(!this.active||this.last())this.activate(d,this.element.children(".ui-menu-item:first"));else{var c=this.active.offset().top,e=this.element.height(),g=this.element.children(".ui-menu-item").filter(function(){var d=b(this).offset().top-c-e+b(this).height();return 10>d&&-10<d});g.length||(g=this.element.children(".ui-menu-item:last"));this.activate(d,g)}else this.activate(d,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))},
previousPage:function(d){if(this.hasScroll())if(!this.active||this.first())this.activate(d,this.element.children(".ui-menu-item:last"));else{var c=this.active.offset().top,e=this.element.height(),g=this.element.children(".ui-menu-item").filter(function(){var d=b(this).offset().top-c+e-b(this).height();return 10>d&&-10<d});g.length||(g=this.element.children(".ui-menu-item:first"));this.activate(d,g)}else this.activate(d,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":
":first"))},hasScroll:function(){return this.element.height()<this.element[b.fn.prop?"prop":"attr"]("scrollHeight")},select:function(b){this._trigger("selected",b,{item:this.active})}})})(jQuery);(function(){})(this);/*
 MIT License <http://www.opensource.org/licenses/mit-license.php>
*/
(function(b,d,c,e){function g(c,d){this.options=b.extend(!0,{},f,d);this.input=c;this.$input=b(c);this._defaults=f;this._name="geocomplete";this.init()}var f={bounds:!0,map:!1,details:!1,detailsAttribute:"name",location:!1,mapOptions:{zoom:14,scrollwheel:!1,mapTypeId:"roadmap"},markerOptions:{draggable:!1},maxZoom:16,types:["geocode"]},l="street_address,route,intersection,political,country,administrative_area_level_1,administrative_area_level_2,administrative_area_level_3,colloquial_area,locality,sublocality,neighborhood,premise,subpremise,postal_code,natural_feature,airport,park,point_of_interest,post_box,street_number,floor,room,lat,lng,viewport,location,formatted_address,location_type,bounds".split(","),
j="id,url,website,vicinity,reference,rating,international_phone_number,icon,formatted_phone_number".split(",");b.extend(g.prototype,{init:function(){this.initMap();this.initMarker();this.initGeocoder();this.initDetails();this.initLocation()},initMap:function(){this.options.map&&(this.map="function"==typeof this.options.map.setCenter?this.options.map:new google.maps.Map(b(this.options.map)[0],this.options.mapOptions))},initMarker:function(){if(this.map){var c=b.extend(this.options.markerOptions,{map:this.map});
this.marker=new google.maps.Marker(c);google.maps.event.addListener(this.marker,"dragend",b.proxy(this.markerDragged,this))}},initGeocoder:function(){this.autocomplete=new google.maps.places.Autocomplete(this.input,{types:this.options.types,bounds:!0===this.options.bounds?null:this.options.bounds});this.geocoder=new google.maps.Geocoder;this.map&&!0===this.options.bounds&&this.autocomplete.bindTo("bounds",this.map);google.maps.event.addListener(this.autocomplete,"place_changed",b.proxy(this.placeChanged,
this));this.$input.keypress(function(b){if(13===b.keyCode)return!1});this.$input.bind("geocode",b.proxy(function(){this.find()},this))},initDetails:function(){function c(b){f[b]=d.find("["+e+"="+b+"]")}if(this.options.details){var d=b(this.options.details),e=this.options.detailsAttribute,f={};b.each(l,function(b,d){c(d);c(d+"_short")});b.each(j,function(b,d){c(d)});this.$details=d;this.details=f}},initLocation:function(){var b=this.options.location,c;b&&("string"==typeof b?this.find(b):(b instanceof
Array&&(c=new google.maps.LatLng(b[0],b[1])),b instanceof google.maps.LatLng&&(c=b),c&&this.geoocode({latLng:c})))},find:function(b){this.geocode({address:b||this.$input.val()})},geocode:function(c){this.options.bounds&&!c.bounds&&(c.bounds=!0===this.options.bounds?this.map&&this.map.getBounds():this.options.bounds);this.geocoder.geocode(c,b.proxy(this.handleGeocode,this))},handleGeocode:function(b,c){if(c===google.maps.GeocoderStatus.OK){var d=b[0];this.$input.val(d.formatted_address);this.update(d);
1<b.length&&this.trigger("geocode:multiple",b)}else this.trigger("geocode:error",c)},trigger:function(b,c){this.$input.trigger(b,[c])},center:function(b){b.viewport?(this.map.fitBounds(b.viewport),this.map.getZoom()>this.options.maxZoom&&this.map.setZoom(this.options.maxZoom)):(this.map.setZoom(this.options.maxZoom),this.map.setCenter(b.location));this.marker&&(this.marker.setPosition(b.location),this.marker.setAnimation(this.options.markerOptions.animation))},update:function(b){this.map&&this.center(b.geometry);
this.$details&&this.fillDetails(b);this.trigger("geocode:result",b)},fillDetails:function(c){var d={},e=c.geometry,f=e.viewport,g=e.bounds;b.each(c.address_components,function(b,c){var e=c.types[0];d[e]=c.long_name;d[e+"_short"]=c.short_name});b.each(j,function(b,e){d[e]=c[e]});b.extend(d,{formatted_address:c.formatted_address,location_type:e.location_type||"PLACES",viewport:f,bounds:g,location:e.location,lat:e.location.lat(),lng:e.location.lng()});b.each(this.details,b.proxy(function(b,c){this.setDetail(c,
d[b])},this));this.data=d},setDetail:function(b,c){c===e?c="":"function"==typeof c.toUrlValue&&(c=c.toUrlValue());b.is(":input")?b.val(c):b.text(c)},markerDragged:function(b){this.trigger("geocode:dragged",b.latLng)},resetMarker:function(){this.marker.setPosition(this.data.location);this.setDetail(this.details.lat,this.data.location.lat());this.setDetail(this.details.lng,this.data.location.lng())},placeChanged:function(){var b=this.autocomplete.getPlace();b.geometry?this.update(b):this.find(b.name)}});
b.fn.geocomplete=function(c){if("string"==typeof c){var d=b(this).data("plugin_geocomplete"),e=d[c];if("function"==typeof e)return e.apply(d,Array.prototype.slice.call(arguments,1));2==arguments.length&&(e=arguments[1]);return e}return this.each(function(){var d=b.data(this,"plugin_geocomplete");d||(d=new g(this,c),b.data(this,"plugin_geocomplete",d))})}})(jQuery,window,document);Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday".split(","),abbreviatedDayNames:"Sun,Mon,Tue,Wed,Thu,Fri,Sat".split(","),shortestDayNames:"Su,Mo,Tu,We,Th,Fr,Sa".split(","),firstLetterDayNames:"S,M,T,W,T,F,S".split(","),monthNames:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),abbreviatedMonthNames:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec".split(","),
amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,
may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|after|from)/i,subtract:/^(\-|before|ago)/i,yesterday:/^yesterday/i,today:/^t(oday)?/i,tomorrow:/^tomorrow/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,
second:/^sec(ond)?s?/i,minute:/^min(ute)?s?/i,hour:/^h(ou)?rs?/i,week:/^w(ee)?k/i,month:/^m(o(nth)?s?)?/i,day:/^d(ays?)?/i,year:/^y((ea)?rs?)?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a|p)/i},abbreviatedTimeZoneStandard:{GMT:"-000",EST:"-0400",CST:"-0500",MST:"-0600",PST:"-0700"},abbreviatedTimeZoneDST:{GMT:"-000",EDT:"-0500",CDT:"-0600",
MDT:"-0700",PDT:"-0800"}};Date.getMonthNumberFromName=function(b){for(var d=Date.CultureInfo.monthNames,c=Date.CultureInfo.abbreviatedMonthNames,b=b.toLowerCase(),e=0;e<d.length;e++)if(d[e].toLowerCase()==b||c[e].toLowerCase()==b)return e;return-1};Date.getDayNumberFromName=function(b){for(var d=Date.CultureInfo.dayNames,c=Date.CultureInfo.abbreviatedDayNames,b=b.toLowerCase(),e=0;e<d.length;e++)if(d[e].toLowerCase()==b||c[e].toLowerCase()==b)return e;return-1};
Date.isLeapYear=function(b){return 0===b%4&&0!==b%100||0===b%400};Date.getDaysInMonth=function(b,d){return[31,Date.isLeapYear(b)?29:28,31,30,31,30,31,31,30,31,30,31][d]};Date.getTimezoneOffset=function(b,d){return d?Date.CultureInfo.abbreviatedTimeZoneDST[b.toUpperCase()]:Date.CultureInfo.abbreviatedTimeZoneStandard[b.toUpperCase()]};
Date.getTimezoneAbbreviation=function(b,d){var c=d?Date.CultureInfo.abbreviatedTimeZoneDST:Date.CultureInfo.abbreviatedTimeZoneStandard,e;for(e in c)if(c[e]===b)return e;return null};Date.prototype.clone=function(){return new Date(this.getTime())};Date.prototype.compareTo=function(b){if(isNaN(this))throw Error(this);if(b instanceof Date&&!isNaN(b))return this>b?1:this<b?-1:0;throw new TypeError(b);};Date.prototype.equals=function(b){return 0===this.compareTo(b)};
Date.prototype.between=function(b,d){var c=this.getTime();return c>=b.getTime()&&c<=d.getTime()};Date.prototype.addMilliseconds=function(b){this.setMilliseconds(this.getMilliseconds()+b);return this};Date.prototype.addSeconds=function(b){return this.addMilliseconds(1E3*b)};Date.prototype.addMinutes=function(b){return this.addMilliseconds(6E4*b)};Date.prototype.addHours=function(b){return this.addMilliseconds(36E5*b)};Date.prototype.addDays=function(b){return this.addMilliseconds(864E5*b)};
Date.prototype.addWeeks=function(b){return this.addMilliseconds(6048E5*b)};Date.prototype.addMonths=function(b){var d=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+b);this.setDate(Math.min(d,this.getDaysInMonth()));return this};Date.prototype.addYears=function(b){return this.addMonths(12*b)};
Date.prototype.add=function(b){if("number"==typeof b)return this._orient=b,this;if(b.millisecond||b.milliseconds)this.addMilliseconds(b.millisecond||b.milliseconds);if(b.second||b.seconds)this.addSeconds(b.second||b.seconds);if(b.minute||b.minutes)this.addMinutes(b.minute||b.minutes);if(b.hour||b.hours)this.addHours(b.hour||b.hours);if(b.month||b.months)this.addMonths(b.month||b.months);if(b.year||b.years)this.addYears(b.year||b.years);if(b.day||b.days)this.addDays(b.day||b.days);return this};
Date._validate=function(b,d,c,e){if("number"!=typeof b)throw new TypeError(b+" is not a Number.");if(b<d||b>c)throw new RangeError(b+" is not a valid value for "+e+".");return!0};Date.validateMillisecond=function(b){return Date._validate(b,0,999,"milliseconds")};Date.validateSecond=function(b){return Date._validate(b,0,59,"seconds")};Date.validateMinute=function(b){return Date._validate(b,0,59,"minutes")};Date.validateHour=function(b){return Date._validate(b,0,23,"hours")};
Date.validateDay=function(b,d,c){return Date._validate(b,1,Date.getDaysInMonth(d,c),"days")};Date.validateMonth=function(b){return Date._validate(b,0,11,"months")};Date.validateYear=function(b){return Date._validate(b,1,9999,"seconds")};
Date.prototype.set=function(b){!b.millisecond&&0!==b.millisecond&&(b.millisecond=-1);!b.second&&0!==b.second&&(b.second=-1);!b.minute&&0!==b.minute&&(b.minute=-1);!b.hour&&0!==b.hour&&(b.hour=-1);!b.day&&0!==b.day&&(b.day=-1);!b.month&&0!==b.month&&(b.month=-1);!b.year&&0!==b.year&&(b.year=-1);-1!=b.millisecond&&Date.validateMillisecond(b.millisecond)&&this.addMilliseconds(b.millisecond-this.getMilliseconds());-1!=b.second&&Date.validateSecond(b.second)&&this.addSeconds(b.second-this.getSeconds());
-1!=b.minute&&Date.validateMinute(b.minute)&&this.addMinutes(b.minute-this.getMinutes());-1!=b.hour&&Date.validateHour(b.hour)&&this.addHours(b.hour-this.getHours());-1!==b.month&&Date.validateMonth(b.month)&&this.addMonths(b.month-this.getMonth());-1!=b.year&&Date.validateYear(b.year)&&this.addYears(b.year-this.getFullYear());-1!=b.day&&Date.validateDay(b.day,this.getFullYear(),this.getMonth())&&this.addDays(b.day-this.getDate());b.timezone&&this.setTimezone(b.timezone);b.timezoneOffset&&this.setTimezoneOffset(b.timezoneOffset);
return this};Date.prototype.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this};Date.prototype.isLeapYear=function(){var b=this.getFullYear();return 0===b%4&&0!==b%100||0===b%400};Date.prototype.isWeekday=function(){return!(this.is().sat()||this.is().sun())};Date.prototype.getDaysInMonth=function(){return Date.getDaysInMonth(this.getFullYear(),this.getMonth())};Date.prototype.moveToFirstDayOfMonth=function(){return this.set({day:1})};
Date.prototype.moveToLastDayOfMonth=function(){return this.set({day:this.getDaysInMonth()})};Date.prototype.moveToDayOfWeek=function(b,d){var c=(b-this.getDay()+7*(d||1))%7;return this.addDays(0===c?c+7*(d||1):c)};Date.prototype.moveToMonth=function(b,d){var c=(b-this.getMonth()+12*(d||1))%12;return this.addMonths(0===c?c+12*(d||1):c)};Date.prototype.getDayOfYear=function(){return Math.floor((this-new Date(this.getFullYear(),0,1))/864E5)};
Date.prototype.getWeekOfYear=function(b){var d=this.getFullYear(),c=this.getMonth(),e=this.getDate(),b=b||Date.CultureInfo.firstDayOfWeek,g=8-(new Date(d,0,1)).getDay();8==g&&(g=1);c=(Date.UTC(d,c,e,0,0,0)-Date.UTC(d,0,1,0,0,0))/864E5+1;c=Math.floor((c-g+7)/7);c===b&&(d--,d=8-(new Date(d,0,1)).getDay(),c=2==d||8==d?53:52);return c};Date.prototype.isDST=function(){console.log("isDST");return"D"==this.toString().match(/(E|C|M|P)(S|D)T/)[2]};
Date.prototype.getTimezone=function(){return Date.getTimezoneAbbreviation(this.getUTCOffset,this.isDST())};Date.prototype.setTimezoneOffset=function(b){var d=this.getTimezoneOffset();this.addMinutes(-6*Number(b)/10-d);return this};Date.prototype.setTimezone=function(b){return this.setTimezoneOffset(Date.getTimezoneOffset(b))};Date.prototype.getUTCOffset=function(){var b=-10*this.getTimezoneOffset()/6;if(0>b)return b=(b-1E4).toString(),b[0]+b.substr(2);b=(b+1E4).toString();return"+"+b.substr(1)};
Date.prototype.getDayName=function(b){return b?Date.CultureInfo.abbreviatedDayNames[this.getDay()]:Date.CultureInfo.dayNames[this.getDay()]};Date.prototype.getMonthName=function(b){return b?Date.CultureInfo.abbreviatedMonthNames[this.getMonth()]:Date.CultureInfo.monthNames[this.getMonth()]};Date.prototype._toString=Date.prototype.toString;
Date.prototype.toString=function(b){var d=this,c=function(b){return 1==b.toString().length?"0"+b:b};return b?b.replace(/dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?/g,function(b){switch(b){case "hh":return c(13>d.getHours()?d.getHours():d.getHours()-12);case "h":return 13>d.getHours()?d.getHours():d.getHours()-12;case "HH":return c(d.getHours());case "H":return d.getHours();case "mm":return c(d.getMinutes());case "m":return d.getMinutes();case "ss":return c(d.getSeconds());case "s":return d.getSeconds();
case "yyyy":return d.getFullYear();case "yy":return d.getFullYear().toString().substring(2,4);case "dddd":return d.getDayName();case "ddd":return d.getDayName(!0);case "dd":return c(d.getDate());case "d":return d.getDate().toString();case "MMMM":return d.getMonthName();case "MMM":return d.getMonthName(!0);case "MM":return c(d.getMonth()+1);case "M":return d.getMonth()+1;case "t":return 12>d.getHours()?Date.CultureInfo.amDesignator.substring(0,1):Date.CultureInfo.pmDesignator.substring(0,1);case "tt":return 12>
d.getHours()?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator;case "zzz":case "zz":case "z":return""}}):this._toString()};Date.now=function(){return new Date};Date.today=function(){return Date.now().clearTime()};Date.prototype._orient=1;Date.prototype.next=function(){this._orient=1;return this};Date.prototype.last=Date.prototype.prev=Date.prototype.previous=function(){this._orient=-1;return this};Date.prototype._is=!1;Date.prototype.is=function(){this._is=!0;return this};
Number.prototype._dateElement="day";Number.prototype.fromNow=function(){var b={};b[this._dateElement]=this;return Date.now().add(b)};Number.prototype.ago=function(){var b={};b[this._dateElement]=-1*this;return Date.now().add(b)};
(function(){for(var b=Date.prototype,d=Number.prototype,c="sunday monday tuesday wednesday thursday friday saturday".split(/\s/),e="january february march april may june july august september october november december".split(/\s/),g="Millisecond Second Minute Hour Day Week Month Year".split(/\s/),f=function(b){return function(){return this._is?(this._is=!1,this.getDay()==b):this.moveToDayOfWeek(b,this._orient)}},l=0;l<c.length;l++)b[c[l]]=b[c[l].substring(0,3)]=f(l);c=function(b){return function(){return this._is?
(this._is=!1,this.getMonth()===b):this.moveToMonth(b,this._orient)}};for(f=0;f<e.length;f++)b[e[f]]=b[e[f].substring(0,3)]=c(f);c=function(b){return function(){"s"!=b.substring(b.length-1)&&(b+="s");return this["add"+b](this._orient)}};f=function(b){return function(){this._dateElement=b;return this}};for(l=0;l<g.length;l++)e=g[l].toLowerCase(),b[e]=b[e+"s"]=c(g[l]),d[e]=d[e+"s"]=f(e)})();Date.prototype.toJSONString=function(){return this.toString("yyyy-MM-ddThh:mm:ssZ")};
Date.prototype.toShortDateString=function(){return this.toString(Date.CultureInfo.formatPatterns.shortDatePattern)};Date.prototype.toLongDateString=function(){return this.toString(Date.CultureInfo.formatPatterns.longDatePattern)};Date.prototype.toShortTimeString=function(){return this.toString(Date.CultureInfo.formatPatterns.shortTimePattern)};Date.prototype.toLongTimeString=function(){return this.toString(Date.CultureInfo.formatPatterns.longTimePattern)};
Date.prototype.getOrdinal=function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};
(function(){Date.Parsing={Exception:function(b){this.message="Parse error at '"+b.substring(0,10)+" ...'"}};for(var b=Date.Parsing,d=b.Operators={rtoken:function(c){return function(d){var e=d.match(c);if(e)return[e[0],d.substring(e[0].length)];throw new b.Exception(d);}},token:function(){return function(b){return d.rtoken(RegExp("^s*"+b+"s*"))(b)}},stoken:function(b){return d.rtoken(RegExp("^"+b))},until:function(b){return function(c){for(var d=[],e=null;c.length;){try{e=b.call(this,c)}catch(k){d.push(e[0]);
c=e[1];continue}break}return[d,c]}},many:function(b){return function(c){for(var d=[],e=null;c.length;){try{e=b.call(this,c)}catch(k){break}d.push(e[0]);c=e[1]}return[d,c]}},optional:function(b){return function(c){var d=null;try{d=b.call(this,c)}catch(e){return[null,c]}return[d[0],d[1]]}},not:function(c){return function(d){try{c.call(this,d)}catch(e){return[null,d]}throw new b.Exception(d);}},ignore:function(b){return b?function(c){var d=null,d=b.call(this,c);return[null,d[1]]}:null},product:function(){for(var b=
arguments[0],c=Array.prototype.slice.call(arguments,1),e=[],h=0;h<b.length;h++)e.push(d.each(b[h],c));return e},cache:function(c){var d={},e=null;return function(h){try{e=d[h]=d[h]||c.call(this,h)}catch(k){e=d[h]=k}if(e instanceof b.Exception)throw e;return e}},any:function(){var c=arguments;return function(d){for(var e=null,h=0;h<c.length;h++)if(null!=c[h]){try{e=c[h].call(this,d)}catch(k){e=null}if(e)return e}throw new b.Exception(d);}},each:function(){var c=arguments;return function(d){for(var e=
[],h=null,k=0;k<c.length;k++)if(null!=c[k]){try{h=c[k].call(this,d)}catch(g){throw new b.Exception(d);}e.push(h[0]);d=h[1]}return[e,d]}},all:function(){var b=b;return b.each(b.optional(arguments))},sequence:function(c,e,j){e=e||d.rtoken(/^\s*/);j=j||null;return 1==c.length?c[0]:function(d){for(var k=null,g=null,t=[],o=0;o<c.length;o++){try{k=c[o].call(this,d)}catch(p){break}t.push(k[0]);try{g=e.call(this,k[1])}catch(w){g=null;break}d=g[1]}if(!k)throw new b.Exception(d);if(g)throw new b.Exception(g[1]);
if(j)try{k=j.call(this,k[1])}catch(q){throw new b.Exception(k[1]);}return[t,k?k[1]:d]}},between:function(b,c,e){var e=e||b,h=d.each(d.ignore(b),c,d.ignore(e));return function(b){b=h.call(this,b);return[[b[0][0],r[0][2]],b[1]]}},list:function(b,c,e){c=c||d.rtoken(/^\s*/);e=e||null;return b instanceof Array?d.each(d.product(b.slice(0,-1),d.ignore(c)),b.slice(-1),d.ignore(e)):d.each(d.many(d.each(b,d.ignore(c))),px,d.ignore(e))},set:function(c,e,j){e=e||d.rtoken(/^\s*/);j=j||null;return function(h){for(var k=
null,g=k=null,t=null,o=[[],h],p=!1,w=0;w<c.length;w++){k=g=null;p=1==c.length;try{k=c[w].call(this,h)}catch(q){continue}t=[[k[0]],k[1]];if(0<k[1].length&&!p)try{g=e.call(this,k[1])}catch(u){p=!0}else p=!0;!p&&0===g[1].length&&(p=!0);if(!p){k=[];for(p=0;p<c.length;p++)w!=p&&k.push(c[p]);k=d.set(k,e).call(this,g[1]);0<k[0].length&&(t[0]=t[0].concat(k[0]),t[1]=k[1])}t[1].length<o[1].length&&(o=t);if(0===o[1].length)break}if(0===o[0].length)return o;if(j){try{g=j.call(this,o[1])}catch(x){throw new b.Exception(o[1]);
}o[1]=g[1]}return o}},forward:function(b,c){return function(d){return b[c].call(this,d)}},replace:function(b,c){return function(d){d=b.call(this,d);return[c,d[1]]}},process:function(b,c){return function(d){d=b.call(this,d);return[c.call(this,d[0]),d[1]]}},min:function(c,d){return function(e){var h=d.call(this,e);if(h[0].length<c)throw new b.Exception(e);return h}}},c=function(b){return function(){var c=null,d=[];1<arguments.length?c=Array.prototype.slice.call(arguments):arguments[0]instanceof Array&&
(c=arguments[0]);if(c)for(var e=c.shift();0<e.length;)return c.unshift(e[0]),d.push(b.apply(null,c)),c.shift(),d;else return b.apply(null,arguments)}},e="optional not ignore cache".split(/\s/),g=0;g<e.length;g++)d[e[g]]=c(d[e[g]]);c=function(b){return function(){return arguments[0]instanceof Array?b.apply(null,arguments[0]):b.apply(null,arguments)}};e="each any all".split(/\s/);for(g=0;g<e.length;g++)d[e[g]]=c(d[e[g]])})();
(function(){var b=function(c){for(var d=[],e=0;e<c.length;e++)c[e]instanceof Array?d=d.concat(b(c[e])):c[e]&&d.push(c[e]);return d};Date.Grammar={};Date.Translator={hour:function(b){return function(){this.hour=Number(b)}},minute:function(b){return function(){this.minute=Number(b)}},second:function(b){return function(){this.second=Number(b)}},meridian:function(b){return function(){this.meridian=b.slice(0,1).toLowerCase()}},timezone:function(b){return function(){var c=b.replace(/[^\d\+\-]/g,"");c.length?
this.timezoneOffset=Number(c):this.timezone=b.toLowerCase()}},day:function(b){var c=b[0];return function(){this.day=Number(c.match(/\d+/)[0])}},month:function(b){return function(){this.month=3==b.length?Date.getMonthNumberFromName(b):Number(b)-1}},year:function(b){return function(){var c=Number(b);this.year=2<b.length?c:c+(c+2E3<Date.CultureInfo.twoDigitYearMax?2E3:1900)}},rday:function(b){return function(){switch(b){case "yesterday":this.days=-1;break;case "tomorrow":this.days=1;break;case "today":this.days=
0;break;case "now":this.days=0,this.now=!0}}},finishExact:function(b){var b=b instanceof Array?b:[b],c=new Date;this.year=c.getFullYear();this.month=c.getMonth();this.day=1;for(c=this.second=this.minute=this.hour=0;c<b.length;c++)b[c]&&b[c].call(this);this.hour="p"==this.meridian&&13>this.hour?this.hour+12:this.hour;if(this.day>Date.getDaysInMonth(this.year,this.month))throw new RangeError(this.day+" is not a valid value for days.");b=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);
this.timezone?b.set({timezone:this.timezone}):this.timezoneOffset&&b.set({timezoneOffset:this.timezoneOffset});return b},finish:function(c){c=c instanceof Array?b(c):[c];if(0===c.length)return null;for(var d=0;d<c.length;d++)"function"==typeof c[d]&&c[d].call(this);if(this.now)return new Date;c=Date.today();if(null!=this.days||this.orient||this.operator){var e,f;f="past"==this.orient||"subtract"==this.operator?-1:1;this.weekday&&(this.unit="day",d=Date.getDayNumberFromName(this.weekday)-c.getDay(),
e=7,this.days=d?(d+f*e)%e:f*e);this.month&&(this.unit="month",d=this.month-c.getMonth(),e=12,this.months=d?(d+f*e)%e:f*e,this.month=null);this.unit||(this.unit="day");if(null==this[this.unit+"s"]||null!=this.operator)this.value||(this.value=1),"week"==this.unit&&(this.unit="day",this.value*=7),this[this.unit+"s"]=this.value*f;return c.add(this)}this.meridian&&this.hour&&(this.hour=13>this.hour&&"p"==this.meridian?this.hour+12:this.hour);this.weekday&&!this.day&&(this.day=c.addDays(Date.getDayNumberFromName(this.weekday)-
c.getDay()).getDate());this.month&&!this.day&&(this.day=1);return c.set(this)}};var d=Date.Parsing.Operators,c=Date.Grammar,e=Date.Translator,g;c.datePartDelimiter=d.rtoken(/^([\s\-\.\,\/\x27]+)/);c.timePartDelimiter=d.stoken(":");c.whiteSpace=d.rtoken(/^\s*/);c.generalDelimiter=d.rtoken(/^(([\s\,]|at|on)+)/);var f={};c.ctoken=function(b){var c=f[b];if(!c){for(var c=Date.CultureInfo.regexPatterns,e=b.split(/\s+/),g=[],l=0;l<e.length;l++)g.push(d.replace(d.rtoken(c[e[l]]),e[l]));c=f[b]=d.any.apply(null,
g)}return c};c.ctoken2=function(b){return d.rtoken(Date.CultureInfo.regexPatterns[b])};c.h=d.cache(d.process(d.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),e.hour));c.hh=d.cache(d.process(d.rtoken(/^(0[0-9]|1[0-2])/),e.hour));c.H=d.cache(d.process(d.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),e.hour));c.HH=d.cache(d.process(d.rtoken(/^([0-1][0-9]|2[0-3])/),e.hour));c.m=d.cache(d.process(d.rtoken(/^([0-5][0-9]|[0-9])/),e.minute));c.mm=d.cache(d.process(d.rtoken(/^[0-5][0-9]/),e.minute));c.s=d.cache(d.process(d.rtoken(/^([0-5][0-9]|[0-9])/),
e.second));c.ss=d.cache(d.process(d.rtoken(/^[0-5][0-9]/),e.second));c.hms=d.cache(d.sequence([c.H,c.mm,c.ss],c.timePartDelimiter));c.t=d.cache(d.process(c.ctoken2("shortMeridian"),e.meridian));c.tt=d.cache(d.process(c.ctoken2("longMeridian"),e.meridian));c.z=d.cache(d.process(d.rtoken(/^(\+|\-)?\s*\d\d\d\d?/),e.timezone));c.zz=d.cache(d.process(d.rtoken(/^(\+|\-)\s*\d\d\d\d/),e.timezone));c.zzz=d.cache(d.process(c.ctoken2("timezone"),e.timezone));c.timeSuffix=d.each(d.ignore(c.whiteSpace),d.set([c.tt,
c.zzz]));c.time=d.each(d.optional(d.ignore(d.stoken("T"))),c.hms,c.timeSuffix);c.d=d.cache(d.process(d.each(d.rtoken(/^([0-2]\d|3[0-1]|\d)/),d.optional(c.ctoken2("ordinalSuffix"))),e.day));c.dd=d.cache(d.process(d.each(d.rtoken(/^([0-2]\d|3[0-1])/),d.optional(c.ctoken2("ordinalSuffix"))),e.day));c.ddd=c.dddd=d.cache(d.process(c.ctoken("sun mon tue wed thu fri sat"),function(b){return function(){this.weekday=b}}));c.M=d.cache(d.process(d.rtoken(/^(1[0-2]|0\d|\d)/),e.month));c.MM=d.cache(d.process(d.rtoken(/^(1[0-2]|0\d)/),
e.month));c.MMM=c.MMMM=d.cache(d.process(c.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),e.month));c.y=d.cache(d.process(d.rtoken(/^(\d\d?)/),e.year));c.yy=d.cache(d.process(d.rtoken(/^(\d\d)/),e.year));c.yyy=d.cache(d.process(d.rtoken(/^(\d\d?\d?\d?)/),e.year));c.yyyy=d.cache(d.process(d.rtoken(/^(\d\d\d\d)/),e.year));g=function(){return d.each(d.any.apply(null,arguments),d.not(c.ctoken2("timeContext")))};c.day=g(c.d,c.dd);c.month=g(c.M,c.MMM);c.year=g(c.yyyy,c.yy);c.orientation=d.process(c.ctoken("past future"),
function(b){return function(){this.orient=b}});c.operator=d.process(c.ctoken("add subtract"),function(b){return function(){this.operator=b}});c.rday=d.process(c.ctoken("yesterday tomorrow today now"),e.rday);c.unit=d.process(c.ctoken("minute hour day week month year"),function(b){return function(){this.unit=b}});c.value=d.process(d.rtoken(/^\d\d?(st|nd|rd|th)?/),function(b){return function(){this.value=b.replace(/\D/g,"")}});c.expression=d.set([c.rday,c.operator,c.value,c.unit,c.orientation,c.ddd,
c.MMM]);g=function(){return d.set(arguments,c.datePartDelimiter)};c.mdy=g(c.ddd,c.month,c.day,c.year);c.ymd=g(c.ddd,c.year,c.month,c.day);c.dmy=g(c.ddd,c.day,c.month,c.year);c.date=function(b){return(c[Date.CultureInfo.dateElementOrder]||c.mdy).call(this,b)};c.format=d.process(d.many(d.any(d.process(d.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(b){if(c[b])return c[b];throw Date.Parsing.Exception(b);}),d.process(d.rtoken(/^[^dMyhHmstz]+/),function(b){return d.ignore(d.stoken(b))}))),
function(b){return d.process(d.each.apply(null,b),e.finishExact)});var l={};c.formats=function(b){if(b instanceof Array){for(var e=[],f=0;f<b.length;f++)e.push(l[b[f]]=l[b[f]]||c.format(b[f])[0]);return d.any.apply(null,e)}return l[b]=l[b]||c.format(b)[0]};c._formats=c.formats(["yyyy-MM-ddTHH:mm:ss","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","d"]);c._start=d.process(d.set([c.date,c.time,c.expression],c.generalDelimiter,c.whiteSpace),e.finish);c.start=function(b){try{var d=c._formats.call({},
b);if(0===d[1].length)return d}catch(e){}return c._start.call({},b)}})();Date._parse=Date.parse;Date.parse=function(b){var d=null;if(!b)return null;try{d=Date.Grammar.start.call({},b)}catch(c){return null}return 0===d[1].length?d[0]:null};Date.getParseFunction=function(b){var d=Date.Grammar.formats(b);return function(b){var e=null;try{e=d.call({},b)}catch(g){return null}return 0===e[1].length?e[0]:null}};Date.parseExact=function(b,d){return Date.getParseFunction(d)(b)};(function(b,d,c){b.fn.jScrollPane=function(e){function g(e,g){function j(d){var k,m,g,V,y,oa=!1,pa=!1;v=d;if(D===c)V=e.scrollTop(),y=e.scrollLeft(),e.css({overflow:"hidden",padding:0}),G=e.innerWidth()+X,A=e.innerHeight(),e.width(G),D=b('<div class="jspPane" />').css("padding",sa).append(e.children()),E=b('<div class="jspContainer" />').css({width:G+"px",height:A+"px"}).append(D).appendTo(e);else{e.css("width","");oa=v.stickToBottom&&Aa();pa=v.stickToRight&&ta();if(g=e.innerWidth()+X!=G||e.outerHeight()!=
A)G=e.innerWidth()+X,A=e.innerHeight(),E.css({width:G+"px",height:A+"px"});if(!g&&ma==F&&D.outerHeight()==C){e.width(G);return}ma=F;D.css("width","");e.width(G);E.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}D.css("overflow","auto");F=d.contentWidth?d.contentWidth:D[0].scrollWidth;C=D[0].scrollHeight;D.css("overflow","");ua=F/G;qa=C/A;Y=1<qa;R=1<ua;if(!R&&!Y)e.removeClass("jspScrollable"),D.css({top:0,width:E.width()-X}),E.unbind(Ba),D.find(":input,a").unbind("focus.jsp"),e.attr("tabindex",
"-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp"),x();else{e.addClass("jspScrollable");if(d=v.maintainPosition&&(J||K))k=n(),m=W();h();s();o();d&&(N(pa?F-G:k,!1),z(oa?C-A:m,!1));wa();va();xa();v.enableKeyboardNavigation&&ya();v.clickOnTrack&&u();za();v.hijackInternalLinks&&ra()}v.autoReinitialise&&!ha?ha=setInterval(function(){j(v)},v.autoReinitialiseDelay):!v.autoReinitialise&&ha&&clearInterval(ha);V&&e.scrollTop(0)&&z(V,!1);y&&e.scrollLeft(0)&&N(y,!1);e.trigger("jsp-initialised",[R||
Y])}function h(){Y&&(E.append(b('<div class="jspVerticalBar" />').append(b('<div class="jspCap jspCapTop" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragTop" />'),b('<div class="jspDragBottom" />'))),b('<div class="jspCap jspCapBottom" />'))),fa=E.find(">.jspVerticalBar"),S=fa.find(">.jspTrack"),P=S.find(">.jspDrag"),v.showArrows&&(ia=b('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",w(0,-1)).bind("click.jsp",Z),ja=b('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",
w(0,1)).bind("click.jsp",Z),v.arrowScrollOnHover&&(ia.bind("mouseover.jsp",w(0,-1,ia)),ja.bind("mouseover.jsp",w(0,1,ja))),p(S,v.verticalArrowPositions,ia,ja)),aa=A,E.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){aa=aa-b(this).outerHeight()}),P.hover(function(){P.addClass("jspHover")},function(){P.removeClass("jspHover")}).bind("mousedown.jsp",function(c){b("html").bind("dragstart.jsp selectstart.jsp",Z);P.addClass("jspActive");var d=c.pageY-P.position().top;
b("html").bind("mousemove.jsp",function(b){y(b.pageY-d,false)}).bind("mouseup.jsp mouseleave.jsp",m);return false}),k())}function k(){S.height(aa+"px");J=0;ka=v.verticalGutter+S.outerWidth();D.width(G-ka-X);try{0===fa.position().left&&D.css("margin-left",ka+"px")}catch(b){}}function s(){R&&(E.append(b('<div class="jspHorizontalBar" />').append(b('<div class="jspCap jspCapLeft" />'),b('<div class="jspTrack" />').append(b('<div class="jspDrag" />').append(b('<div class="jspDragLeft" />'),b('<div class="jspDragRight" />'))),
b('<div class="jspCap jspCapRight" />'))),na=E.find(">.jspHorizontalBar"),Q=na.find(">.jspTrack"),O=Q.find(">.jspDrag"),v.showArrows&&(ga=b('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",w(-1,0)).bind("click.jsp",Z),ba=b('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",w(1,0)).bind("click.jsp",Z),v.arrowScrollOnHover&&(ga.bind("mouseover.jsp",w(-1,0,ga)),ba.bind("mouseover.jsp",w(1,0,ba))),p(Q,v.horizontalArrowPositions,ga,ba)),O.hover(function(){O.addClass("jspHover")},function(){O.removeClass("jspHover")}).bind("mousedown.jsp",
function(c){b("html").bind("dragstart.jsp selectstart.jsp",Z);O.addClass("jspActive");var d=c.pageX-O.position().left;b("html").bind("mousemove.jsp",function(b){B(b.pageX-d,false)}).bind("mouseup.jsp mouseleave.jsp",m);return false}),T=E.innerWidth(),t())}function t(){E.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){T-=b(this).outerWidth()});Q.width(T+"px");K=0}function o(){if(R&&Y){var c=Q.outerHeight(),d=S.outerWidth();aa-=c;b(na).find(">.jspCap:visible,>.jspArrow").each(function(){T+=
b(this).outerWidth()});T-=d;A-=d;G-=c;Q.parent().append(b('<div class="jspCorner" />').css("width",c+"px"));k();t()}R&&D.width(E.outerWidth()-X+"px");C=D.outerHeight();qa=C/A;R&&(ca=Math.ceil(1/ua*T),ca>v.horizontalDragMaxWidth?ca=v.horizontalDragMaxWidth:ca<v.horizontalDragMinWidth&&(ca=v.horizontalDragMinWidth),O.width(ca+"px"),L=T-ca,I(K));Y&&(da=Math.ceil(1/qa*aa),da>v.verticalDragMaxHeight?da=v.verticalDragMaxHeight:da<v.verticalDragMinHeight&&(da=v.verticalDragMinHeight),P.height(da+"px"),U=
aa-da,M(J))}function p(b,c,d,e){var h="before",n="after";"os"==c&&(c=/Mac/.test(navigator.platform)?"after":"split");c==h?n=c:c==n&&(h=c,c=d,d=e,e=c);b[h](d)[n](e)}function w(b,c,d){return function(){q(b,c,this,d);this.blur();return!1}}function q(c,d,e,h){var e=b(e).addClass("jspActive"),n,f,k=!0,m=function(){0!==c&&H.scrollByX(c*v.arrowButtonSpeed);0!==d&&H.scrollByY(d*v.arrowButtonSpeed);f=setTimeout(m,k?v.initialDelay:v.arrowRepeatFreq);k=!1};m();n=h?"mouseout.jsp":"mouseup.jsp";h=h||b("html");
h.bind(n,function(){e.removeClass("jspActive");f&&clearTimeout(f);f=null;h.unbind(n)})}function u(){x();Y&&S.bind("mousedown.jsp",function(d){if(d.originalTarget===c||d.originalTarget==d.currentTarget){var e=b(this),h=e.offset(),n=d.pageY-h.top-J,f,k=!0,m=function(){var b=e.offset(),b=d.pageY-b.top-da/2,c=A*v.scrollPagePercent,h=U*c/(C-A);if(0>n)J-h>b?H.scrollByY(-c):y(b);else if(0<n)J+h<b?H.scrollByY(c):y(b);else{g();return}f=setTimeout(m,k?v.initialDelay:v.trackClickRepeatFreq);k=!1},g=function(){f&&
clearTimeout(f);f=null;b(document).unbind("mouseup.jsp",g)};m();b(document).bind("mouseup.jsp",g);return!1}});R&&Q.bind("mousedown.jsp",function(d){if(d.originalTarget===c||d.originalTarget==d.currentTarget){var e=b(this),h=e.offset(),n=d.pageX-h.left-K,f,k=!0,m=function(){var b=e.offset(),b=d.pageX-b.left-ca/2,c=G*v.scrollPagePercent,h=L*c/(F-G);if(0>n)K-h>b?H.scrollByX(-c):B(b);else if(0<n)K+h<b?H.scrollByX(c):B(b);else{g();return}f=setTimeout(m,k?v.initialDelay:v.trackClickRepeatFreq);k=!1},g=
function(){f&&clearTimeout(f);f=null;b(document).unbind("mouseup.jsp",g)};m();b(document).bind("mouseup.jsp",g);return!1}})}function x(){Q&&Q.unbind("mousedown.jsp");S&&S.unbind("mousedown.jsp")}function m(){b("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp");P&&P.removeClass("jspActive");O&&O.removeClass("jspActive")}function y(b,d){Y&&((0>b?b=0:b>U&&(b=U),d===c&&(d=v.animateScroll),d)?H.animate(P,"top",b,M):(P.css("top",b),M(b)))}function M(b){b===c&&(b=P.position().top);
E.scrollTop(0);J=b;var d=0===J,h=J==U,b=-(b/U)*(C-A);if(la!=d||oa!=h)la=d,oa=h,e.trigger("jsp-arrow-change",[la,oa,V,pa]);v.showArrows&&(ia[d?"addClass":"removeClass"]("jspDisabled"),ja[h?"addClass":"removeClass"]("jspDisabled"));D.css("top",b);e.trigger("jsp-scroll-y",[-b,d,h]).trigger("scroll")}function B(b,d){R&&((0>b?b=0:b>L&&(b=L),d===c&&(d=v.animateScroll),d)?H.animate(O,"left",b,I):(O.css("left",b),I(b)))}function I(b){b===c&&(b=O.position().left);E.scrollTop(0);K=b;var d=0===K,h=K==L,b=-(b/
L)*(F-G);if(V!=d||pa!=h)V=d,pa=h,e.trigger("jsp-arrow-change",[la,oa,V,pa]);v.showArrows&&(ga[d?"addClass":"removeClass"]("jspDisabled"),ba[h?"addClass":"removeClass"]("jspDisabled"));D.css("left",b);e.trigger("jsp-scroll-x",[-b,d,h]).trigger("scroll")}function z(b,c){y(b/(C-A)*U,c)}function N(b,c){B(b/(F-G)*L,c)}function ea(c,d,e){var h,f,k=0,m=0,g,V,y;try{h=b(c)}catch(j){return}f=h.outerHeight();c=h.outerWidth();E.scrollTop(0);for(E.scrollLeft(0);!h.is(".jspPane");)if(k+=h.position().top,m+=h.position().left,
h=h.offsetParent(),/^body|html$/i.test(h[0].nodeName))return;h=W();g=h+A;k<h||d?V=k-v.verticalGutter:k+f>g&&(V=k-A+f+v.verticalGutter);V&&z(V,e);k=n();V=k+G;m<k||d?y=m-v.horizontalGutter:m+c>V&&(y=m-G+c+v.horizontalGutter);y&&N(y,e)}function n(){return-D.position().left}function W(){return-D.position().top}function Aa(){var b=C-A;return 20<b&&10>b-W()}function ta(){var b=F-G;return 20<b&&10>b-n()}function va(){E.unbind(Ba).bind(Ba,function(b,c,d,e){b=K;c=J;H.scrollBy(d*v.mouseWheelSpeed,-e*v.mouseWheelSpeed,
!1);return b==K&&c==J})}function Z(){return!1}function wa(){D.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(b){ea(b.target,!1)})}function ya(){function c(){var b=K,e=J;switch(d){case 40:H.scrollByY(v.keyboardSpeed,!1);break;case 38:H.scrollByY(-v.keyboardSpeed,!1);break;case 34:case 32:H.scrollByY(A*v.scrollPagePercent,!1);break;case 33:H.scrollByY(-A*v.scrollPagePercent,!1);break;case 39:H.scrollByX(v.keyboardSpeed,!1);break;case 37:H.scrollByX(-v.keyboardSpeed,!1)}return h=b!=K||
e!=J}var d,h,n=[];R&&n.push(na[0]);Y&&n.push(fa[0]);D.focus(function(){e.focus()});e.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(e){if(!(e.target!==this&&(!n.length||!b(e.target).closest(n).length))){var f=K,k=J;switch(e.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:d=e.keyCode;c();break;case 35:z(C-A);d=null;break;case 36:z(0),d=null}h=e.keyCode==d&&f!=K||k!=J;return!h}}).bind("keypress.jsp",function(b){b.keyCode==d&&c();return!h});v.hideFocus?
(e.css("outline","none"),"hideFocus"in E[0]&&e.attr("hideFocus",!0)):(e.css("outline",""),"hideFocus"in E[0]&&e.attr("hideFocus",!1))}function za(){if(location.hash&&1<location.hash.length){var c,d,e=escape(location.hash.substr(1));try{c=b("#"+e+', a[name="'+e+'"]')}catch(h){return}c.length&&D.find(e)&&(0===E.scrollTop()?d=setInterval(function(){0<E.scrollTop()&&(ea(c,!0),b(document).scrollTop(E.position().top),clearInterval(d))},50):(ea(c,!0),b(document).scrollTop(E.position().top)))}}function ra(){b(document.body).data("jspHijack")||
(b(document.body).data("jspHijack",!0),b(document.body).delegate("a[href*=#]","click",function(c){var e=this.href.substr(0,this.href.indexOf("#")),h=location.href,n;-1!==location.href.indexOf("#")&&(h=location.href.substr(0,location.href.indexOf("#")));if(e===h){e=escape(this.href.substr(this.href.indexOf("#")+1));n;try{n=b("#"+e+', a[name="'+e+'"]')}catch(f){return}n.length&&(e=n.closest(".jspScrollable"),e.data("jsp").scrollToElement(n,!0),e[0].scrollIntoView&&(h=b(d).scrollTop(),n=n.offset().top,
(n<h||n>h+b(d).height())&&e[0].scrollIntoView()),c.preventDefault())}}))}function xa(){var b,c,d,e,h,f=!1;E.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(k){k=k.originalEvent.touches[0];b=n();c=W();d=k.pageX;e=k.pageY;h=!1;f=!0}).bind("touchmove.jsp",function(n){if(f){var n=n.originalEvent.touches[0],k=K,m=J;H.scrollTo(b+d-n.pageX,c+e-n.pageY);h=h||5<Math.abs(d-n.pageX)||5<Math.abs(e-n.pageY);return k==K&&m==J}}).bind("touchend.jsp",function(){f=
!1}).bind("click.jsp-touchclick",function(){if(h)return h=!1})}var v,H=this,D,G,A,E,F,C,ua,qa,Y,R,P,U,J,O,L,K,fa,S,ka,aa,da,ia,ja,na,Q,T,ca,ga,ba,ha,sa,X,ma,la=!0,V=!0,oa=!1,pa=!1,Ca=e.clone(!1,!1).empty(),Ba=b.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";sa=e.css("paddingTop")+" "+e.css("paddingRight")+" "+e.css("paddingBottom")+" "+e.css("paddingLeft");X=(parseInt(e.css("paddingLeft"),10)||0)+(parseInt(e.css("paddingRight"),10)||0);b.extend(H,{reinitialise:function(c){c=b.extend({},v,c);
j(c)},scrollToElement:function(b,c,d){ea(b,c,d)},scrollTo:function(b,c,d){N(b,d);z(c,d)},scrollToX:function(b,c){N(b,c)},scrollToY:function(b,c){z(b,c)},scrollToPercentX:function(b,c){N(b*(F-G),c)},scrollToPercentY:function(b,c){z(b*(C-A),c)},scrollBy:function(b,c,d){H.scrollByX(b,d);H.scrollByY(c,d)},scrollByX:function(b,c){var d=(n()+Math[0>b?"floor":"ceil"](b))/(F-G);B(d*L,c)},scrollByY:function(b,c){var d=(W()+Math[0>b?"floor":"ceil"](b))/(C-A);y(d*U,c)},positionDragX:function(b,c){B(b,c)},positionDragY:function(b,
c){y(b,c)},animate:function(b,c,d,e){var h={};h[c]=d;b.animate(h,{duration:v.animateDuration,easing:v.animateEase,queue:!1,step:e})},getContentPositionX:function(){return n()},getContentPositionY:function(){return W()},getContentWidth:function(){return F},getContentHeight:function(){return C},getPercentScrolledX:function(){return n()/(F-G)},getPercentScrolledY:function(){return W()/(C-A)},getIsScrollableH:function(){return R},getIsScrollableV:function(){return Y},getContentPane:function(){return D},
scrollToBottom:function(b){y(U,b)},hijackInternalLinks:b.noop,destroy:function(){var b=W(),c=n();e.removeClass("jspScrollable").unbind(".jsp");e.replaceWith(Ca.append(D.children()));Ca.scrollTop(b);Ca.scrollLeft(c);ha&&clearInterval(ha)}});j(g)}e=b.extend({},b.fn.jScrollPane.defaults,e);b.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){e[this]=e[this]||e.speed});return this.each(function(){var c=b(this),d=c.data("jsp");d?d.reinitialise(e):(d=new g(c,e),c.data("jsp",
d))})};b.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:c,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,
verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:0.8}})(jQuery,this);(function(b){function d(c){var d=c||window.event,e=[].slice.call(arguments,1),j=0,h=0,k=0,c=b.event.fix(d);c.type="mousewheel";d.wheelDelta&&(j=d.wheelDelta/120);d.detail&&(j=-d.detail/3);k=j;void 0!==d.axis&&d.axis===d.HORIZONTAL_AXIS&&(k=0,h=-1*j);void 0!==d.wheelDeltaY&&(k=d.wheelDeltaY/120);void 0!==d.wheelDeltaX&&(h=-1*d.wheelDeltaX/120);e.unshift(c,j,h,k);return(b.event.dispatch||b.event.handle).apply(this,e)}var c=["DOMMouseScroll","mousewheel"];if(b.event.fixHooks)for(var e=c.length;e;)b.event.fixHooks[c[--e]]=
b.event.mouseHooks;b.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var b=c.length;b;)this.addEventListener(c[--b],d,!1);else this.onmousewheel=d},teardown:function(){if(this.removeEventListener)for(var b=c.length;b;)this.removeEventListener(c[--b],d,!1);else this.onmousewheel=null}};b.fn.extend({mousewheel:function(b){return b?this.bind("mousewheel",b):this.trigger("mousewheel")},unmousewheel:function(b){return this.unbind("mousewheel",b)}})})(jQuery);(function(b){var d,c;function e(){this===d&&(c=[-260,-260],d=!1,g=3)}c=[-260,-260];d=void 0;var g=3,f=document,l=f.documentElement,j=f.body,h,k;b.event.special.mwheelIntent={setup:function(){var c=b(this).bind("mousewheel",b.event.special.mwheelIntent.handler);this!==f&&this!==l&&this!==j&&c.bind("mouseleave",e);return!0},teardown:function(){b(this).unbind("mousewheel",b.event.special.mwheelIntent.handler).unbind("mouseleave",e);return!0},handler:function(e,f){var j=[e.clientX,e.clientY];if(this===
d||Math.abs(c[0]-j[0])>g||Math.abs(c[1]-j[1])>g)return d=this,c=j,g=250,clearTimeout(k),k=setTimeout(function(){g=10},200),clearTimeout(h),h=setTimeout(function(){g=3},1500),e=b.extend({},e,{type:"mwheelIntent"}),b.event.handle.apply(this,arguments)}};b.fn.extend({mwheelIntent:function(b){return b?this.bind("mwheelIntent",b):this.trigger("mwheelIntent")},unmwheelIntent:function(b){return this.unbind("mwheelIntent",b)}});b(function(){j=f.body;b(f).bind("mwheelIntent.mwheelIntentDefault",b.noop)})})(jQuery);(function(b){var d=String.prototype.trim,c=String.prototype.trimRight,e=String.prototype.trimLeft,g=function(b,c,d){for(var b=b+"",c=~~c,e=[];0<c;e[--c]=b);return e.join(null==d?"":d)},f=function(b){return null!=b?"["+j.escapeRegExp(""+b)+"]":"\\s"},l=function(){function b(c){return Object.prototype.toString.call(c).slice(8,-1).toLowerCase()}var c=function(){return c.cache.hasOwnProperty(arguments[0])||(c.cache[arguments[0]]=c.parse(arguments[0])),c.format.call(null,c.cache[arguments[0]],arguments)};
return c.format=function(c,d){var e=1,f=c.length,k="",j,u=[],x,m,y;for(x=0;x<f;x++)if(k=b(c[x]),"string"===k)u.push(c[x]);else if("array"===k){k=c[x];if(k[2]){j=d[e];for(m=0;m<k[2].length;m++){if(!j.hasOwnProperty(k[2][m]))throw Error(l('[_.sprintf] property "%s" does not exist',k[2][m]));j=j[k[2][m]]}}else k[1]?j=d[k[1]]:j=d[e++];if(/[^s]/.test(k[8])&&"number"!=b(j))throw Error(l("[_.sprintf] expecting number but found %s",b(j)));switch(k[8]){case "b":j=j.toString(2);break;case "c":j=String.fromCharCode(j);
break;case "d":j=parseInt(j,10);break;case "e":j=k[7]?j.toExponential(k[7]):j.toExponential();break;case "f":j=k[7]?parseFloat(j).toFixed(k[7]):parseFloat(j);break;case "o":j=j.toString(8);break;case "s":j=(j=""+j)&&k[7]?j.substring(0,k[7]):j;break;case "u":j=Math.abs(j);break;case "x":j=j.toString(16);break;case "X":j=j.toString(16).toUpperCase()}j=/[def]/.test(k[8])&&k[3]&&0<=j?"+"+j:j;m=k[4]?"0"==k[4]?"0":k[4].charAt(1):" ";y=k[6]-(""+j).length;m=k[6]?g(m,y):"";u.push(k[5]?j+m:m+j)}return u.join("")},
c.cache={},c.parse=function(b){for(var c=[],d=[],e=0;b;){if(null!==(c=/^[^\x25]+/.exec(b)))d.push(c[0]);else if(null!==(c=/^\x25{2}/.exec(b)))d.push("%");else{if(null===(c=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(b)))throw Error("[_.sprintf] huh?");if(c[2]){var e=e|1,h=[],f=c[2],k=[];if(null===(k=/^([a-z_][a-z_\d]*)/i.exec(f)))throw Error("[_.sprintf] huh?");for(h.push(k[1]);""!==(f=f.substring(k[0].length));){if(null===(k=/^\.([a-z_][a-z_\d]*)/i.exec(f)))if(null===
(k=/^\[(\d+)\]/.exec(f)))throw Error("[_.sprintf] huh?");h.push(k[1])}c[2]=h}else e|=2;if(3===e)throw Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");d.push(c)}b=b.substring(c[0].length)}return d},c}(),j={VERSION:"2.1.1",isBlank:function(b){return/^\s*$/.test(b)},stripTags:function(b){return(""+b).replace(/<\/?[^>]+>/ig,"")},capitalize:function(b){return b+="",b.charAt(0).toUpperCase()+b.substring(1).toLowerCase()},chop:function(b,c){for(var b=b+"",c=~~c||b.length,
d=[],e=0;e<b.length;)d.push(b.slice(e,e+c)),e+=c;return d},clean:function(b){return j.strip((""+b).replace(/\s+/g," "))},count:function(b,c){return b+="",c+="",b.split(c).length-1},chars:function(b){return(""+b).split("")},escapeHTML:function(b){return(""+b).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},unescapeHTML:function(b){return(""+b).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&amp;/g,
"&")},escapeRegExp:function(b){return b.replace(/([-.*+?^${}()|[\]\/\\])/g,"\\$1")},insert:function(b,c,d){b=(""+b).split("");return b.splice(~~c,0,""+d),b.join("")},include:function(b,c){return-1!==(""+b).indexOf(c)},join:function(b){var c=Array.prototype.slice.call(arguments);return c.join(c.shift())},lines:function(b){return(""+b).split("\n")},reverse:function(b){return Array.prototype.reverse.apply((""+b).split("")).join("")},splice:function(b,c,d,e){b=(""+b).split("");return b.splice(~~c,~~d,
e),b.join("")},startsWith:function(b,c){return b+="",c+="",b.length>=c.length&&b.substring(0,c.length)===c},endsWith:function(b,c){return b+="",c+="",b.length>=c.length&&b.substring(b.length-c.length)===c},succ:function(b){var b=b+"",c=b.split("");return c.splice(b.length-1,1,String.fromCharCode(b.charCodeAt(b.length-1)+1)),c.join("")},titleize:function(b){return(""+b).replace(/\b./g,function(b){return b.toUpperCase()})},camelize:function(b){return j.trim(b).replace(/(\-|_|\s)+(.)?/g,function(b,c,
d){return d?d.toUpperCase():""})},underscored:function(b){return j.trim(b).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},dasherize:function(b){return j.trim(b).replace(/[_\s]+/g,"-").replace(/([A-Z])/g,"-$1").replace(/-+/g,"-").toLowerCase()},classify:function(b){return j.titleize(b.replace(/_/g," ")).replace(/\s/g,"")},humanize:function(b){return j.capitalize(this.underscored(b).replace(/_id$/,"").replace(/_/g," "))},trim:function(b,c){return b+="",!c&&d?d.call(b):(c=
f(c),b.replace(RegExp("^"+c+"+|"+c+"+$","g"),""))},ltrim:function(b,c){return!c&&e?e.call(b):(c=f(c),(""+b).replace(RegExp("^"+c+"+","g"),""))},rtrim:function(b,d){return!d&&c?c.call(b):(d=f(d),(""+b).replace(RegExp(d+"+$","g"),""))},truncate:function(b,c,d){return b+="",d=d||"...",c=~~c,b.length>c?b.slice(0,c)+d:b},prune:function(b,c,d){var b=b+"",c=~~c,d=null!=d?""+d:"...",e,f,g=b.replace(/\W/g,function(b){return b.toUpperCase()!==b.toLowerCase()?"A":" "});return f=g.charAt(c),e=g.slice(0,c),f&&
f.match(/\S/)&&(e=e.replace(/\s\S+$/,"")),e=j.rtrim(e),(e+d).length>b.length?b:b.substring(0,e.length)+d},words:function(b,c){return j.trim(b,c).split(c||/\s+/)},pad:function(b,c,d,e){var b=b+"",f="",f=0,c=~~c;d?1<d.length&&(d=d.charAt(0)):d=" ";switch(e){case "right":f=c-b.length;f=g(d,f);b+=f;break;case "both":f=c-b.length;f={left:g(d,Math.ceil(f/2)),right:g(d,Math.floor(f/2))};b=f.left+b+f.right;break;default:f=c-b.length,f=g(d,f),b=f+b}return b},lpad:function(b,c,d){return j.pad(b,c,d)},rpad:function(b,
c,d){return j.pad(b,c,d,"right")},lrpad:function(b,c,d){return j.pad(b,c,d,"both")},sprintf:l,vsprintf:function(b,c){return c.unshift(b),l.apply(null,c)},toNumber:function(b,c){var d;d=1*(1*b||0).toFixed(~~c)||0;return 0===d&&"0"!=""+b?Number.NaN:d},strRight:function(b,c){var b=b+"",d=(c=null!=c?""+c:c)?b.indexOf(c):-1;return-1!=d?b.slice(d+c.length,b.length):b},strRightBack:function(b,c){var b=b+"",d=(c=null!=c?""+c:c)?b.lastIndexOf(c):-1;return-1!=d?b.slice(d+c.length,b.length):b},strLeft:function(b,
c){var b=b+"",d=(c=null!=c?""+c:c)?b.indexOf(c):-1;return-1!=d?b.slice(0,d):b},strLeftBack:function(b,c){var b=b+"",d=b.lastIndexOf(null!=c?""+c:c);return-1!=d?b.slice(0,d):b},toSentence:function(b,c,d){c||(c=", ");d||(d=" and ");for(var e=b.length,f="",g=0;g<e;g++)f+=b[g],g===e-2?f+=d:g<e-1&&(f+=c);return f},slugify:function(b){var c=RegExp(f("\u0105\u00e0\u00e1\u00e4\u00e2\u00e3\u0107\u0119\u00e8\u00e9\u00eb\u00ea\u00ec\u00ed\u00ef\u00ee\u0142\u0144\u00f2\u00f3\u00f6\u00f4\u00f5\u00f9\u00fa\u00fc\u00fb\u00f1\u00e7\u017c\u017a\u00b7/_:;"),
"g");return b=(""+b).toLowerCase(),b=b.replace(c,function(b){return"aaaaaaceeeeeiiiilnooooouuuunczz".charAt("\u0105\u00e0\u00e1\u00e4\u00e2\u00e3\u0107\u0119\u00e8\u00e9\u00eb\u00ea\u00ec\u00ed\u00ef\u00ee\u0142\u0144\u00f2\u00f3\u00f6\u00f4\u00f5\u00f9\u00fa\u00fc\u00fb\u00f1\u00e7\u017c\u017a\u00b7/_:;".indexOf(b))||"-"}),j.trim(b.replace(/[^\w\s-]/g,"").replace(/[-\s]+/g,"-"),"-")},exports:function(){var b={},c;for(c in this)if(this.hasOwnProperty(c)&&!("include"==c||"contains"==c||"reverse"==
c))b[c]=this[c];return b},repeat:g};j.strip=j.trim;j.lstrip=j.ltrim;j.rstrip=j.rtrim;j.center=j.lrpad;j.rjust=j.lpad;j.ljust=j.rpad;j.contains=j.include;"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(module.exports=j),exports._s=j):"function"==typeof define&&define.amd?define("underscore.string",function(){return j}):"undefined"!=typeof b._?(b._.string=j,b._.str=b._.string):b._={string:j,str:j}})(this||window);(function(b,d){function c(b){return"[object Arguments]"==C.call(b)}function e(b){return new g(b)}function g(b){this.o=b}function f(){for(var b,c=-1,d={},e={},n={},f=["d","j","g","a"];++c<arguments.length;)for(b in arguments[c])n[b]=arguments[c][b];for(;b=f.pop();)"object"==typeof n[b]?(d[b]=n[b].c,e[b]=n[b].k):d[b]=e[b]=n[b]||"";b=n.b;var c=/^[^,]+/.exec(b)[0],f=n.h,m=n.i,h=!("v"==b||"b"==m),m=!("b"==b||"a"==m),g=n.n!==z;return Function("c,d,i,l,m,n,p,q,s,t,w,z,B,E,F,k,G",'"use strict";return function('+
b+"){"+(n.m||"")+";"+("var o, y"+(f?"="+f:""))+";if("+c+"==G)return "+(n.f||"y")+";"+(h?"var u="+c+".length;o=-1;"+((m?"if(u===+u){":"")+(d.d||"")+";while("+(d.j||"++o<u")+"){"+d.g+"}"+(d.a||"")+";"+(m?"}":"")):"")+(m?(h?"else{":"")+(e.d||"")+";for("+(e.j||"o in "+c)+"){"+(g?"if(m.call("+/\S+$/.exec(e.j||c)[0]+",o)){":"")+e.g+(g?"}":"")+"}"+(e.a||"")+";"+(h?"}":""):"")+(n.e||"")+";return "+(n.l||"y")+"}")(Z,u,G,za,A,M,t,Infinity,ka,aa,Math,F,v,C,I,z)}function l(b){return b.replace(va,function(b,c){return N[c]})}
function j(b,c,e,n){var f=2<arguments.length;if(b==d)return e;n&&(c=u(c,n));var m=b.length;if(m===+m){for(m&&!f&&(e=b[--m]);m--;)e=c(e,b[m],m,b);return e}var h=la(b);for((m=h.length)&&!f&&(e=b[h[--m]]);m--;)f=h[m],e=c(e,b[f],f,b);return e}function h(b,c,d){var e=0,n=b.length;for(d||(d=M);e<n;){var f=e+n>>1;d(b[f])<d(c)?e=f+1:n=f}return e}function k(b,c,e){return c==d||e?b[0]:F.call(b,0,c)}function s(b,c){return c?G.apply([],b):ba(b,function(b,c){if(ka(c))return E.apply(b,s(c)),b;b.push(c);return b},
[])}function t(b,c,e){var n;if(b==d)return-1;if(e)return e=h(b,c),b[e]===c?e:-1;e=0;for(n=b.length;e<n;e++)if(b[e]===c)return e;return-1}function o(b){var c=F.call(arguments,1);return ja(q(b),function(b){return ia(c,function(c){return 0<=t(c,b)})})}function p(b,c,e){var n=b.length;return c==d||e?b[n-1]:F.call(b,-c||n)}function w(b,c,e){return F.call(b,c==d||e?1:c)}function q(b,c,d){var d=d?T(b,d):b,e=[];3>b.length&&(c=I);ba(d,function(d,n,f){if(c?p(d)!==n||!d.length:0>t(d,n))d.push(n),e.push(b[f]);
return d},[]);return e}function u(b,c){var d=F.call(arguments,2),e=d.length;return function(){d.length=e;E.apply(d,arguments);return b.apply(c,d)}}function x(b,c,e){var n;return function(){var f=arguments,m=this;e&&!n&&b.apply(m,f);Y(n);n=R(function(){n=d;e||b.apply(m,f)},c)}}function m(b,c,e){e||(e=[]);if(b===c)return 0!==b||1/b==1/c;if(b==d||c==d)return b===c;b.p&&(b=b.o);c.p&&(c=c.o);if(b.isEqual&&y(b.isEqual))return b.isEqual(c);if(c.isEqual&&y(c.isEqual))return c.isEqual(b);var n=C.call(b);if(n!=
C.call(c))return z;switch(n){case v:return b==""+c;case ra:return b!=+b?c!=+c:0==b?1/b==1/c:b==+c;case wa:case ya:return+b==+c;case xa:return b.source==c.source&&b.global==c.global&&b.multiline==c.multiline&&b.ignoreCase==c.ignoreCase}if("object"!=typeof b||"object"!=typeof c)return z;for(var f=e.length;f--;)if(e[f]==b)return I;var f=I,h=0;e.push(b);if(n==Z){if(h=b.length,f=h==c.length)for(;h--&&(f=h in b==h in c&&m(b[h],c[h],e)););}else{if("constructor"in b!="constructor"in c||b.constructor!=c.constructor)return z;
for(var g in b)if(A.call(b,g)&&(h++,!(f=A.call(c,g)&&m(b[g],c[g],e))))break;if(f){for(g in c)if(A.call(c,g)&&!h--)break;f=!h}}e.pop();return f}function y(b){return C.call(b)==za}function M(b){return b}function B(b){Q(ma(b),function(c){var d=e[c]=b[c];e.prototype[c]=function(){var b=F.call(arguments);ua.call(b,this.o);b=d.apply(e,b);return this.p?(new g(b)).chain():b}})}var I=!0,z=!1,N={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"};(function(){for(var b in N)N[N[b]]=b})();var ea=
"object"==typeof exports&&exports&&("object"==typeof global&&global&&global==global.global&&(b=global),exports),n=0,W=b._,Aa=/\\|'|\r|\n|\t|\u2028|\u2029/g,ta=/.^/,va=/\\(\\|'|r|n|t|u2028|u2029)/g,Z="[object Array]",wa="[object Boolean]",ya="[object Date]",za="[object Function]",ra="[object Number]",xa="[object RegExp]",v="[object String]",H=Array.prototype,D=Object.prototype,G=H.concat,A=D.hasOwnProperty,E=H.push,F=H.slice,C=D.toString,ua=H.unshift,qa=b.isFinite,D=Object.keys,Y=b.clearTimeout,R=
b.setTimeout,P={b:"b",m:"var I=i.apply([],z.call(arguments,1))",h:"[]",g:"if(p(I,b[o])<0)y.push(b[o])"},U={h:"F",g:"if(!e(g[o],o,g))return !y"},J={b:"v",h:"v",d:"for(var A,j=1,u=arguments.length;j<u;j++){A=arguments[j]",j:"o in A",g:"v[o]=A[o]",n:z,a:"}"},O={h:"[]",g:"e(g[o],o,g)&&y.push(g[o])"},L={b:"g,e,D",m:"if(!e){e=n}else if(D){e=d(e,D)}",h:"g",g:"e(g[o],o,g)"},K={b:"v",m:"if(v!==Object(v))throw TypeError()",h:"[]",g:"y.push(o)"},fa={h:"",f:"[]",d:{c:"y=Array(u)",k:"y=[]"},g:{c:"y[o]=e(g[o],o,g)",
k:"y[y.length]=e(g[o],o,g)"}},S={m:"var j,y=-q,h=y;if(!e){if(s(g)&&g[0]===+g[0])return w.max.apply(w,g);if(t(g))return y;}else if(D)e=d(e,D)",g:"j=e?e(g[o],o,g):g[o];if(j>=h)h=j,y=g[o]"},ka=Array.isArray||function(b){return C.call(b)==Z},aa=f({b:"H",i:"b",m:"var f=E.call(H)",h:"F",d:"if(f==c||f==B)return !H.length",g:"return k"}),da=f({b:"g,C",h:"k",g:"if(g[o]===C)return F"}),ia=f(L,U),ja=f(L,O),na=f(L,{g:"if(e(g[o],o,g))return g[o]"}),Q=f(L),T=f(L,fa),ca=f(L,S),S=f(L,S,{m:S.m.replace("-","").replace("max",
"min"),g:S.g.replace(">=","<")}),ga=f(fa,{b:"g,x",g:{c:"y[o]=g[o][x]",k:"y[y.length]=g[o][x]"}}),ba=f({b:"g,e,a,D",m:"var r=arguments.length>2;if(D)e=d(e,D)",h:"a",d:{c:"if(!r)y=g[++o]"},g:{c:"y=e(y,g[o],o,g)",k:"y=r?e(y,g[o],o,g):(r=F,g[o])"}}),O=f(L,O,{g:"!"+O.g}),U=f(L,U,{h:"k",g:U.g.replace("!","")}),ha=f(fa,{b:"g",g:{c:"y[o]=g[o]",k:"y[y.length]=g[o]"}}),fa=f({b:"b",h:"[]",g:"if(b[o])y.push(b[o])"}),L=f(P),P=f(P,{m:"var I=z.call(arguments,1)",h:"[]"}),sa=f(J,{g:"if(v[o]==G)"+J.g}),X=f(J),ma=
f(K,{m:"",n:z,g:"if(E.call(v[o])==l)y.push(o)",l:"y.sort()"});c(arguments)||(c=function(b){return!(!b||!A.call(b,"callee"))});var la=D||f(K);X(e,{VERSION:"0.1.0",templateSettings:{escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g},after:function(b,c){return 1>b?c():function(){if(1>--b)return c.apply(this,arguments)}},bind:u,bindAll:function(b){var c=arguments,d=1;1==c.length&&(d=0,c=ma(b));for(var e=c.length;d<e;d++)b[c[d]]=u(b[c[d]],b);return b},chain:function(b){return(new g(b)).chain()},
clone:function(b){return b!==Object(b)?b:ka(b)?b.slice():X({},b)},compact:fa,compose:function(){var b=arguments;return function(){for(var c=arguments,d=b.length;d--;)c=[b[d].apply(this,c)];return c[0]}},contains:da,debounce:x,defaults:sa,defer:function(b){var c=F.call(arguments,1);return R(function(){return b.apply(d,c)},1)},delay:function(b,c){var e=F.call(arguments,2);return R(function(){return b.apply(d,e)},c)},difference:L,escape:function(b){return(b+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,
"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},every:ia,extend:X,filter:ja,find:na,first:k,flatten:s,forEach:Q,functions:ma,groupBy:function(b,c){var d={};if(!y(c))var e=c,c=function(b){return b[e]};Q(b,function(b,e,n){e=c(b,e,n);(d[e]||(d[e]=[])).push(b)});return d},has:function(b,c){return A.call(b,c)},identity:M,indexOf:t,initial:function(b,c,e){return F.call(b,0,-(c==d||e?1:c))},intersection:o,invoke:function(b,c){var d=F.call(arguments,2),e=y(c);return T(b,function(b){return(e?
c||b:b[c]).apply(b,d)})},isArguments:c,isArray:ka,isBoolean:function(b){return b===I||b===z||C.call(b)==wa},isDate:function(b){return C.call(b)==ya},isElement:function(b){return!!(b&&1==b.nodeType)},isEmpty:aa,isEqual:m,isFinite:function(b){return qa(b)&&C.call(b)==ra},isFunction:y,isNaN:function(b){return C.call(b)==ra&&b!=+b},isNull:function(b){return null===b},isNumber:function(b){return C.call(b)==ra},isObject:function(b){return b===Object(b)},isRegExp:function(b){return C.call(b)==xa},isString:function(b){return C.call(b)==
v},isUndefined:function(b){return b===d},keys:la,last:p,lastIndexOf:function(b,c){if(b==d)return-1;for(var e=b.length;e--;)if(b[e]===c)return e;return-1},map:T,max:ca,memoize:function(b,c){var d={};return function(){var e=c?c.apply(this,arguments):arguments[0];return A.call(d,e)?d[e]:d[e]=b.apply(this,arguments)}},min:S,mixin:B,noConflict:function(){b._=W;return this},once:function(b){var c,d=z;return function(){if(d)return c;d=I;return c=b.apply(this,arguments)}},pick:function(b){for(var c,d=-1,
e=s(F.call(arguments,1)),n=e.length,f={};++d<n;)c=e[d],c in b&&(f[c]=b[c]);return f},pluck:ga,range:function(b,c,d){d||(d=1);2>arguments.length&&(c=b||0,b=0);for(var e=-1,n=Math.max(Math.ceil((c-b)/d),0),f=Array(n);++e<n;)f[e]=b,b+=d;return f},reduce:ba,reduceRight:j,reject:O,rest:w,result:function(b,c){if(b==d)return null;var e=b[c];return y(e)?b[c]():e},shuffle:function(b){var c,d=[];Q(b,function(b,e){c=Math.floor(Math.random()*(e+1));d[e]=d[c];d[c]=b});return d},size:function(b){var c=C.call(b);
return c==Z||c==v?b.length:la(b).length},some:U,sortBy:function(b,c,e){if(y(c))e&&(c=u(c,e));else var n=c,c=function(b){return b[n]};return ga(T(b,function(d,e){return{a:c(d,e,b),b:d}}).sort(function(b,c){var e=b.a,n=c.a;return e===d?1:n===d?-1:e<n?-1:e>n?1:0}),"b")},sortedIndex:h,tap:function(b,c){c(b);return b},template:function(b,c,d){function n(b){return f.call(this,b,e)}d=sa(d||{},e.templateSettings);b="__p+='"+b.replace(Aa,function(b){return"\\"+N[b]}).replace(d.escape||ta,function(b,c){return"'+((__t=("+
l(c)+"))==null?'':_['escape'](__t))+'"}).replace(d.interpolate||ta,function(b,c){return"'+((__t=("+l(c)+"))==null?'':__t)+'"}).replace(d.evaluate||ta,function(b,c){return"';"+l(c)+";__p+='"})+"';";d.variable||(b="with(object||{}){"+b+"}");var b='var __t,__j=Array.prototype.join,__p="";function print(){__p+=__j.call(arguments,"")}'+b+"return __p",f=Function(d.variable||"object","_",b);if(c)return f(c,e);n.source="function("+(d.variable||"object")+"){"+b+"}";return n},throttle:function(b,c){var e,n,
f,m,h,g,W=x(function(){n=h=z},c);return function(){e=arguments;m=this;g||(g=R(function(){g=d;n&&b.apply(m,e);W()},c));h?n=I:f=b.apply(m,e);W();h=I;return f}},times:function(b,c,d){d&&(c=u(c,d));for(d=0;d<b;d++)c(d)},toArray:function(b){if(!b)return[];if(y(b.toArray))return b.toArray();var c=b.length;return c===+c?F.call(b):ha(b)},union:function(){return q(s(arguments,I))},uniq:q,uniqueId:function(b){var c=n++;return b?b+c:c},values:ha,without:P,wrap:function(b,c){return function(){var d=[b];E.apply(d,
arguments);return c.apply(this,d)}},zip:function(){for(var b=-1,c=ca(ga(arguments,"length")),d=Array(c);++b<c;)d[b]=ga(arguments,b);return d},all:ia,any:U,collect:T,detect:na,each:Q,foldl:ba,foldr:j,head:k,include:da,inject:ba,intersect:o,methods:ma,select:ja,tail:w,take:k,unique:q});g.prototype=e.prototype;B(e);Q("pop,push,reverse,shift,sort,splice,unshift".split(","),function(b){var c=H[b];e.prototype[b]=function(){var b=this.o;c.apply(b,arguments);b.length===0&&delete b[0];return this.p?(new g(b)).chain():
b}});Q(["concat","join","slice"],function(b){var c=H[b];g.prototype[b]=function(){var b=c.apply(this.o,arguments);return this.p?(new g(b)).chain():b}});X(g.prototype,{chain:function(){this.p=I;return this},value:function(){return this.o}});ea?"object"==typeof module&&module&&module.q==ea?(module.q=e)._=e:ea._=e:(b._=e,"function"==typeof define&&"object"==typeof define.amd&&define.amd&&define.amd.lodash&&define("lodash",function(){return e}))})(this);(function(){var b=this,d=b.Backbone,c=Array.prototype.slice,e=Array.prototype.splice,g;g="undefined"!==typeof exports?exports:b.Backbone={};g.VERSION="0.9.2";var f=b._;!f&&"undefined"!==typeof require&&(f=require("underscore"));var l=b.jQuery||b.Zepto||b.ender;g.setDomLibrary=function(b){l=b};g.noConflict=function(){b.Backbone=d;return this};g.emulateHTTP=!1;g.emulateJSON=!1;var j=/\s+/,h=g.Events={on:function(b,c,d){var e,f,m,h,g;if(!c)return this;b=b.split(j);for(e=this._callbacks||(this._callbacks=
{});f=b.shift();)m=(g=e[f])?g.tail:{},m.next=h={},m.context=d,m.callback=c,e[f]={tail:h,next:g?g.next:m};return this},off:function(b,c,d){var e,m,h,g,k,y;if(m=this._callbacks){if(!b&&!c&&!d)return delete this._callbacks,this;for(b=b?b.split(j):f.keys(m);e=b.shift();)if(h=m[e],delete m[e],h&&(c||d))for(g=h.tail;(h=h.next)!==g;)if(k=h.callback,y=h.context,c&&k!==c||d&&y!==d)this.on(e,k,y);return this}},trigger:function(b){var d,e,f,m,h,g;if(!(f=this._callbacks))return this;h=f.all;b=b.split(j);for(g=
c.call(arguments,1);d=b.shift();){if(e=f[d])for(m=e.tail;(e=e.next)!==m;)e.callback.apply(e.context||this,g);if(e=h){m=e.tail;for(d=[d].concat(g);(e=e.next)!==m;)e.callback.apply(e.context||this,d)}}return this}};h.bind=h.on;h.unbind=h.off;var k=g.Model=function(b,c){var d;b||(b={});c&&c.parse&&(b=this.parse(b));if(d=N(this,"defaults"))b=f.extend({},d,b);c&&c.collection&&(this.collection=c.collection);this.attributes={};this._escapedAttributes={};this.cid=f.uniqueId("c");this.changed={};this._silent=
{};this._pending={};this.set(b,{silent:!0});this.changed={};this._silent={};this._pending={};this._previousAttributes=f.clone(this.attributes);this.initialize.apply(this,arguments)};f.extend(k.prototype,h,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},get:function(b){return this.attributes[b]},escape:function(b){var c;if(c=this._escapedAttributes[b])return c;c=this.get(b);return this._escapedAttributes[b]=f.escape(null==
c?"":""+c)},has:function(b){return null!=this.get(b)},set:function(b,c,d){var e,m;f.isObject(b)||null==b?(e=b,d=c):(e={},e[b]=c);d||(d={});if(!e)return this;e instanceof k&&(e=e.attributes);if(d.unset)for(m in e)e[m]=void 0;if(!this._validate(e,d))return!1;this.idAttribute in e&&(this.id=e[this.idAttribute]);var c=d.changes={},h=this.attributes,g=this._escapedAttributes,j=this._previousAttributes||{};for(m in e){b=e[m];if(!f.isEqual(h[m],b)||d.unset&&f.has(h,m))delete g[m],(d.silent?this._silent:
c)[m]=!0;d.unset?delete h[m]:h[m]=b;!f.isEqual(j[m],b)||f.has(h,m)!=f.has(j,m)?(this.changed[m]=b,d.silent||(this._pending[m]=!0)):(delete this.changed[m],delete this._pending[m])}d.silent||this.change(d);return this},unset:function(b,c){(c||(c={})).unset=!0;return this.set(b,null,c)},clear:function(b){(b||(b={})).unset=!0;return this.set(f.clone(this.attributes),b)},fetch:function(b){var b=b?f.clone(b):{},c=this,d=b.success;b.success=function(e,f,m){if(!c.set(c.parse(e,m),b))return!1;d&&d(c,e)};
b.error=g.wrapError(b.error,c,b);return(this.sync||g.sync).call(this,"read",this,b)},save:function(b,c,d){var e,m;f.isObject(b)||null==b?(e=b,d=c):(e={},e[b]=c);d=d?f.clone(d):{};if(d.wait){if(!this._validate(e,d))return!1;m=f.clone(this.attributes)}b=f.extend({},d,{silent:!0});if(e&&!this.set(e,d.wait?b:d))return!1;var h=this,j=d.success;d.success=function(b,c,n){c=h.parse(b,n);if(d.wait){delete d.wait;c=f.extend(e||{},c)}if(!h.set(c,d))return false;j?j(h,b):h.trigger("sync",h,b,d)};d.error=g.wrapError(d.error,
h,d);c=this.isNew()?"create":"update";c=(this.sync||g.sync).call(this,c,this,d);d.wait&&this.set(m,b);return c},destroy:function(b){var b=b?f.clone(b):{},c=this,d=b.success,e=function(){c.trigger("destroy",c,c.collection,b)};if(this.isNew())return e(),!1;b.success=function(f){b.wait&&e();d?d(c,f):c.trigger("sync",c,f,b)};b.error=g.wrapError(b.error,c,b);var m=(this.sync||g.sync).call(this,"delete",this,b);b.wait||e();return m},url:function(){var b=N(this,"urlRoot")||N(this.collection,"url")||ea();
return this.isNew()?b:b+("/"==b.charAt(b.length-1)?"":"/")+encodeURIComponent(this.id)},parse:function(b){return b},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return null==this.id},change:function(b){b||(b={});var c=this._changing;this._changing=!0;for(var d in this._silent)this._pending[d]=!0;var e=f.extend({},b.changes,this._silent);this._silent={};for(d in e)this.trigger("change:"+d,this,this.get(d),b);if(c)return this;for(;!f.isEmpty(this._pending);){this._pending=
{};this.trigger("change",this,b);for(d in this.changed)!this._pending[d]&&!this._silent[d]&&delete this.changed[d];this._previousAttributes=f.clone(this.attributes)}this._changing=!1;return this},hasChanged:function(b){return!arguments.length?!f.isEmpty(this.changed):f.has(this.changed,b)},changedAttributes:function(b){if(!b)return this.hasChanged()?f.clone(this.changed):!1;var c,d=!1,e=this._previousAttributes,m;for(m in b)if(!f.isEqual(e[m],c=b[m]))(d||(d={}))[m]=c;return d},previous:function(b){return!arguments.length||
!this._previousAttributes?null:this._previousAttributes[b]},previousAttributes:function(){return f.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(b,c){if(c.silent||!this.validate)return!0;var b=f.extend({},this.attributes,b),d=this.validate(b,c);if(!d)return!0;c&&c.error?c.error(this,d,c):this.trigger("error",this,d,c);return!1}});var s=g.Collection=function(b,c){c||(c={});c.model&&(this.model=c.model);c.comparator&&(this.comparator=c.comparator);
this._reset();this.initialize.apply(this,arguments);b&&this.reset(b,{silent:!0,parse:c.parse})};f.extend(s.prototype,h,{model:k,initialize:function(){},toJSON:function(b){return this.map(function(c){return c.toJSON(b)})},add:function(b,c){var d,m,h,g,j,k={},y={},x=[];c||(c={});b=f.isArray(b)?b.slice():[b];d=0;for(m=b.length;d<m;d++){if(!(h=b[d]=this._prepareModel(b[d],c)))throw Error("Can't add an invalid model to a collection");g=h.cid;j=h.id;k[g]||this._byCid[g]||null!=j&&(y[j]||this._byId[j])?
x.push(d):k[g]=y[j]=h}for(d=x.length;d--;)b.splice(x[d],1);d=0;for(m=b.length;d<m;d++)(h=b[d]).on("all",this._onModelEvent,this),this._byCid[h.cid]=h,null!=h.id&&(this._byId[h.id]=h);this.length+=m;e.apply(this.models,[null!=c.at?c.at:this.models.length,0].concat(b));this.comparator&&this.sort({silent:!0});if(c.silent)return this;d=0;for(m=this.models.length;d<m;d++)if(k[(h=this.models[d]).cid])c.index=d,h.trigger("add",h,this,c);return this},remove:function(b,c){var d,e,m,h;c||(c={});b=f.isArray(b)?
b.slice():[b];d=0;for(e=b.length;d<e;d++)if(h=this.getByCid(b[d])||this.get(b[d]))delete this._byId[h.id],delete this._byCid[h.cid],m=this.indexOf(h),this.models.splice(m,1),this.length--,c.silent||(c.index=m,h.trigger("remove",h,this,c)),this._removeReference(h);return this},push:function(b,c){b=this._prepareModel(b,c);this.add(b,c);return b},pop:function(b){var c=this.at(this.length-1);this.remove(c,b);return c},unshift:function(b,c){b=this._prepareModel(b,c);this.add(b,f.extend({at:0},c));return b},
shift:function(b){var c=this.at(0);this.remove(c,b);return c},get:function(b){return null==b?void 0:this._byId[null!=b.id?b.id:b]},getByCid:function(b){return b&&this._byCid[b.cid||b]},at:function(b){return this.models[b]},where:function(b){return f.isEmpty(b)?[]:this.filter(function(c){for(var d in b)if(b[d]!==c.get(d))return!1;return!0})},sort:function(b){b||(b={});if(!this.comparator)throw Error("Cannot sort a set without a comparator");var c=f.bind(this.comparator,this);1==this.comparator.length?
this.models=this.sortBy(c):this.models.sort(c);b.silent||this.trigger("reset",this,b);return this},pluck:function(b){return f.map(this.models,function(c){return c.get(b)})},reset:function(b,c){b||(b=[]);c||(c={});for(var d=0,e=this.models.length;d<e;d++)this._removeReference(this.models[d]);this._reset();this.add(b,f.extend({silent:!0},c));c.silent||this.trigger("reset",this,c);return this},fetch:function(b){b=b?f.clone(b):{};void 0===b.parse&&(b.parse=!0);var c=this,d=b.success;b.success=function(e,
f,m){c[b.add?"add":"reset"](c.parse(e,m),b);d&&d(c,e)};b.error=g.wrapError(b.error,c,b);return(this.sync||g.sync).call(this,"read",this,b)},create:function(b,c){var d=this,c=c?f.clone(c):{},b=this._prepareModel(b,c);if(!b)return!1;c.wait||d.add(b,c);var e=c.success;c.success=function(f,m){c.wait&&d.add(f,c);e?e(f,m):f.trigger("sync",b,m,c)};b.save(null,c);return b},parse:function(b){return b},chain:function(){return f(this.models).chain()},_reset:function(){this.length=0;this.models=[];this._byId=
{};this._byCid={}},_prepareModel:function(b,c){c||(c={});b instanceof k?b.collection||(b.collection=this):(c.collection=this,b=new this.model(b,c),b._validate(b.attributes,c)||(b=!1));return b},_removeReference:function(b){this==b.collection&&delete b.collection;b.off("all",this._onModelEvent,this)},_onModelEvent:function(b,c,d,e){("add"==b||"remove"==b)&&d!=this||("destroy"==b&&this.remove(c,e),c&&b==="change:"+c.idAttribute&&(delete this._byId[c.previous(c.idAttribute)],this._byId[c.id]=c),this.trigger.apply(this,
arguments))}});f.each("forEach,each,map,reduce,reduceRight,find,detect,filter,select,reject,every,all,some,any,include,contains,invoke,max,min,sortBy,sortedIndex,toArray,size,first,initial,rest,last,without,indexOf,shuffle,lastIndexOf,isEmpty,groupBy".split(","),function(b){s.prototype[b]=function(){return f[b].apply(f,[this.models].concat(f.toArray(arguments)))}});var t=g.Router=function(b){b||(b={});b.routes&&(this.routes=b.routes);this._bindRoutes();this.initialize.apply(this,arguments)},o=/:\w+/g,
p=/\*\w+/g,w=/[-[\]{}()+?.,\\^$|#\s]/g;f.extend(t.prototype,h,{initialize:function(){},route:function(b,c,d){g.history||(g.history=new q);f.isRegExp(b)||(b=this._routeToRegExp(b));d||(d=this[c]);g.history.route(b,f.bind(function(e){e=this._extractParameters(b,e);d&&d.apply(this,e);this.trigger.apply(this,["route:"+c].concat(e));g.history.trigger("route",this,c,e)},this));return this},navigate:function(b,c){g.history.navigate(b,c)},_bindRoutes:function(){if(this.routes){var b=[],c;for(c in this.routes)b.unshift([c,
this.routes[c]]);c=0;for(var d=b.length;c<d;c++)this.route(b[c][0],b[c][1],this[b[c][1]])}},_routeToRegExp:function(b){b=b.replace(w,"\\$&").replace(o,"([^/]+)").replace(p,"(.*?)");return RegExp("^"+b+"$")},_extractParameters:function(b,c){return b.exec(c).slice(1)}});var q=g.History=function(){this.handlers=[];f.bindAll(this,"checkUrl")},u=/^[#\/]/,x=/msie [\w.]+/;q.started=!1;f.extend(q.prototype,h,{interval:50,getHash:function(b){return(b=(b?b.location:window.location).href.match(/#(.*)$/))?b[1]:
""},getFragment:function(b,c){if(null==b)if(this._hasPushState||c){var b=window.location.pathname,d=window.location.search;d&&(b+=d)}else b=this.getHash();b.indexOf(this.options.root)||(b=b.substr(this.options.root.length));return b.replace(u,"")},start:function(b){if(q.started)throw Error("Backbone.history has already been started");q.started=!0;this.options=f.extend({},{root:"/"},this.options,b);this._wantsHashChange=!1!==this.options.hashChange;this._wantsPushState=!!this.options.pushState;this._hasPushState=
!(!this.options.pushState||!window.history||!window.history.pushState);var b=this.getFragment(),c=document.documentMode;if(c=x.exec(navigator.userAgent.toLowerCase())&&(!c||7>=c))this.iframe=l('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(b);this._hasPushState?l(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!c?l(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,
this.interval));this.fragment=b;b=window.location;c=b.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!c)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&c&&b.hash&&(this.fragment=this.getHash().replace(u,""),window.history.replaceState({},document.title,b.protocol+"//"+b.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},
stop:function(){l(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);q.started=!1},route:function(b,c){this.handlers.unshift({route:b,callback:c})},checkUrl:function(){var b=this.getFragment();b==this.fragment&&this.iframe&&(b=this.getFragment(this.getHash(this.iframe)));if(b==this.fragment)return!1;this.iframe&&this.navigate(b);this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(b){var c=this.fragment=this.getFragment(b);return f.any(this.handlers,
function(b){if(b.route.test(c))return b.callback(c),!0})},navigate:function(b,c){if(!q.started)return!1;if(!c||!0===c)c={trigger:c};var d=(b||"").replace(u,"");this.fragment!=d&&(this._hasPushState?(0!=d.indexOf(this.options.root)&&(d=this.options.root+d),this.fragment=d,window.history[c.replace?"replaceState":"pushState"]({},document.title,d)):this._wantsHashChange?(this.fragment=d,this._updateHash(window.location,d,c.replace),this.iframe&&d!=this.getFragment(this.getHash(this.iframe))&&(c.replace||
this.iframe.document.open().close(),this._updateHash(this.iframe.location,d,c.replace))):window.location.assign(this.options.root+b),c.trigger&&this.loadUrl(b))},_updateHash:function(b,c,d){d?b.replace(b.toString().replace(/(javascript:|#).*$/,"")+"#"+c):b.hash=c}});var m=g.View=function(b){this.cid=f.uniqueId("view");this._configure(b||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()},y=/^(\S+)\s*(.*)$/,M="model,collection,el,id,attributes,className,tagName".split(",");
f.extend(m.prototype,h,{tagName:"div",$:function(b){return this.$el.find(b)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(b,c,d){b=document.createElement(b);c&&l(b).attr(c);d&&l(b).html(d);return b},setElement:function(b,c){this.$el&&this.undelegateEvents();this.$el=b instanceof l?b:l(b);this.el=this.$el[0];!1!==c&&this.delegateEvents();return this},delegateEvents:function(b){if(b||(b=N(this,"events"))){this.undelegateEvents();
for(var c in b){var d=b[c];f.isFunction(d)||(d=this[b[c]]);if(!d)throw Error('Method "'+b[c]+'" does not exist');var e=c.match(y),m=e[1],e=e[2],d=f.bind(d,this),m=m+(".delegateEvents"+this.cid);""===e?this.$el.bind(m,d):this.$el.delegate(e,m,d)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(b){this.options&&(b=f.extend({},this.options,b));for(var c=0,d=M.length;c<d;c++){var e=M[c];b[e]&&(this[e]=b[e])}this.options=b},_ensureElement:function(){if(this.el)this.setElement(this.el,
!1);else{var b=N(this,"attributes")||{};this.id&&(b.id=this.id);this.className&&(b["class"]=this.className);this.setElement(this.make(this.tagName,b),!1)}}});k.extend=s.extend=t.extend=m.extend=function(b,c){var d=z(this,b,c);d.extend=this.extend;return d};var B={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};g.sync=function(b,c,d){var e=B[b];d||(d={});var m={type:e,dataType:"json"};d.url||(m.url=N(c,"url")||ea());if(!d.data&&c&&("create"==b||"update"==b))m.contentType="application/json",
m.data=JSON.stringify(c.toJSON());g.emulateJSON&&(m.contentType="application/x-www-form-urlencoded",m.data=m.data?{model:m.data}:{});if(g.emulateHTTP&&("PUT"===e||"DELETE"===e))g.emulateJSON&&(m.data._method=e),m.type="POST",m.beforeSend=function(b){b.setRequestHeader("X-HTTP-Method-Override",e)};"GET"!==m.type&&!g.emulateJSON&&(m.processData=!1);return l.ajax(f.extend(m,d))};g.wrapError=function(b,c,d){return function(e,f){f=e===c?f:e;b?b(c,f,d):c.trigger("error",c,f,d)}};var I=function(){},z=function(b,
c,d){var e;e=c&&c.hasOwnProperty("constructor")?c.constructor:function(){b.apply(this,arguments)};f.extend(e,b);I.prototype=b.prototype;e.prototype=new I;c&&f.extend(e.prototype,c);d&&f.extend(e,d);e.prototype.constructor=e;e.__super__=b.prototype;return e},N=function(b,c){return!b||!b[c]?null:f.isFunction(b[c])?b[c]():b[c]},ea=function(){throw Error('A "url" property or function must be specified');}}).call(this);var GeoJSON=function(b,d,c){var e=function(b,c,j){var l;switch(b.type){case "Point":c.position=new google.maps.LatLng(b.coordinates[1],b.coordinates[0]);"agencies"==d?c.icon="img/icons/agency.png":"ashokas"==d&&(c.icon="img/icons/ashoka.png");"agencies"==d&&(c.topic_id=j.topic_id);l=new NexsoMarker(d,c,j);break;case "MultiPoint":l=[];for(var o=0;o<b.coordinates.length;o++)c.position=new google.maps.LatLng(b.coordinates[o][1],b.coordinates[o][0]),j&&(l[u].opts.geojsonProperties=j),l.push(new NexsoMarker(d,
c));break;case "LineString":for(var p=[],o=0;o<b.coordinates.length;o++){var w=b.coordinates[o],w=new google.maps.LatLng(w[1],w[0]);p.push(w)}c.path=p;l=new google.maps.Polyline(c);j&&l.set("geojsonProperties",j);break;case "MultiLineString":l=[];for(o=0;o<b.coordinates.length;o++){for(var p=[],q=0;q<b.coordinates[o].length;q++)w=b.coordinates[o][q],w=new google.maps.LatLng(w[1],w[0]),p.push(w);c.path=p;l.push(new google.maps.Polyline(c))}if(j)for(var u=0;u<l.length;u++)l[u].set("geojsonProperties",
j);break;case "Polygon":for(var x=[],m,y,o=0;o<b.coordinates.length;o++){p=[];for(q=0;q<b.coordinates[o].length;q++)w=new google.maps.LatLng(b.coordinates[o][q][1],b.coordinates[o][q][0]),p.push(w);o?(1==o&&(y=f(p)),m==y?x.push(p.reverse()):x.push(p)):(m=f(p),x.push(p))}c.paths=x;c.zindex=3E4;l=new google.maps.Polygon(c);j&&l.set("geojsonProperties",j);break;case "MultiPolygon":l=[];for(o=0;o<b.coordinates.length;o++){x=[];for(q=0;q<b.coordinates[o].length;q++){p=[];for(u=0;u<b.coordinates[o][q].length;u++)w=
new google.maps.LatLng(b.coordinates[o][q][u][1],b.coordinates[o][q][u][0]),p.push(w);q?(1==q&&(y=f(p)),m==y?x.push(p.reverse()):x.push(p)):(m=f(p),x.push(p))}c.paths=x;l.push(new google.maps.Polygon(c))}if(j)for(u=0;u<l.length;u++)l[u].set("geojsonProperties",j);break;case "GeometryCollection":l=[];if(b.geometries)for(o=0;o<b.geometries.length;o++)l.push(e(b.geometries[o],c,j||null));else l=g('Invalid GeoJSON object: GeometryCollection object missing "geometries" member.');break;default:l=g('Invalid GeoJSON object: Geometry object must be one of "Point", "LineString", "Polygon" or "MultiPolygon".')}return l},
g=function(b){return{type:"Error",message:b}},f=function(b){for(var c,d=0;d<b.length-2;d++)if(a=(b[d+1].lat()-b[d].lat())*(b[d+2].lng()-b[d].lng())-(b[d+2].lat()-b[d].lat())*(b[d+1].lng()-b[d].lng()),0<a){c=!0;break}else if(0>a){c=!1;break}return c},l=c||{};switch(b.type){case "FeatureCollection":if(b.features)for(var c=[],j=0;j<b.features.length;j++)c.push(e(b.features[j].geometry,l,b.features[j].properties));else c=g('Invalid GeoJSON object: FeatureCollection object missing "features" member.');
break;case "GeometryCollection":if(b.geometries){c=[];for(j=0;j<b.geometries.length;j++)c.push(e(b.geometries[j],l))}else c=g('Invalid GeoJSON object: GeometryCollection object missing "geometries" member.');break;case "Feature":c=!b.properties||!b.geometry?g('Invalid GeoJSON object: Feature object missing "properties" or "geometry" member.'):e(b.geometry,l,b.properties);break;case "Point":case "MultiPoint":case "LineString":case "MultiLineString":case "Polygon":case "MultiPolygon":c=b.coordinates?
c=e(b,l):g('Invalid GeoJSON object: Geometry object missing "coordinates" member.');break;default:c=g('Invalid GeoJSON object: GeoJSON object must be one of "Point", "LineString", "Polygon", "MultiPolygon", "Feature", "FeatureCollection" or "GeometryCollection".')}return c};(function(b,d){function c(b){return!!(""===b||b&&b.charCodeAt&&b.substr)}function e(b){return t?t(b):"[object Array]"===o.call(b)}function g(b){return"[object Object]"===o.call(b)}function f(b,c){var d,b=b||{},c=c||{};for(d in c)c.hasOwnProperty(d)&&null==b[d]&&(b[d]=c[d]);return b}function l(b,c,d){var e=[],f,h;if(!b)return e;if(s&&b.map===s)return b.map(c,d);f=0;for(h=b.length;f<h;f++)e[f]=c.call(d,b[f],f,b);return e}function j(b,c){b=Math.round(Math.abs(b));return isNaN(b)?c:b}function h(b){var d=
k.settings.currency.format;"function"===typeof b&&(b=b());return c(b)&&b.match("%v")?{pos:b,neg:b.replace("-","").replace("%v","-%v"),zero:b}:!b||!b.pos||!b.pos.match("%v")?!c(d)?d:k.settings.currency.format={pos:d,neg:d.replace("%v","-%v"),zero:d}:b}var k={version:"0.3.2",settings:{currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}}},s=Array.prototype.map,t=Array.isArray,o=Object.prototype.toString,p=k.unformat=
k.parse=function(b,c){if(e(b))return l(b,function(b){return p(b,c)});b=b||0;if("number"===typeof b)return b;var c=c||".",d=RegExp("[^0-9-"+c+"]",["g"]),d=parseFloat((""+b).replace(/\((.*)\)/,"-$1").replace(d,"").replace(c,"."));return!isNaN(d)?d:0},w=k.toFixed=function(b,c){var c=j(c,k.settings.number.precision),d=Math.pow(10,c);return(Math.round(k.unformat(b)*d)/d).toFixed(c)},q=k.formatNumber=function(b,c,d,h){if(e(b))return l(b,function(b){return q(b,c,d,h)});var b=p(b),o=f(g(c)?c:{precision:c,
thousand:d,decimal:h},k.settings.number),u=j(o.precision),z=0>b?"-":"",s=parseInt(w(Math.abs(b||0),u),10)+"",t=3<s.length?s.length%3:0;return z+(t?s.substr(0,t)+o.thousand:"")+s.substr(t).replace(/(\d{3})(?=\d)/g,"$1"+o.thousand)+(u?o.decimal+w(Math.abs(b),u).split(".")[1]:"")},u=k.formatMoney=function(b,c,d,M,o,s){if(e(b))return l(b,function(b){return u(b,c,d,M,o,s)});var b=p(b),z=f(g(c)?c:{symbol:c,precision:d,thousand:M,decimal:o,format:s},k.settings.currency),t=h(z.format);return(0<b?t.pos:0>
b?t.neg:t.zero).replace("%s",z.symbol).replace("%v",q(Math.abs(b),j(z.precision),z.thousand,z.decimal))};k.formatColumn=function(b,d,y,M,o,u){if(!b)return[];var z=f(g(d)?d:{symbol:d,precision:y,thousand:M,decimal:o,format:u},k.settings.currency),s=h(z.format),t=s.pos.indexOf("%s")<s.pos.indexOf("%v")?!0:!1,n=0,b=l(b,function(b){if(e(b))return k.formatColumn(b,z);b=p(b);b=(0<b?s.pos:0>b?s.neg:s.zero).replace("%s",z.symbol).replace("%v",q(Math.abs(b),j(z.precision),z.thousand,z.decimal));b.length>n&&
(n=b.length);return b});return l(b,function(b){return c(b)&&b.length<n?t?b.replace(z.symbol,z.symbol+Array(n-b.length+1).join(" ")):Array(n-b.length+1).join(" ")+b:b})};"undefined"!==typeof exports?("undefined"!==typeof module&&module.exports&&(exports=module.exports=k),exports.accounting=k):"function"===typeof define&&define.amd?define([],function(){return k}):(k.noConflict=function(c){return function(){b.accounting=c;k.noConflict=d;return k}}(b.accounting),b.accounting=k)})(this);(function(b,d,c){function e(b,c){var e=d.createElement(b||"div"),f;for(f in c)e[f]=c[f];return e}function g(b){for(var c=1,d=arguments.length;c<d;c++)b.appendChild(arguments[c]);return b}function f(b,c,d,e){var f=["opacity",c,~~(100*b),d,e].join("-"),d=0.01+100*(d/e),e=Math.max(1-(1-b)/c*(100-d),b),h=o.substring(0,o.indexOf("Animation")).toLowerCase();return t[f]||(p.insertRule("@"+(h&&"-"+h+"-"||"")+"keyframes "+f+"{0%{opacity:"+e+"}"+d+"%{opacity:"+b+"}"+(d+0.01)+"%{opacity:1}"+(d+c)%100+"%{opacity:"+
b+"}100%{opacity:"+e+"}}",0),t[f]=1),f}function l(b,d){var e=b.style,f,h;if(e[d]!==c)return d;d=d.charAt(0).toUpperCase()+d.slice(1);for(h=0;h<s.length;h++)if(f=s[h]+d,e[f]!==c)return f}function j(b,c){for(var d in c)b.style[l(b,d)||d]=c[d];return b}function h(b){for(var d=1;d<arguments.length;d++){var e=arguments[d],f;for(f in e)b[f]===c&&(b[f]=e[f])}return b}function k(b){for(var c={x:b.offsetLeft,y:b.offsetTop};b=b.offsetParent;)c.x+=b.offsetLeft,c.y+=b.offsetTop;return c}var s=["webkit","Moz",
"ms","O"],t={},o,p=function(){var b=e("style");return g(d.getElementsByTagName("head")[0],b),b.sheet||b.styleSheet}(),w={lines:12,length:7,width:5,radius:10,rotate:0,color:"#000",speed:1,trail:100,opacity:0.25,fps:20,zIndex:2E9,className:"spinner",top:"auto",left:"auto"},q=function x(b){if(!this.spin)return new x(b);this.opts=h(b||{},x.defaults,w)};q.defaults={};h(q.prototype,{spin:function(b){this.stop();var c=this,d=c.opts,f=c.el=j(e(0,{className:d.className}),{position:"relative",zIndex:d.zIndex}),
h=d.radius+d.length+d.width,g,l;b&&(b.insertBefore(f,b.firstChild||null),l=k(b),g=k(f),j(f,{left:("auto"==d.left?l.x-g.x+(b.offsetWidth>>1):d.left+h)+"px",top:("auto"==d.top?l.y-g.y+(b.offsetHeight>>1):d.top+h)+"px"}));f.setAttribute("aria-role","progressbar");c.lines(f,c.opts);if(!o){var p=0,s=d.fps,n=s/d.speed,t=(1-d.opacity)/(n*d.trail/100),q=n/d.lines;!function va(){p++;for(var b=d.lines;b;b--){var e=Math.max(1-(p+b*q)%n*t,d.opacity);c.opacity(f,d.lines-b,e,d)}c.timeout=c.el&&setTimeout(va,~~(1E3/
s))}()}return c},stop:function(){var b=this.el;return b&&(clearTimeout(this.timeout),b.parentNode&&b.parentNode.removeChild(b),this.el=c),this},lines:function(b,c){function d(b,f){return j(e(),{position:"absolute",width:c.length+c.width+"px",height:c.width+"px",background:b,boxShadow:f,transformOrigin:"left",transform:"rotate("+~~(360/c.lines*h+c.rotate)+"deg) translate("+c.radius+"px,0)",borderRadius:(c.width>>1)+"px"})}for(var h=0,k;h<c.lines;h++)k=j(e(),{position:"absolute",top:1+~(c.width/2)+
"px",transform:c.hwaccel?"translate3d(0,0,0)":"",opacity:c.opacity,animation:o&&f(c.opacity,c.trail,h,c.lines)+" "+1/c.speed+"s linear infinite"}),c.shadow&&g(k,j(d("#000","0 0 4px #000"),{top:"2px"})),g(b,g(k,d(c.color,"0 0 1px rgba(0,0,0,.1)")));return b},opacity:function(b,c,d){c<b.childNodes.length&&(b.childNodes[c].style.opacity=d)}});!function(){function b(c,d){return e("<"+c+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',d)}var c=j(e("group"),{behavior:"url(#default#VML)"});!l(c,
"transform")&&c.adj?(p.addRule(".spin-vml","behavior:url(#default#VML)"),q.prototype.lines=function(c,d){function e(){return j(b("group",{coordsize:m+" "+m,coordorigin:-h+" "+-h}),{width:m,height:m})}function f(c,m,k){g(l,g(j(e(),{rotation:360/d.lines*c+"deg",left:~~m}),g(j(b("roundrect",{arcsize:1}),{width:h,height:d.width,left:d.radius,top:-d.width>>1,filter:k}),b("fill",{color:d.color,opacity:d.opacity}),b("stroke",{opacity:0}))))}var h=d.length+d.width,m=2*h,k=2*-(d.width+d.length)+"px",l=j(e(),
{position:"absolute",top:k,left:k});if(d.shadow)for(k=1;k<=d.lines;k++)f(k,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(k=1;k<=d.lines;k++)f(k);return g(c,l)},q.prototype.opacity=function(b,c,d,e){b=b.firstChild;e=e.shadow&&e.lines||0;b&&c+e<b.childNodes.length&&(b=b.childNodes[c+e],b=b&&b.firstChild,b=b&&b.firstChild,b&&(b.opacity=d))}):o=l(c,"animation")}();b.Spinner=q})(window,document);Backbone.CartoDB=function(b,d,c){function e(b){this.sql=b}function g(b){return new e(b)}b=_.defaults(b,{USE_PROXY:!1,user:""});e.prototype.format=function(){var b=this.sql,c=arguments.length+1,d;for(i=0;i<c;d=arguments[i++])d="object"===typeof d?JSON.stringify(d):d,b=b.replace(RegExp("\\{"+(i-1)+"\\}","g"),d);return b};var f="https://"+(b.user+".cartodb.com/api/v1/sql"),d=d||function(b,c,e){var g=f,j=!0;e&&(g="api/v0/proxy/"+f,j=!1);1500<b.length?$.ajax({url:g,crossDomain:j,type:"POST",dataType:"json",
data:"q="+encodeURIComponent(b),success:c,error:function(){e?c():USE_PROXY&&d(b,c,true)}}):$.getJSON(f+"?q="+encodeURIComponent(b)+"&callback=?").success(c).fail(function(){c()}).complete(function(){})},b={setItem:function(){},getItem:function(){return null},removeItem:function(){}},c=c&&b,l=Backbone.Model.extend({_create_sql:function(){var b=g(" where {0} = '{1}'").format(this.columns[this.what],this.get(this.what).replace("'","''"));return"select "+this._sql_select().join(",")+" from "+this.table+
b},_sql_select:function(){var b=[],c;for(c in this.columns){var d=this.columns[c];-1!==d.indexOf("ST_")||"the_geom"===d?b.push(g("ST_AsGeoJSON({1}) as {0}").format(c,d)):b.push(g("{1} as {0}").format(c,d))}return b},_parse_columns:function(b){var c={},d;for(d in b){var e=b[d],f=this.columns[d];c[d]=-1!==f.indexOf("ST_")||"the_geom"===f?JSON.parse(e):b[d]}return c},fetch:function(){var b=this;d(this._create_sql(),function(c){b.set(b._parse_columns(c.rows[0]))})}}),b=Backbone.Model.extend({initialize:function(){},
author:function(){},coordinates:function(){},allowedToEdit:function(){return!0}}),j=Backbone.Collection.extend({_create_sql:function(){var b=this.table;_.isArray(this.table)||(b=[this.table]);b.join(",");b="select "+l.prototype._sql_select.call(this).join(",")+" from "+this.table;this.where_&&(b+=" WHERE "+this.where_);return b},fetch:function(){var b=this,e=this.sql||this._create_sql();"function"===typeof e&&(e=e.call(this));var f=this.cache?c.getItem(e):!1;f?b.reset(JSON.parse(f)):d(e,function(d){if(this.cache)try{c.setItem(e,
JSON.stringify(d.rows))}catch(f){}d=b.sql?d.rows:_.map(d.rows,function(c){return l.prototype._parse_columns.call(b,c)});b.reset(d)})}});return{query:d,CartoDBCollection:j,CartoDBModel:l,Note:b,SQL:g}};jQuery.fn.smartPlaceholder=function(b){this.each(function(){var d=b&&b.speed||150,c=b&&b.timeOut||100,e=$(this).find("span.placeholder"),g=$(this).find(":input").not("input[type='hidden'], input[type='submit']");g.val()&&e.hide();g.keydown(function(b){b.metaKey&&88==b.keyCode?setTimeout(function(){isEmpty(g.val())&&e.fadeIn(d)},c):b.metaKey&&86==b.keyCode?setTimeout(function(){!isEmpty(g.val())&&e.fadeOut(d)},c):setTimeout(function(){g.val()?e.fadeOut(d):e.fadeIn(d)},0)});e.on("click",function(){g.focus()});
g.blur(function(){!g.val()&&e.fadeIn(d)})})};var config={CARTODB_USER:"nexso2",CARTODB_ENDPOINT:"https://nexso2.cartodb.com/api/v2/sql",ZOOM:4,MINZOOM:3,MAXZOOM:16,LAT:2.7235,LNG:-81.171875,MONTHNAMES:"January,February,March,April,May,June,July,August,September,October,November,December".split(","),YEARS:[2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014],DATE_FORMAT:"yyyy-MM-dd",DATE_SUFFIXES:["th","st","nd","rd"],MIN_PROJECT_RADIUS:100};config.START_YEAR=config.YEARS[0];config.END_YEAR=config.YEARS[config.YEARS.length-1];
config.BIG_SPINNER_OPTIONS={lines:7,length:0,width:7,radius:8,rotate:0,color:"#000",speed:1,trail:55,shadow:!1,hwaccel:!1,zIndex:2E9,className:"spin"};var Infowindow,Timeline,Aside,mapView,filterView,debug=!0,previousZoom=3,topics=[1,2,3,4,5,6],solutionFilter="all",previousCenter,disabledFilters=!1,globalZindex=300,visibleOverlays=[];visibleOverlays.ashokas=!0;visibleOverlays.agencies=!0;visibleOverlays.projects=!0;
var projectsStyle={strokeColor:"#E79626",strokeOpacity:0.4,strokeWeight:1,fillColor:"#E79626",fillOpacity:0.2},projectsHoverStyle={strokeColor:"#E79626",strokeOpacity:1,strokeWeight:2,fillColor:"#E79626",fillOpacity:0.7},projectsDisabledStyle={strokeColor:"#E79626",strokeOpacity:0.2,strokeWeight:1,fillColor:"#E79626",fillOpacity:0.1},projectsDisabledHoverStyle={strokeColor:"#E79626",strokeOpacity:0.2,strokeWeight:2,fillColor:"#E79626",fillOpacity:0.2},circleStyleHover={strokeColor:"#1872A1",strokeOpacity:1,
strokeWeight:2,fillColor:"#1872A1",fillOpacity:0.3},circleStyle={strokeColor:"#E79626",strokeOpacity:1,strokeWeight:1,fillColor:"#E79626",fillOpacity:0},circleDisabledStyle={strokeColor:"#E79626",strokeOpacity:0.5,strokeWeight:1,fillColor:"#E79626",fillOpacity:0},circleDisabledHoverStyle={strokeColor:"#1872A1",strokeOpacity:0.5,strokeWeight:2,fillColor:"#1872A1",fillOpacity:0.2},mapStyles=[{featureType:"water",stylers:[{saturation:-34},{lightness:29}]},{featureType:"poi",stylers:[{lightness:42},{saturation:-40}]},
{featureType:"administrative.land_parcel",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{saturation:-99},{lightness:70}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road"},{featureType:"administrative",stylers:[{saturation:-98},{lightness:72}]},{}],queries={GET_ASHOKAS:"SELECT A.the_geom, A.ashoka_url AS agency_url, A.name, A.country, A.organization_name, A.external_url, A.solution_id, S1.name solution_name, S1.nexso_url solution_url, array_to_string(array(SELECT AT.topic_id FROM ashokas_topics AS AT WHERE AT.ashoka_id = A.cartodb_id), '|') as topic_ids, array_to_string(array(SELECT T.name FROM v1_topics T, ashokas_topics AS AT WHERE AT.ashoka_id = A.cartodb_id AND T.cartodb_id = AT.topic_id), '|') as topic_names FROM ashokas_topics AT, v2_ashoka A LEFT JOIN v1_solutions S1 ON (S1.cartodb_id = A.solution_id) WHERE A.the_geom IS NOT NULL AND AT.ashoka_id = A.cartodb_id",
GET_AGENCIES:"SELECT A.the_geom, A.external_url AS agency_url, A.name AS agency_name, P.solution_id, P.topic_id, array_to_string(array(SELECT P.cartodb_id FROM v1_projects AS P WHERE P.agency_id = a.cartodb_id), '|') as projects_ids, array_to_string(array(SELECT P.title FROM v1_projects AS P WHERE P.agency_id = a.cartodb_id), '|') as projects_titles FROM v1_agencies AS A LEFT JOIN v1_projects AS P ON (A.cartodb_id = P.agency_id) LEFT JOIN v1_projects ON (A.cartodb_id = P.solution_id)",GET_PROJECTS_QUERY_TEMPLATE:"WITH qu AS (     WITH hull as (         SELECT              P.nexso_code, COUNT(S.cartodb_id) AS solution_count, P.cartodb_id AS project_id, P.title, P.approval_date, P.fixed_approval_date, P.external_project_url,              P.location_verbatim, T.name AS topic_name, P.solution_id AS solution_id, P.budget, S.name AS solution_name, S.nexso_url AS solution_url,              A.external_url AS agency_url, A.name AS agency_name, ST_AsGeoJSON(A.the_geom) AS agency_position,             ST_Collect(PWA.the_geom) AS the_geom          FROM              v1_projects P LEFT JOIN v1_solutions S ON (P.solution_id = S.cartodb_id)             LEFT JOIN v1_agencies A ON (P.agency_id = A.cartodb_id)             LEFT JOIN v1_topics AS T ON (P.topic_id = T.cartodb_id),              v1_project_work_areas AS PWA         WHERE              P.cartodb_id = PWA.project_id AND <%= topicsCondition %> <%= solutionCondition %>            (EXTRACT(YEAR FROM P.fixed_approval_date) >= <%= startYear %> AND              EXTRACT(YEAR FROM P.fixed_approval_date) <= <%= endYear %> OR EXTRACT(YEAR FROM P.fixed_approval_date) < 2002)          GROUP BY              P.nexso_code, P.cartodb_id, title, approval_date, fixed_approval_date,              external_project_url, location_verbatim, topic_name, solution_id, budget, A.external_url, A.name,             solution_name, solution_url, agency_position    )      SELECT *, ST_ConvexHull(the_geom) AS hull_geom FROM hull  )  SELECT      nexso_code, solution_count, project_id, title, approval_date, fixed_approval_date, external_project_url,      location_verbatim, topic_name, budget, agency_name, agency_url, the_geom, agency_position, solution_id, solution_name, solution_url,      ST_X(ST_Centroid(hull_geom)) AS centroid_lon,      ST_Y(ST_Centroid(hull_geom)) AS centroid_lat,      ST_X(ST_EndPoint(ST_LongestLine(ST_Centroid(hull_geom),hull_geom))) AS radius_point_lon,      ST_Y(ST_EndPoint(ST_LongestLine(ST_Centroid(hull_geom), hull_geom))) AS radius_point_lat FROM qu  ORDER BY     ST_Area(hull_geom) desc"};
String.prototype.splice=function(b,d,c){return this.slice(0,b)+c+this.slice(b+Math.abs(d))};"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var nexsoStyle=new google.maps.StyledMapType(mapStyles,{name:"Nexso Style"});function isEmpty(b){return!b.match(/\S/g)}
function prettifyDate(b){var d=Date.parseExact(b.splice(4,0,"-").splice(7,0,"-"),config.DATE_FORMAT);if(d){var b=d.getDate(),c=d.getMonth(),d=d.getFullYear(),e=config.DATE_SUFFIXES;return config.MONTHNAMES[c]+" "+b+(b>3?e[0]:e[b])+", "+d}return null}google.maps.Polygon.prototype.getBounds=function(){for(var b=new google.maps.LatLngBounds,d=this.getPaths(),c,e=0;e<d.getLength();e++){c=d.getAt(e);for(var g=0;g<c.getLength();g++)b.extend(c.getAt(g))}return b};function InfoWindow(b){this.id="infowindow-template";this.className="infowindow";this.latlng_=new google.maps.LatLng(0,0);this.template=b.template;this.map_=b.map;this.columns_=null;this.offsetHorizontal_=-107;this.width_=304;this.showDuration=250;this.setMap(b.map);this.params_=b}InfoWindow.prototype=new google.maps.OverlayView;
InfoWindow.prototype.draw=function(){var b=this.div_;if(!b){b=this.div_=document.createElement("DIV");b.className=this.className;var d=$("#"+this.id).html();this.template=_.template(d);b.innerHTML=this.template({projects:"",name:"Loading\u2026",agency_name:"",agency_url:"",overlayType:""});this.bindClose();google.maps.event.addDomListener(b,"dblclick",function(b){b.preventDefault?b.preventDefault():b.returnValue=!1});google.maps.event.addDomListener(b,"mousedown",function(b){b.preventDefault?b.preventDefault():
b.returnValue=!1;b.stopPropagation?b.stopPropagation():window.event.cancelBubble=!0});google.maps.event.addDomListener(b,"mouseup",function(b){b.preventDefault?b.preventDefault():b.returnValue=!1});google.maps.event.addDomListener(b,"mousewheel",function(b){b.stopPropagation?b.stopPropagation():window.event.cancelBubble=!0});google.maps.event.addDomListener(b,"DOMMouseScroll",function(b){b.stopPropagation?b.stopPropagation():window.event.cancelBubble=!0});this.getPanes().floatPane.appendChild(b);
b.style.opacity=0}this.setPosition()};InfoWindow.prototype.setPosition=function(b){if(this.div_){var d=this.div_,c=this.getProjection().fromLatLngToDivPixel(this.latlng_);if(c){d.style.width=this.width_+"px";d.style.left=c.x-38+"px";var e=-$(d).find(".box").height();d.style.top=c.y+e-10+"px"}b&&b()}};
InfoWindow.prototype.bindProjects=function(){$(this.div_).find(".project").click(function(b){b.preventDefault();b.stopPropagation();var b=parseFloat($(this).attr("data-lat")),d=parseFloat($(this).attr("data-lng")),c=new google.maps.LatLng(b,d);_.each(mapView.circles,function(b){b.circle.center.lat()===c.lat()&&b.circle.center.lng()===c.lng()&&setTimeout(function(){b.circle.parent.markSelected();google.maps.event.trigger(b.circle,"click",{autoopen:!0,latLng:c})},500)})})};
InfoWindow.prototype.bindClose=function(){var b=this;$(this.div_).find(".close").click(function(d){d.preventDefault();d.stopPropagation();b.hide()})};
InfoWindow.prototype.setContent=function(b){var d=null;if("agencies"===b.overlayType){var c=_.compact(b.projects_ids.split("|")),d=_.compact(b.projects_titles.split("|"));if(d=_.uniq(d))if(c=c[0],mapView.coordinates[c]){var e=mapView.coordinates[c][0],g=mapView.coordinates[c][1],d=_.map(d,function(b){return"<li><a href='#' class='project' data-lng='"+g+"' data-lat='"+e+"'>"+b+"</a></li>"});b.projects=d.join("")}else b.projects=""}this.div_.innerHTML=this.template(b);d&&this.bindProjects();this.bindClose()};
InfoWindow.prototype.setSolutionURL=function(b,d){$(this.div_).find(".solutions li a").html(b);$(this.div_).find(".solutions li a").attr("href",d)};InfoWindow.prototype.setCallback=function(b){$(".infowindow .btn").on("click",b)};InfoWindow.prototype.open=function(b){var d=this;this.latlng_=b;this.moveMaptoOpen();this.setPosition(function(){d.show()})};
InfoWindow.prototype.hide=function(){if(this.div_){var b=this.div_;$(b).animate({top:"+=10px",opacity:0},100,"swing",function(){b.style.visibility="hidden"})}};InfoWindow.prototype.show=function(){this.div_&&(this.div_.style.opacity=0,$(this.div_).animate({top:"-=10px",opacity:1},this.showDuration),this.div_.style.visibility="visible")};InfoWindow.prototype.isVisible=function(){return this.div_?"visible"===this.div_.style.visibility?!0:!1:!1};
InfoWindow.prototype.moveMaptoOpen=function(){var b=0,d=0,c=this.getProjection().fromLatLngToContainerPixel(this.latlng_);c.x+320>=$("#map").width()&&(b=c.x+320-$("#map").width());200>c.y-$(this.div_).find(".box").height()&&(d=c.y-$(this.div_).find(".box").height()-130);this.map_.panBy(b,d)};function NexsoMarker(b,d,c){this.properties=c;this.latlng_=d.position;this.opts=d;this.offsetHorizontal_=this.offsetVertical_=-7;this.overlayType_=b;this.height_=this.width_=14;this.div_=null}NexsoMarker.prototype=new google.maps.OverlayView;
NexsoMarker.prototype.draw=function(){var b=this,d=this.div_;d||(d=this.div_=document.createElement("DIV"),d.className="marker",d.innerHTML='<img src="'+this.opts.icon+'" alt="" title="" />',google.maps.event.addDomListener(d,"click",function(c){c&&(c.preventDefault?c.preventDefault():c.returnValue=!1,c.stopPropagation?c.stopPropagation():window.event.cancelBubble=!0);b.properties.overlayType=b.overlayType_;if(c=b.properties.topic_names)c=_.compact(c.split("|")),0<c.length&&(b.properties.topic_names=
c.join(". "),b.properties.topic_names+=".");Infowindow.setContent(b.properties);Infowindow.open(b.latlng_)}),google.maps.event.addDomListener(d,"mouseover",function(){globalZindex++;$(this).css("zIndex",globalZindex).animate({width:"18px",height:"18px",marginTop:"-2px",marginLeft:"-2px"},100)}),google.maps.event.addDomListener(d,"mouseout",function(){$(this).animate({width:"14px",height:"14px",marginTop:"0px",marginLeft:"0px"},100)}),this.getPanes().overlayMouseTarget.appendChild(d));this.setPosition()};
NexsoMarker.prototype.setPosition=function(){if(this.div_){var b=this.div_,d=this.getProjection().fromLatLngToDivPixel(this.latlng_);d&&(b.style.width=this.width_+"px",b.style.left=d.x+this.offsetHorizontal_+"px",b.style.top=d.y+this.offsetVertical_+"px")}};
NexsoMarker.prototype.hide=function(b){if(this.div_&&!$(this.div_).hasClass("h")){var d=this.div_;b?$(d).animate({opacity:0},{queue:!0,duration:500,complete:function(){d.style.display="none";$(this).addClass("h")}}):($(d).css({opacity:0,display:"none"}),$(d).addClass("h"))}};NexsoMarker.prototype.changeOpacity=function(b){$(this.div_).animate({opacity:b},{queue:!0,duration:500})};
NexsoMarker.prototype.show=function(b){if(this.div_&&$(this.div_).hasClass("h")){var d=this.div_;b?(d.style.display="block",d.style.opacity=0,$(d).animate({opacity:0.99},{queue:!0,duration:500,complete:function(){$(this).removeClass("h")}})):($(d).css({opacity:0.99,display:"block"}),$(d).removeClass("h"))}};NexsoMarker.prototype.showContent=function(){this.div_&&google.maps.event.trigger(this.div_,"click")};NexsoMarker.prototype.getPosition=function(){return this.latlng_};function RadiusWidget(b,d,c,e,g){var c=this.distanceBetweenPoints(d,c),f=this;this.specialAgencies=[];this.circle=new google.maps.Circle({parent:f,strokeColor:"#E79626",strokeOpacity:1,strokeWeight:1,fillColor:"#E79626",fillOpacity:0,center:d,radius:1E3*c,geodesic:!0,polygons:e});var l=[];_.each(g,function(c){if(!c)return!1;var c=$.parseJSON(c).coordinates,d=new google.maps.LatLng(c[1],c[0]);_.each(e,function(c){c=new google.maps.Polyline({path:[c[0].getBounds().getCenter(),d],strokeColor:"#1872A1",
strokeOpacity:1,strokeWeight:1,visible:!1});c.setMap(b);l.push(c)});return!0});this.circle.setOptions({lines:l});google.maps.event.clearListeners(this.circle,"click");google.maps.event.addListener(this.circle,"click",function(c){function d(){function c(b,d){var e=h.find("li."+b);"object"===typeof d?null!==d.text&&null!==d.url?(e.find("a").text(d.text).attr("href",d.url),e.show()):null!==d.text?(e.find("a").text(d.text).attr("href","#"),e.show()):e.hide():d?(e.find("span").text(d),e.show()):e.hide()}
var e=$(".aside .content"),h=e.find("ul.data");e.find(".header h2").html(o);e=prettifyDate(p);c("approvalDate",e);c("topic",M);c("nexso_code",y);c("location",B);c("budget",accounting.formatMoney(I));c("more",{url:w,text:"External link"});c("solution",{url:u,text:q});c("agency",{url:m,text:x});previousZoom=b.getZoom();previousCenter=b.getCenter();Aside.show("project");Infowindow.hide();var j=g.getBounds();_.each(f.circle.lines,function(b){j.extend(b.getPath().getAt(1))});b.fitBounds(j);b.panBy(176,
0);(e=$(".aside a.toggle").data("project"))&&e.unMarkSelected();$(".aside a.toggle").data("project",f);f.markSelected()}function e(b){b&&b.preventDefault();Timeline.hide();Aside.hide(d)}var g=this,l=this.polygons[0][0].geojsonProperties,o=l.title,p=l.approval_date,w=l.external_project_url,q=l.solution_name,u=l.solution_url,x=l.agency_name,m=l.agency_url,y=l.nexso_code,M=l.topic_name,B=l.location_verbatim,I=l.budget;c.autoopen?e():(Infowindow.setContent({name:o,overlayType:"project",agencyName:x,solution_name:q,
solution_url:u}),Infowindow.setCallback(e),Infowindow.open(c.latLng))});google.maps.event.addListener(this.circle,"mouseover",this.onMouseOver);google.maps.event.addListener(this.circle,"mouseout",this.onMouseOut);this.circle.setMap(b);return this}RadiusWidget.prototype=new google.maps.MVCObject;
RadiusWidget.prototype.onMouseOver=function(){_.each(this.polygons,function(b){b[0].disabled?b[0].setOptions(projectsDisabledHoverStyle):b[0].setOptions(projectsHoverStyle)});this.disabled?this.setOptions(circleDisabledHoverStyle):this.setOptions(circleStyleHover)};RadiusWidget.prototype.onMouseOut=function(){_.each(this.polygons,function(b){b[0].disabled?b[0].setOptions(projectsDisabledStyle):b[0].setOptions(projectsStyle)});this.disabled?this.setOptions(circleDisabledStyle):this.setOptions(circleStyle)};
RadiusWidget.prototype.markSelected=function(){google.maps.event.clearListeners(this.circle,"mouseover");google.maps.event.clearListeners(this.circle,"mouseout");_.each(this.circle.polygons,function(b){b[0].setOptions(projectsHoverStyle)});this.circle.setOptions(circleStyleHover);_.each(this.circle.lines,function(b){b.setOptions({visible:!0})});this.hideAll();filterView.disable()};
RadiusWidget.prototype.unMarkSelected=function(b){google.maps.event.addListener(this.circle,"mouseover",this.onMouseOver);google.maps.event.addListener(this.circle,"mouseout",this.onMouseOut);_.each(this.circle.polygons,function(b){b[0].setOptions(projectsStyle)});this.circle.setOptions(circleStyle);_.each(this.circle.lines,function(b){b.setOptions({visible:!1})});b&&this.showAll();filterView.enable()};
RadiusWidget.prototype.hideAll=function(){var b=this;_.each(mapView.overlays.agencies,function(d){0<b.circle.lines.length&&d.getPosition().lat()!=b.circle.lines[0].getPath().getAt(1).lat()&&d.getPosition().lng()!=b.circle.lines[0].getPath().getAt(1).lng()?d.hide():(b.specialAgencies.push(d),d.show())});mapView.hideOverlay("ashokas");_.each(mapView.circles,function(d){b!=d&&(_.each(d.circle.polygons,function(b){b[0].setOptions(projectsDisabledStyle);b[0].disabled=!0}),d.circle.setOptions(circleDisabledStyle),
d.circle.disabled=!0)})};RadiusWidget.prototype.showAll=function(){var b=this;_.each(this.specialAgencies,function(b){b.hide()});this.specialAgencies=[];mapView.addAgencies();mapView.addAshokas();_.each(mapView.circles,function(d){b!=d&&(_.each(d.circle.polygons,function(b){b[0].setOptions(projectsStyle);b[0].disabled=!1}),d.circle.setOptions(circleStyle),d.circle.disabled=!1)})};RadiusWidget.prototype.distance_changed=function(){this.set("radius",1E3*this.get("distance"))};
RadiusWidget.prototype.distanceBetweenPoints=function(b,d){if(!b||!d)return 0;var c=(d.lat()-b.lat())*Math.PI/180,e=(d.lng()-b.lng())*Math.PI/180,c=Math.sin(c/2)*Math.sin(c/2)+Math.cos(b.lat()*Math.PI/180)*Math.cos(d.lat()*Math.PI/180)*Math.sin(e/2)*Math.sin(e/2),c=6371*2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c));c<config.MIN_PROJECT_RADIUS&&(c=config.MIN_PROJECT_RADIUS);return c};$(function(){function b(){$(".input_field input.lat").val("");$(".input_field input.lng").val("")}function d(){$(".addresspicker").val("");$(".input_field input.lat").val("");$(".input_field input.lng").val("");$(".input_field .placeholder").fadeIn(250)}function c(){var b="project";$(".aside").hasClass("search")&&(b="search");var c=$(".scroll-pane-"+b),d=$(window).height(),e=c.offset().top;c.css("height",d-e-20);o[b]?(b=o[b].data("jsp"),b.reinitialise(),b.scrollTo(0,0)):(o[b]=c,o[b].jScrollPane())}
function e(b,c){0<$(".welcome").length&&($(".stats li."+b+" span").html(c),$(".stats li."+b+" .spinner ").fadeOut(250,function(){$(this).remove();$(".stats li."+b).removeClass("disabled")}))}function g(){var b=new google.maps.LatLng(config.LAT,config.LNG);q.panTo(b);q.setZoom(config.ZOOM)}function f(){Aside.hide();d();j();g();$(".timeline-cover").animate({opacity:1,bottom:"23px"},250);$(".welcome").fadeIn(250);$(".backdrop").fadeIn(250,function(){$(".nav .input_field").fadeOut(300,function(){$(".filter-help").animate({top:"0",
opacity:1},250)});$(".nav ul.filters").animate({right:0},250);$(".left-side").animate({left:"0",opacity:1},400);$(".right-side").animate({left:"0",opacity:1},400)})}function l(){var c=$("input[data-geo='lat']").val(),d=$("input[data-geo='lng']").val();c&&d&&(Aside.hide(),b(),k(function(){var b=new google.maps.LatLng(c,d);q.panTo(b);q.setZoom(6);h(!0)}))}function j(){var b=$(".aside .toggle");if(data=b.data("project"))data.unMarkSelected(!0),b.removeData("project")}function h(c){var d=[],e=q.getBounds();
j();_.each(t,function(b){var c=new google.maps.LatLng(b.lat,b.lng);e.contains(c)&&d.push(b)});$(".results li").each(function(b,c){$(c).remove()});if(0>=d)$(".aside").find(".counter").html("No projects found on the screen");else if(0<d.length){var f=d.length+" "+(1===d.length?" project on screen":" projects on screen");$(".aside").find(".counter").html(f);_.each(d,function(b,c){var d=$('<a href="#">'+b.value+"</a>");what="search";o[what]||(o[what]=$(".scroll-pane-"+what),o[what].jScrollPane());var e=
o[what].data("jsp");e.getContentPane().append($("<li></li>").append(d).delay(50*c).animate({opacity:1}));e.reinitialise();d.on("click",function(c){c.preventDefault();google.maps.event.trigger(b.circle,"click",{autoopen:true,latLng:null});b.circle.parent.markSelected()})});b();c&&Aside.show("search")}}function k(b){var c=function(){b&&b()},d=function(){$(".backdrop").fadeOut(250);$(".welcome").fadeOut(250,c)};$(".timeline-cover").animate({opacity:0,bottom:-30},250,function(){$(".filter-help").animate({top:"-100px",
opacity:0},250);$(".nav ul.filters").animate({right:"240px"},300,function(){$(".nav .input_field").fadeIn(250)});$(".left-side").animate({left:"-200px",opacity:0},400);$(".right-side").animate({left:"200px",opacity:0},400,d);$(".pac-container").fadeOut(250)})}function s(b){b.addClass("loading");b=document.getElementById(b.attr("id"));b=(new Spinner({lines:7,length:0,width:3,radius:4,rotate:0,color:"#000",speed:1,trail:55,shadow:!1,hwaccel:!1,zIndex:2E9,left:-22,top:0})).spin(b);$(b.el).fadeIn(250)}
var t=[],o=[];$(document).keyup(function(b){27===b.keyCode&&(Infowindow.hide(),$(".nav .filter").fadeOut(150))});$(window).resize(function(){c()});$(document).on("click",function(){$(".nav a[data-toggle='filter']").hasClass("selected")&&($(".nav a[data-toggle='filter']").removeClass("selected"),$(".nav .filter").fadeOut(150))});$(".addresspicker").keydown(function(b){13===b.keyCode&&(b.preventDefault(),b.stopPropagation(),l())});0>=$("ul.radio li.selected").length&&$("ul.radio li:first-child").addClass("selected");
$(".nav a[data-toggle='filter']").on("click",function(b){b.preventDefault();b.stopPropagation();$(".nav ul.filters").hasClass("disabled")||($(".nav a[data-toggle='filter'].selected").not(this).removeClass("selected"),$(this).toggleClass("selected"),$(".nav a[data-toggle='filter']").not(this).parent().find(".filter").fadeOut(250),$(this).parent().find(".filter").fadeToggle(150))});$(".nav .filter ul.radio li").on("click",function(b){b.preventDefault();b.stopPropagation();$(this).parent().find("li").each(function(){$(this).attr("id")});
$(this).parent().find("li").removeClass("selected");$(this).addClass("selected")});$(".nav .filter").on("click",function(b){b.preventDefault();b.stopPropagation()});$(".nav a[data-click='search']").on("click",function(b){b.preventDefault();b.stopPropagation();l()});$(".welcome a[data-click='search']").on("click",function(b){b.preventDefault();b.stopPropagation();l()});$("a[data-click='explore']").on("click",function(c){c.preventDefault();c.stopPropagation();var d=$("input[data-geo='lat']").val(),
e=$("input[data-geo='lng']").val();!d||!e?k():(Aside.hide(),b(),k(function(){var b=new google.maps.LatLng(d,e);q.panTo(b);q.setZoom(6);h(!0)}))});$("a[data-click='welcome']").on("click",function(b){b.preventDefault();b.stopPropagation();f()});var p=new google.maps.LatLngBounds(new google.maps.LatLng(13.39029,-26.33247),new google.maps.LatLng(-59.450451,-109.47493));$(".addresspicker").geocomplete({details:".input_field",detailsAttribute:"data-geo",bounds:p});$("ul.stats li").each(function(b,c){var d=
null,e=$(c),d="spinner_"+e.attr("class");e.append('<div id="'+d+'" class="spinner"></div>');d=document.getElementById(d);(new Spinner(config.BIG_SPINNER_OPTIONS)).spin(d);e.find(".spinner").fadeIn(250)});$(".input_field").smartPlaceholder();var w=function(){function b(){$(window).mousemove(function(b){w.positionate(b.pageX+10,b.pageY+10)});$(window).mouseleave(function(){$(c).css("opacity",0)});$(window).mouseenter(function(){$(c).css("opacity",1)})}var c;c=document.getElementById("minispinner_wrapper");
(new Spinner({lines:7,length:0,width:3,radius:4,rotate:0,color:"#000",speed:1,trail:55,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2E9,top:"auto",left:"auto"})).spin(c);return{show:function(){$(c).fadeIn();b()},hide:function(){$(c).fadeOut(function(){$(window).unbind("mousemove mouseleave mouseenter")})},positionate:function(b,d){$(c).css({top:d+"px",left:b+"px"})}}}();Aside=function(){var b=$(".aside"),e=$(".aside a.toggle"),f=0;(function(){e.on("click",function(b){b.preventDefault();e.hasClass("closed")?
(h(),Aside.show("search")):0===f?(j(),q.setZoom(previousZoom),Aside.hide(Timeline.show)):(Aside.hide(),d())})})();_show=function(g){"project"===g?(f=0,d(),b.find(".search").hide(),b.find(".project").show(),b.removeClass("search")):(f=1,b.find(".project").hide(),b.find(".search").show(),b.addClass("search"));b.find("ul.data li").css({opacity:0,marginLeft:150});$("#map").animate({right:"352px"},250);b.animate({right:0},250,function(){e.removeClass("closed");c();b.delay(300).find("p").slideDown(350,
function(){setTimeout(function(){c()},b.find("ul.data > li").length*100);b.find("ul.data > li").each(function(b,c){$(c).delay(b*100).animate({marginLeft:0,opacity:1},200)})})})};_hide=function(c){$("#map").animate({right:"0"},250);b.animate({right:"-330px"},250,function(){b.find("p").hide();e.addClass("closed");b.removeClass("search");c&&c()})};_isHidden=function(){return e.hasClass("closed")};return{hide:_hide,show:_show,isHidden:_isHidden}}();Timeline=function(){_show=function(){Aside.isHidden()&&
$("#timeline").animate({bottom:19,opacity:1},300)};_hide=function(b){$("#timeline").animate({bottom:-90,opacity:0},250,function(){b&&b()})};return{hide:_hide,show:_show}}();$("#timeline .slider").slider({range:!0,min:0,max:390,step:30,values:[0,500],stop:function(){mapView.startYear=config.START_YEAR;mapView.endYear=config.END_YEAR;mapView.removeOverlay("projects");mapView.addProjects()},slide:function(b,c){$("#timeline li").removeClass("selected");var d=c.values[0]/30+1,e=c.values[1]/30;startYear=
config.YEARS[d-1];for(endYear=config.YEARS[e-1];d<=e;d++)$("#timeline li:nth-child("+d+")").addClass("selected")}});var p={zoom:config.ZOOM,minZoom:config.MINZOOM,maxZoom:config.MAXZOOM,center:new google.maps.LatLng(config.LAT,config.LNG),mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0},q=new google.maps.Map(document.getElementById("map"),p),p=document.getElementById("zoom_controls"),u=document.createElement("DIV");p.appendChild(u);new function(b,c){b.setAttribute("class","zoom_in");google.maps.event.addDomListener(b,
"mousedown",function(){var b=c.getZoom()+1;20>b&&c.setZoom(b)})}(u,q);u.index=1;u=document.createElement("DIV");p.appendChild(u);new function(b,c){b.setAttribute("class","zoom_out");google.maps.event.addDomListener(b,"mousedown",function(){var b=c.getZoom()-1;2<b&&c.setZoom(b)})}(u,q);u.index=2;q.mapTypes.set("nexsoStyle",nexsoStyle);q.setMapTypeId("nexsoStyle");google.maps.event.addDomListener(q,"dragend",function(){Aside.isHidden()||h()});google.maps.event.addListener(q,"zoom_changed",function(){Aside.isHidden()||
h()});Infowindow=new InfoWindow({map:q});var u=Backbone.CartoDB({user:config.CARTODB_USER}),x=u.CartoDBModel.extend({topic_id:function(){return this.get("topic_id")},name:function(){return this.get("name")},lat:function(){return!this.get("location")?0:this.get("location").coordinates[1]},lng:function(){return!this.get("location")?0:this.get("location").coordinates[0]}}),p=u.CartoDBCollection.extend({model:x,table:"v1_ashoka",columns:{name:"name",location:"the_geom",topic_id:"topic_id"}}),x=u.CartoDBCollection.extend({model:x,
table:"v1_agencies",columns:{name:"name",location:"the_geom"}}),u=Backbone.View.extend({events:{},initialize:function(){this.state=1;this.overlays=[];this.circles=[];this.coordinates=[];this.addAgencies();this.addAshokas();this.addProjects()},enableFilters:function(){disabledFilters&&setTimeout(function(){disabledFilters=!1;$(".nav .spinner").fadeOut(250,function(){$(this).parent().removeClass("loading");$(this).remove()})},250)},disableFilters:function(){disabledFilters||(disabledFilters=!0)},removeOverlay:function(b){"ashokas"===
b||"agencies"===b?this.removeMarkers(b):"projects"===b&&this.removeProjects(b)},removeMarkers:function(b){for(var c=0;c<this.overlays[b].length;c++)this.overlays[b][c].hide(!0);this.enableFilters()},removeProjects:function(b){if(0<this.circles.length)for(var c=0;c<this.circles.length;c++)this.circles[c].circle.setMap(null);if(this.overlays[b].length)for(c=0;c<this.overlays[b].length;c++)if(this.overlays[b][c].length)for(var d=0;d<this.overlays[b][c].length;d++)this.overlays[b][c][d][0].setMap(null);
this.enableFilters()},changeOpacity:function(b,c){_.each(mapView.overlays[b],function(b){b.changeOpacity(c)})},hideOverlay:function(b){_.each(mapView.overlays[b],function(b){b.hide(!0)})},addAshokas:function(){visibleOverlays.ashokas&&(this.disableFilters(),this.overlays.ashokas?(_.each(this.overlays.ashokas,function(b){var c=b.properties.topic_ids.split("|");_.isArray(c)||(c=[c]);c=_.map(c,function(b){return parseInt(b,10)});c=_.intersect(topics,c);("solutions"===solutionFilter&&b.properties.solution_id||
"all"===solutionFilter)&&0<c.length?b.show(!0):b.hide(!0)}),this.enableFilters()):this.addOverlay("ashokas",queries.GET_ASHOKAS))},addAgencies:function(){visibleOverlays.agencies&&(this.disableFilters(),this.overlays.agencies?(_.each(this.overlays.agencies,function(b){("solutions"===solutionFilter&&b.properties.solution_id||"all"===solutionFilter)&&_.include(topics,b.properties.topic_id)?b.show(!0):b.hide(!0)}),this.enableFilters()):this.addOverlay("agencies",queries.GET_AGENCIES))},addProjects:function(){this.disableFilters();
if(visibleOverlays.projects){this.startYear||(this.startYear=config.START_YEAR);this.endYear||(this.endYear=config.END_YEAR);var b=0<topics.length?" P.topic_id  IN ("+topics.join(",")+") AND ":" P.topic_id = 0 AND ",c="solutions"===solutionFilter?" P.solution_id IS NOT NULL AND ":"";this.addOverlay("projects",_.template(queries.GET_PROJECTS_QUERY_TEMPLATE)({startYear:this.startYear,endYear:this.endYear,topicsCondition:b,solutionCondition:c}),function(){Timeline.show()})}},addOverlay:function(b,c,
d){var f=this;this.disableFilters();$.ajax({url:config.CARTODB_ENDPOINT,data:{q:c,format:"geojson"},dataType:"jsonp",success:function(c){if(0>=c.features.length)f.enableFilters();else{e(b,c.features.length);var g=projectsStyle,j=null;try{j=JSON.parse(c)}catch(k){j=c}c=$.extend({},g);f.overlays[b]=new GeoJSON(j,b,c||null);if(!(f.overlays[b].type&&"Error"===f.overlays[b].type)){j=0;g=[];t=[];if(f.overlays[b].length)for(c=0;c<f.overlays[b].length;c++)if(f.overlays[b][c].length){for(var g=[],l=0;l<f.overlays[b][c].length;l++){var o=
f.overlays[b][c][l][0];o.setMap(q);g.push(o);f.coordinates[o.geojsonProperties.project_id]=[f.overlays[b][c][0][0].geojsonProperties.centroid_lat,f.overlays[b][c][0][0].geojsonProperties.centroid_lon]}g=f.overlays[b][c][0][0].geojsonProperties;l=new google.maps.LatLng(g.centroid_lat,g.centroid_lon);o=new google.maps.LatLng(g.radius_point_lat,g.radius_point_lon);l=new RadiusWidget(q,l,o,f.overlays[b][c],[g.agency_position]);"projects"===b&&(t.push({circle:l.circle,more:g,value:g.title,lat:g.centroid_lat,
lng:g.centroid_lon}),j+=g.solution_count);f.circles.push(l)}else f.overlays[b][c].setMap(q);"projects"===b&&e("solutions",j)}f.enableFilters();d&&d();"projects"===b&&!Aside.isHidden()&&h()}}})}}),x=new x,p=new p;mapView=new u({el:$("#map"),ashoka:p,agencies:x});filterView=new (Backbone.View.extend({initialize:function(){var b=this;this.$("#solution-filter li").on("click",function(c){c.preventDefault();c.stopPropagation();b.filterBySolution($(this))});this.$("#topic-filter li").on("click",function(c){c.preventDefault();
c.stopPropagation();b.filterByTopic($(this))});this.$("#type-filter li").on("click",function(c){c.preventDefault();c.stopPropagation();b.filterByType($(this))})},disable:function(){$(".cancel").on("click",function(b){b.preventDefault();b.stopPropagation()});$("ul.filters").addClass("disabled");$(".cancel").show()},enable:function(){$("ul.filters").removeClass("disabled");$(".cancel").hide()},filterByTopic:function(b){if(!disabledFilters){mapView.disableFilters();Infowindow.hide();s(b);b.toggleClass("selected");
b.attr("id").trim();var c=parseInt(b.attr("class").replace(/selected/,"").replace("t","").trim(),10);b.hasClass("selected")?topics.push(c):topics=_.without(topics,c);0<topics.length?(mapView.removeOverlay("projects"),t=[],Aside.isHidden()||h(),mapView.addProjects(),mapView.addAgencies(),mapView.addAshokas()):(t=[],Aside.isHidden()||h(),mapView.removeOverlay("projects"),mapView.removeOverlay("agencies"),mapView.removeOverlay("ashokas"))}},filterBySolution:function(b){disabledFilters||(mapView.disableFilters(),
Infowindow.hide(),s(b),solutionFilter=b.attr("id").trim(),mapView.removeOverlay("projects"),mapView.addProjects(),mapView.addAgencies(),mapView.addAshokas())},filterByType:function(b){if(!disabledFilters){mapView.disableFilters();Infowindow.hide();s(b);b.toggleClass("selected");var c=b.attr("id").trim();b.attr("class").replace(/selected/,"").trim();if(b.hasClass("selected"))visibleOverlays[c]=!0,"agencies"===c?mapView.addAgencies():"ashokas"===c?mapView.addAshokas():"projects"===c&&mapView.addProjects();
else if(visibleOverlays[c]=!1,"projects"===c||"agencies"===c||"ashokas"===c)"projects"===c&&(t=[],Aside.isHidden()||h(),Timeline.hide()),Infowindow.hide(),mapView.removeOverlay(c)}}}))({el:$(".nav .content")})});
